/* Visio Win32-specific API library */
/* Version: 16.0.11612.30007 */

/*
	Copyright (c) Microsoft Corporation.  All rights reserved.
*/

/*
	Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.
*/

/*
* @overview es6-promise - a tiny implementation of Promises/A+.
* @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
* @license   Licensed under MIT license
*            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
* @version   2.3.0
*/

var __extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},OsfMsAjaxFactory,OSF,OSFLog,Logger,OSFAriaLogger,OSFAppTelemetry,OfficeExt,OfficeExtension,OfficeFirstPartyAuth,OfficeCore,Visio;(function(n){var t=function(){function n(){}return n.prototype.isMsAjaxLoaded=function(){return typeof Sys!="undefined"&&typeof Type!="undefined"&&Sys.StringBuilder&&typeof Sys.StringBuilder=="function"&&Type.registerNamespace&&typeof Type.registerNamespace=="function"&&Type.registerClass&&typeof Type.registerClass=="function"&&typeof Function._validateParams=="function"&&Sys.Serialization&&Sys.Serialization.JavaScriptSerializer&&typeof Sys.Serialization.JavaScriptSerializer.serialize=="function"?!0:!1},n.prototype.loadMsAjaxFull=function(n){var t=(window.location.protocol.toLowerCase()==="https:"?"https:":"http:")+"//ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js";OSF.OUtil.loadScript(t,n)},Object.defineProperty(n.prototype,"msAjaxError",{get:function(){return this._msAjaxError==null&&this.isMsAjaxLoaded()&&(this._msAjaxError=Error),this._msAjaxError},set:function(n){this._msAjaxError=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"msAjaxString",{get:function(){return this._msAjaxString==null&&this.isMsAjaxLoaded()&&(this._msAjaxString=String),this._msAjaxString},set:function(n){this._msAjaxString=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"msAjaxDebug",{get:function(){return this._msAjaxDebug==null&&this.isMsAjaxLoaded()&&(this._msAjaxDebug=Sys.Debug),this._msAjaxDebug},set:function(n){this._msAjaxDebug=n},enumerable:!0,configurable:!0}),n}();n.MicrosoftAjaxFactory=t})(OfficeExt||(OfficeExt={}));OsfMsAjaxFactory=new OfficeExt.MicrosoftAjaxFactory;OSF=OSF||{},function(n){var t=function(){function n(n){this._internalStorage=n}return n.prototype.getItem=function(n){try{return this._internalStorage&&this._internalStorage.getItem(n)}catch(t){return null}},n.prototype.setItem=function(n,t){try{this._internalStorage&&this._internalStorage.setItem(n,t)}catch(i){}},n.prototype.clear=function(){try{this._internalStorage&&this._internalStorage.clear()}catch(n){}},n.prototype.removeItem=function(n){try{this._internalStorage&&this._internalStorage.removeItem(n)}catch(t){}},n.prototype.getKeysWithPrefix=function(n){var r=[],u,t,i;try{for(u=this._internalStorage&&this._internalStorage.length||0,t=0;t<u;t++)i=this._internalStorage.key(t),i.indexOf(n)===0&&r.push(i)}catch(f){}return r},n}();n.SafeStorage=t}(OfficeExt||(OfficeExt={}));OSF.XdmFieldName={ConversationUrl:"ConversationUrl",AppId:"AppId"};OSF.WindowNameItemKeys={BaseFrameName:"baseFrameName",HostInfo:"hostInfo",XdmInfo:"xdmInfo",SerializerVersion:"serializerVersion",AppContext:"appContext"};OSF.OUtil=function(){function a(){var n=2147483647*Math.random();return n^=t^(new Date).getMilliseconds()<<Math.floor(Math.random()*21),n.toString(16)}function o(){if(!f){try{var n=window.sessionStorage}catch(t){n=null}f=new OfficeExt.SafeStorage(n)}return f}function v(n){for(var u=[],i=[],f=n.length,t,r=0;r<f;r++)t=n[r],t.tabIndex?t.tabIndex>0?i.push(t):t.tabIndex===0&&u.push(t):u.push(t);return i=i.sort(function(n,t){var r=n.tabIndex-t.tabIndex;return r===0&&(r=i.indexOf(n)-i.indexOf(t)),r}),[].concat(i,u)}var i=-1,s="&_xdm_Info=",h="&_serializer_version=",c="_xdm_",y="_serializer_version=",r="#",l="&",n="class",u={},p=3e4,f=null,e=null,t=(new Date).getTime();return{set_entropy:function(n){var i,u,r;if(typeof n=="string")for(i=0;i<n.length;i+=4){for(u=0,r=0;r<4&&i+r<n.length;r++)u=(u<<8)+n.charCodeAt(i+r);t^=u}else t^=typeof n=="number"?n:2147483647*Math.random();t&=2147483647},extend:function(n,t){var i=function(){};i.prototype=t.prototype;n.prototype=new i;n.prototype.constructor=n;n.uber=t.prototype;t.prototype.constructor===Object.prototype.constructor&&(t.prototype.constructor=t)},setNamespace:function(n,t){t&&n&&!t[n]&&(t[n]={})},unsetNamespace:function(n,t){t&&n&&t[n]&&delete t[n]},serializeSettings:function(n){var r={},i,t;for(i in n){t=n[i];try{t=JSON?JSON.stringify(t,function(n,t){return OSF.OUtil.isDate(this[n])?OSF.DDA.SettingsManager.DateJSONPrefix+this[n].getTime()+OSF.DDA.SettingsManager.DataJSONSuffix:t}):Sys.Serialization.JavaScriptSerializer.serialize(t);r[i]=t}catch(f){}}return r},deserializeSettings:function(n){var r={},i,t;n=n||{};for(i in n){t=n[i];try{t=JSON?JSON.parse(t,function(n,t){var i;return typeof t=="string"&&t&&t.length>6&&t.slice(0,5)===OSF.DDA.SettingsManager.DateJSONPrefix&&t.slice(-1)===OSF.DDA.SettingsManager.DataJSONSuffix&&(i=new Date(parseInt(t.slice(5,-1))),i)?i:t}):Sys.Serialization.JavaScriptSerializer.deserialize(t,!0);r[i]=t}catch(f){}}return r},loadScript:function(n,t,i){var e,r,f,o,s;n&&t&&(e=window.document,r=u[n],r?r.loaded?t():r.pendingCallbacks.push(t):(f=e.createElement("script"),f.type="text/javascript",r={loaded:!1,pendingCallbacks:[t],timer:null},u[n]=r,o=function(){var t,n,i;for(r.timer!=null&&(clearTimeout(r.timer),delete r.timer),r.loaded=!0,t=r.pendingCallbacks.length,n=0;n<t;n++)i=r.pendingCallbacks.shift(),i()},s=function(){var i,t,f;for(delete u[n],r.timer!=null&&(clearTimeout(r.timer),delete r.timer),i=r.pendingCallbacks.length,t=0;t<i;t++)f=r.pendingCallbacks.shift(),f()},f.readyState?f.onreadystatechange=function(){(f.readyState=="loaded"||f.readyState=="complete")&&(f.onreadystatechange=null,o())}:f.onload=o,f.onerror=s,i=i||p,r.timer=setTimeout(s,i),f.setAttribute("crossOrigin","anonymous"),f.src=n,e.getElementsByTagName("head")[0].appendChild(f)))},loadCSS:function(n){if(n){var i=window.document,t=i.createElement("link");t.type="text/css";t.rel="stylesheet";t.href=n;i.getElementsByTagName("head")[0].appendChild(t)}},parseEnum:function(n,t){var i=t[n.trim()];if(typeof i=="undefined"){OsfMsAjaxFactory.msAjaxDebug.trace("invalid enumeration string:"+n);throw OsfMsAjaxFactory.msAjaxError.argument("str");}return i},delayExecutionAndCache:function(){var n={calc:arguments[0]};return function(){return n.calc&&(n.val=n.calc.apply(this,arguments),delete n.calc),n.val}},getUniqueId:function(){return i=i+1,i.toString()},formatString:function(){var n=arguments,t=n[0];return t.replace(/{(\d+)}/gm,function(t,i){var r=parseInt(i,10)+1;return n[r]===undefined?"{"+i+"}":n[r]})},generateConversationId:function(){return[a(),a(),(new Date).getTime().toString()].join("_")},getFrameName:function(n){return c+n+this.generateConversationId()},addXdmInfoAsHash:function(n,t){return OSF.OUtil.addInfoAsHash(n,s,t,!1)},addSerializerVersionAsHash:function(n,t){return OSF.OUtil.addInfoAsHash(n,h,t,!0)},addInfoAsHash:function(n,t,i,u){n=n.trim()||"";var f=n.split(r),s=f.shift(),e=f.join(r),o;return o=u?[t,encodeURIComponent(i),e].join(""):[e,t,i].join(""),[s,r,o].join("")},parseHostInfoFromWindowName:function(n,t){return OSF.OUtil.parseInfoFromWindowName(n,t,OSF.WindowNameItemKeys.HostInfo)},parseXdmInfo:function(n){var t=OSF.OUtil.parseXdmInfoWithGivenFragment(n,window.location.hash);return t||(t=OSF.OUtil.parseXdmInfoFromWindowName(n,window.name)),t},parseXdmInfoFromWindowName:function(n,t){return OSF.OUtil.parseInfoFromWindowName(n,t,OSF.WindowNameItemKeys.XdmInfo)},parseXdmInfoWithGivenFragment:function(n,t){return OSF.OUtil.parseInfoWithGivenFragment(s,c,!1,n,t)},parseSerializerVersion:function(n){var t=OSF.OUtil.parseSerializerVersionWithGivenFragment(n,window.location.hash);return isNaN(t)&&(t=OSF.OUtil.parseSerializerVersionFromWindowName(n,window.name)),t},parseSerializerVersionFromWindowName:function(n,t){return parseInt(OSF.OUtil.parseInfoFromWindowName(n,t,OSF.WindowNameItemKeys.SerializerVersion))},parseSerializerVersionWithGivenFragment:function(n,t){return parseInt(OSF.OUtil.parseInfoWithGivenFragment(h,y,!0,n,t))},parseInfoFromWindowName:function(n,t,i){var e;try{var r=JSON.parse(t),u=r!=null?r[i]:null,f=o();return!n&&f&&r!=null&&(e=r[OSF.WindowNameItemKeys.BaseFrameName]+i,u?f.setItem(e,u):u=f.getItem(e)),u}catch(s){return null}},parseInfoWithGivenFragment:function(n,t,i,r,u){var c=u.split(n),f=c.length>1?c[c.length-1]:null,e,s,h,a;return i&&f!=null&&(f.indexOf(l)>=0&&(f=f.split(l)[0]),f=decodeURIComponent(f)),e=o(),!r&&e&&(s=window.name.indexOf(t),s>-1&&(h=window.name.indexOf(";",s),h==-1&&(h=window.name.length),a=window.name.substring(s,h),f?e.setItem(a,f):f=e.getItem(a))),f},getConversationId:function(){var t=window.location.search,n=null,i;return t&&(i=t.indexOf("&"),n=i>0?t.substring(1,i):t.substr(1),n&&n.charAt(n.length-1)==="="&&(n=n.substring(0,n.length-1),n&&(n=decodeURIComponent(n)))),n},getInfoItems:function(n){var t=n.split("$");return typeof t[1]=="undefined"&&(t=n.split("|")),typeof t[1]=="undefined"&&(t=n.split("%7C")),t},getXdmFieldValue:function(n,t){var r="",u=OSF.OUtil.parseXdmInfo(t),i;if(u&&(i=OSF.OUtil.getInfoItems(u),i!=undefined&&i.length>=3))switch(n){case OSF.XdmFieldName.ConversationUrl:r=i[2];break;case OSF.XdmFieldName.AppId:r=i[1];break}return r},validateParamObject:function(n,t,i){var r=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:!1},{name:"expectedProperties",type:Object,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0}]),u;if(r)throw r;for(u in t)if(r=Function._validateParameter(n[u],t[u],u),r)throw r;},writeProfilerMark:function(n){window.msWriteProfilerMark&&(window.msWriteProfilerMark(n),OsfMsAjaxFactory.msAjaxDebug.trace(n))},outputDebug:function(n){typeof OsfMsAjaxFactory!="undefined"&&OsfMsAjaxFactory.msAjaxDebug&&OsfMsAjaxFactory.msAjaxDebug.trace&&OsfMsAjaxFactory.msAjaxDebug.trace(n)},defineNondefaultProperty:function(n,t,i,r){var f,u;i=i||{};for(f in r)u=r[f],i[u]==undefined&&(i[u]=!0);return Object.defineProperty(n,t,i),n},defineNondefaultProperties:function(n,t,i){t=t||{};for(var r in t)OSF.OUtil.defineNondefaultProperty(n,r,t[r],i);return n},defineEnumerableProperty:function(n,t,i){return OSF.OUtil.defineNondefaultProperty(n,t,i,["enumerable"])},defineEnumerableProperties:function(n,t){return OSF.OUtil.defineNondefaultProperties(n,t,["enumerable"])},defineMutableProperty:function(n,t,i){return OSF.OUtil.defineNondefaultProperty(n,t,i,["writable","enumerable","configurable"])},defineMutableProperties:function(n,t){return OSF.OUtil.defineNondefaultProperties(n,t,["writable","enumerable","configurable"])},finalizeProperties:function(n,t){var u,e,r,f,i;for(t=t||{},u=Object.getOwnPropertyNames(n),e=u.length,r=0;r<e;r++)f=u[r],i=Object.getOwnPropertyDescriptor(n,f),i.get||i.set||(i.writable=t.writable||!1),i.configurable=t.configurable||!1,i.enumerable=t.enumerable||!0,Object.defineProperty(n,f,i);return n},mapList:function(n,t){var i=[],r;if(n)for(r in n)i.push(t(n[r]));return i},listContainsKey:function(n,t){for(var i in n)if(t==i)return!0;return!1},listContainsValue:function(n,t){for(var i in n)if(t==n[i])return!0;return!1},augmentList:function(n,t){var r=n.push?function(t,i){n.push(i)}:function(t,i){n[t]=i};for(var i in t)r(i,t[i])},redefineList:function(n,t){var r,i;for(r in n)delete n[r];for(i in t)n[i]=t[i]},isArray:function(n){return Object.prototype.toString.apply(n)==="[object Array]"},isFunction:function(n){return Object.prototype.toString.apply(n)==="[object Function]"},isDate:function(n){return Object.prototype.toString.apply(n)==="[object Date]"},addEventListener:function(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):Sys.Browser.agent===Sys.Browser.InternetExplorer&&n.attachEvent?n.attachEvent("on"+t,i):n["on"+t]=i},removeEventListener:function(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):Sys.Browser.agent===Sys.Browser.InternetExplorer&&n.detachEvent?n.detachEvent("on"+t,i):n["on"+t]=null},getCookieValue:function(n){var t=RegExp(n+"[^;]+").exec(document.cookie);return t.toString().replace(/^[^=]+./,"")},xhrGet:function(n,t,i){var r;try{r=new XMLHttpRequest;r.onreadystatechange=function(){r.readyState==4&&(r.status==200?t(r.responseText):i(r.status))};r.open("GET",n,!0);r.send()}catch(u){i(u)}},xhrGetFull:function(n,t,i,r){var u,f=t;try{u=new XMLHttpRequest;u.onreadystatechange=function(){u.readyState==4&&(u.status==200?i(u,f):r(u.status))};u.open("GET",n,!0);u.send()}catch(e){r(e)}},encodeBase64:function(n){var h;if(!n)return n;var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=[],i=[],o=0,c,e,s,r,u,f,t,v=n.length;do for(c=n.charCodeAt(o++),e=n.charCodeAt(o++),s=n.charCodeAt(o++),t=0,r=c&255,u=c>>8,f=e&255,i[t++]=r>>2,i[t++]=(r&3)<<4|u>>4,i[t++]=(u&15)<<2|f>>6,i[t++]=f&63,isNaN(e)||(r=e>>8,u=s&255,f=s>>8,i[t++]=r>>2,i[t++]=(r&3)<<4|u>>4,i[t++]=(u&15)<<2|f>>6,i[t++]=f&63),isNaN(e)?i[t-1]=64:isNaN(s)&&(i[t-2]=64,i[t-1]=64),h=0;h<t;h++)l.push(a.charAt(i[h]));while(o<v);return l.join("")},getSessionStorage:function(){return o()},getLocalStorage:function(){if(!e){try{var n=window.localStorage}catch(t){n=null}e=new OfficeExt.SafeStorage(n)}return e},convertIntToCssHexColor:function(n){return"#"+(Number(n)+16777216).toString(16).slice(-6)},attachClickHandler:function(n,t){n.onclick=function(n){t()};n.ontouchend=function(n){t();n.preventDefault()}},getQueryStringParamValue:function(n,t){var r=Function._validateParams(arguments,[{name:"queryString",type:String,mayBeNull:!1},{name:"paramName",type:String,mayBeNull:!1}]),i;return r?(OsfMsAjaxFactory.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: Parameters cannot be null."),""):(i=new RegExp("[\\?&]"+t+"=([^&#]*)","i"),!i.test(n))?(OsfMsAjaxFactory.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: The parameter is not found."),""):i.exec(n)[1]},isiOS:function(){return window.navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1},isChrome:function(){return window.navigator.userAgent.indexOf("Chrome")>0&&!OSF.OUtil.isEdge()},isEdge:function(){return window.navigator.userAgent.indexOf("Edge")>0},isIE:function(){return window.navigator.userAgent.indexOf("Trident")>0},isFirefox:function(){return window.navigator.userAgent.indexOf("Firefox")>0},shallowCopy:function(n){var r,t,u,i;if(n==null)return null;else if(n instanceof Object)if(Array.isArray(n)){for(r=[],t=0;t<n.length;t++)r.push(n[t]);return r}else{u=n.constructor();for(i in n)n.hasOwnProperty(i)&&(u[i]=n[i]);return u}else return n},createObject:function(n){var i=null,r,t;if(n)for(i={},r=n.length,t=0;t<r;t++)i[n[t].name]=n[t].value;return i},addClass:function(t,i){if(!OSF.OUtil.hasClass(t,i)){var r=t.getAttribute(n);r?t.setAttribute(n,r+" "+i):t.setAttribute(n,i)}},removeClass:function(t,i){if(OSF.OUtil.hasClass(t,i)){var r=t.getAttribute(n),u=new RegExp("(\\s|^)"+i+"(\\s|$)");r=r.replace(u,"");t.setAttribute(n,r)}},hasClass:function(t,i){var r=t.getAttribute(n);return r&&r.match(new RegExp("(\\s|^)"+i+"(\\s|$)"))},focusToFirstTabbable:function(n,t){var i,u=!1,r,f=function(n){u=!0},e=function(n,t,i){if(t<0||t>n)return-1;else if(t===0&&i)return-1;else if(t===n-1&&!i)return-1;return i?t-1:t+1};if(n=v(n),i=t?n.length-1:0,n.length===0)return null;while(!u&&i>=0&&i<n.length)r=n[i],window.focus(),r.addEventListener("focus",f),r.focus(),r.removeEventListener("focus",f),i=e(n.length,i,t),u||r!==document.activeElement||(u=!0);return u?r:null},focusToNextTabbable:function(n,t,i){var e,r,f=!1,u,o=function(n){f=!0},h=function(n,t){for(var i=0;i<n.length;i++)if(n[i]===t)return i;return-1},s=function(n,t,i){if(t<0||t>n)return-1;else if(t===0&&i)return-1;else if(t===n-1&&!i)return-1;return i?t-1:t+1};if(n=v(n),e=h(n,t),r=s(n.length,e,i),r<0)return null;while(!f&&r>=0&&r<n.length)u=n[r],u.addEventListener("focus",o),u.focus(),u.removeEventListener("focus",o),r=s(n.length,r,i),f||u!==document.activeElement||(f=!0);return f?u:null}}}();OSF.OUtil.Guid=function(){var n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return{generateNewGuid:function(){for(var i="",r=(new Date).getTime(),t=0;t<32&&r>0;t++)(t==8||t==12||t==16||t==20)&&(i+="-"),i+=n[r%16],r=Math.floor(r/16);for(;t<32;t++)(t==8||t==12||t==16||t==20)&&(i+="-"),i+=n[Math.floor(Math.random()*16)];return i}}}();window.OSF=OSF;OSF.OUtil.setNamespace("OSF",window);OSF.MessageIDs={FetchBundleUrl:0,LoadReactBundle:1,LoadBundleSuccess:2,LoadBundleError:3};OSF.AppName={Unsupported:0,Excel:1,Word:2,PowerPoint:4,Outlook:8,ExcelWebApp:16,WordWebApp:32,OutlookWebApp:64,Project:128,AccessWebApp:256,PowerpointWebApp:512,ExcelIOS:1024,Sway:2048,WordIOS:4096,PowerPointIOS:8192,Access:16384,Lync:32768,OutlookIOS:65536,OneNoteWebApp:131072,OneNote:262144,ExcelWinRT:524288,WordWinRT:1048576,PowerpointWinRT:2097152,OutlookAndroid:4194304,OneNoteWinRT:8388608,ExcelAndroid:8388609,VisioWebApp:8388610,OneNoteIOS:8388611,WordAndroid:8388613,PowerpointAndroid:8388614,Visio:8388615,OneNoteAndroid:4194305};OSF.InternalPerfMarker={DataCoercionBegin:"Agave.HostCall.CoerceDataStart",DataCoercionEnd:"Agave.HostCall.CoerceDataEnd"};OSF.HostCallPerfMarker={IssueCall:"Agave.HostCall.IssueCall",ReceiveResponse:"Agave.HostCall.ReceiveResponse",RuntimeExceptionRaised:"Agave.HostCall.RuntimeExecptionRaised"};OSF.AgaveHostAction={Select:0,UnSelect:1,CancelDialog:2,InsertAgave:3,CtrlF6In:4,CtrlF6Exit:5,CtrlF6ExitShift:6,SelectWithError:7,NotifyHostError:8,RefreshAddinCommands:9,PageIsReady:10,TabIn:11,TabInShift:12,TabExit:13,TabExitShift:14,EscExit:15,F2Exit:16,ExitNoFocusable:17,ExitNoFocusableShift:18,MouseEnter:19,MouseLeave:20,UpdateTargetUrl:21,InstallCustomFunctions:22,SendTelemetryEvent:23,UninstallCustomFunctions:24};OSF.SharedConstants={NotificationConversationIdSuffix:"_ntf"};OSF.DialogMessageType={DialogMessageReceived:0,DialogParentMessageReceived:1,DialogClosed:12006};OSF.OfficeAppContext=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt){this._id=n;this._appName=t;this._appVersion=i;this._appUILocale=r;this._dataLocale=u;this._docUrl=f;this._clientMode=e;this._settings=o;this._reason=s;this._osfControlType=h;this._eToken=c;this._correlationId=l;this._appInstanceId=a;this._touchEnabled=v;this._commerceAllowed=y;this._appMinorVersion=p;this._requirementMatrix=w;this._hostCustomMessage=b;this._hostFullVersion=k;this._isDialog=!1;this._clientWindowHeight=d;this._clientWindowWidth=g;this._addinName=nt;this._appDomains=tt;this._dialogRequirementMatrix=it;this._featureGates=rt;this.get_id=function(){return this._id};this.get_appName=function(){return this._appName};this.get_appVersion=function(){return this._appVersion};this.get_appUILocale=function(){return this._appUILocale};this.get_dataLocale=function(){return this._dataLocale};this.get_docUrl=function(){return this._docUrl};this.get_clientMode=function(){return this._clientMode};this.get_bindings=function(){return this._bindings};this.get_settings=function(){return this._settings};this.get_reason=function(){return this._reason};this.get_osfControlType=function(){return this._osfControlType};this.get_eToken=function(){return this._eToken};this.get_correlationId=function(){return this._correlationId};this.get_appInstanceId=function(){return this._appInstanceId};this.get_touchEnabled=function(){return this._touchEnabled};this.get_commerceAllowed=function(){return this._commerceAllowed};this.get_appMinorVersion=function(){return this._appMinorVersion};this.get_requirementMatrix=function(){return this._requirementMatrix};this.get_dialogRequirementMatrix=function(){return this._dialogRequirementMatrix};this.get_hostCustomMessage=function(){return this._hostCustomMessage};this.get_hostFullVersion=function(){return this._hostFullVersion};this.get_isDialog=function(){return this._isDialog};this.get_clientWindowHeight=function(){return this._clientWindowHeight};this.get_clientWindowWidth=function(){return this._clientWindowWidth};this.get_addinName=function(){return this._addinName};this.get_appDomains=function(){return this._appDomains};this.get_featureGates=function(){return this._featureGates}};OSF.OsfControlType={DocumentLevel:0,ContainerLevel:1};OSF.ClientMode={ReadOnly:0,ReadWrite:1};OSF.OUtil.setNamespace("Microsoft",window);OSF.OUtil.setNamespace("Office",Microsoft);OSF.OUtil.setNamespace("Client",Microsoft.Office);OSF.OUtil.setNamespace("WebExtension",Microsoft.Office);Microsoft.Office.WebExtension.InitializationReason={Inserted:"inserted",DocumentOpened:"documentOpened"};Microsoft.Office.WebExtension.ValueFormat={Unformatted:"unformatted",Formatted:"formatted"};Microsoft.Office.WebExtension.FilterType={All:"all"};Microsoft.Office.WebExtension.Parameters={BindingType:"bindingType",CoercionType:"coercionType",ValueFormat:"valueFormat",FilterType:"filterType",Columns:"columns",SampleData:"sampleData",GoToType:"goToType",SelectionMode:"selectionMode",Id:"id",PromptText:"promptText",ItemName:"itemName",FailOnCollision:"failOnCollision",StartRow:"startRow",StartColumn:"startColumn",RowCount:"rowCount",ColumnCount:"columnCount",Callback:"callback",AsyncContext:"asyncContext",Data:"data",Rows:"rows",OverwriteIfStale:"overwriteIfStale",FileType:"fileType",EventType:"eventType",Handler:"handler",SliceSize:"sliceSize",SliceIndex:"sliceIndex",ActiveView:"activeView",Status:"status",PlatformType:"platformType",HostType:"hostType",ForceConsent:"forceConsent",ForceAddAccount:"forceAddAccount",AuthChallenge:"authChallenge",Reserved:"reserved",Tcid:"tcid",Xml:"xml",Namespace:"namespace",Prefix:"prefix",XPath:"xPath",Text:"text",ImageLeft:"imageLeft",ImageTop:"imageTop",ImageWidth:"imageWidth",ImageHeight:"imageHeight",TaskId:"taskId",FieldId:"fieldId",FieldValue:"fieldValue",ServerUrl:"serverUrl",ListName:"listName",ResourceId:"resourceId",ViewType:"viewType",ViewName:"viewName",GetRawValue:"getRawValue",CellFormat:"cellFormat",TableOptions:"tableOptions",TaskIndex:"taskIndex",ResourceIndex:"resourceIndex",CustomFieldId:"customFieldId",Url:"url",MessageHandler:"messageHandler",Width:"width",Height:"height",RequireHTTPs:"requireHTTPS",MessageToParent:"messageToParent",DisplayInIframe:"displayInIframe",MessageContent:"messageContent",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen",EnforceAppDomain:"enforceAppDomain",AppCommandInvocationCompletedData:"appCommandInvocationCompletedData",Base64:"base64",FormId:"formId"};OSF.OUtil.setNamespace("DDA",OSF);OSF.DDA.DocumentMode={ReadOnly:1,ReadWrite:0};OSF.DDA.PropertyDescriptors={AsyncResultStatus:"AsyncResultStatus"};OSF.DDA.EventDescriptors={};OSF.DDA.ListDescriptors={};OSF.DDA.UI={};OSF.DDA.getXdmEventName=function(n,t){return t==Microsoft.Office.WebExtension.EventType.BindingSelectionChanged||t==Microsoft.Office.WebExtension.EventType.BindingDataChanged||t==Microsoft.Office.WebExtension.EventType.DataNodeDeleted||t==Microsoft.Office.WebExtension.EventType.DataNodeInserted||t==Microsoft.Office.WebExtension.EventType.DataNodeReplaced?n+"_"+t:t};OSF.DDA.MethodDispId={dispidMethodMin:64,dispidGetSelectedDataMethod:64,dispidSetSelectedDataMethod:65,dispidAddBindingFromSelectionMethod:66,dispidAddBindingFromPromptMethod:67,dispidGetBindingMethod:68,dispidReleaseBindingMethod:69,dispidGetBindingDataMethod:70,dispidSetBindingDataMethod:71,dispidAddRowsMethod:72,dispidClearAllRowsMethod:73,dispidGetAllBindingsMethod:74,dispidLoadSettingsMethod:75,dispidSaveSettingsMethod:76,dispidGetDocumentCopyMethod:77,dispidAddBindingFromNamedItemMethod:78,dispidAddColumnsMethod:79,dispidGetDocumentCopyChunkMethod:80,dispidReleaseDocumentCopyMethod:81,dispidNavigateToMethod:82,dispidGetActiveViewMethod:83,dispidGetDocumentThemeMethod:84,dispidGetOfficeThemeMethod:85,dispidGetFilePropertiesMethod:86,dispidClearFormatsMethod:87,dispidSetTableOptionsMethod:88,dispidSetFormatsMethod:89,dispidExecuteRichApiRequestMethod:93,dispidAppCommandInvocationCompletedMethod:94,dispidCloseContainerMethod:97,dispidGetAccessTokenMethod:98,dispidGetAuthContextMethod:99,dispidOpenBrowserWindow:102,dispidCreateDocumentMethod:105,dispidInsertFormMethod:106,dispidDisplayRibbonCalloutAsyncMethod:109,dispidGetSelectedTaskMethod:110,dispidGetSelectedResourceMethod:111,dispidGetTaskMethod:112,dispidGetResourceFieldMethod:113,dispidGetWSSUrlMethod:114,dispidGetTaskFieldMethod:115,dispidGetProjectFieldMethod:116,dispidGetSelectedViewMethod:117,dispidGetTaskByIndexMethod:118,dispidGetResourceByIndexMethod:119,dispidSetTaskFieldMethod:120,dispidSetResourceFieldMethod:121,dispidGetMaxTaskIndexMethod:122,dispidGetMaxResourceIndexMethod:123,dispidCreateTaskMethod:124,dispidAddDataPartMethod:128,dispidGetDataPartByIdMethod:129,dispidGetDataPartsByNamespaceMethod:130,dispidGetDataPartXmlMethod:131,dispidGetDataPartNodesMethod:132,dispidDeleteDataPartMethod:133,dispidGetDataNodeValueMethod:134,dispidGetDataNodeXmlMethod:135,dispidGetDataNodesMethod:136,dispidSetDataNodeValueMethod:137,dispidSetDataNodeXmlMethod:138,dispidAddDataNamespaceMethod:139,dispidGetDataUriByPrefixMethod:140,dispidGetDataPrefixByUriMethod:141,dispidGetDataNodeTextMethod:142,dispidSetDataNodeTextMethod:143,dispidMessageParentMethod:144,dispidSendMessageMethod:145,dispidExecuteFeature:146,dispidQueryFeature:147,dispidMethodMax:147};OSF.DDA.EventDispId={dispidEventMin:0,dispidInitializeEvent:0,dispidSettingsChangedEvent:1,dispidDocumentSelectionChangedEvent:2,dispidBindingSelectionChangedEvent:3,dispidBindingDataChangedEvent:4,dispidDocumentOpenEvent:5,dispidDocumentCloseEvent:6,dispidActiveViewChangedEvent:7,dispidDocumentThemeChangedEvent:8,dispidOfficeThemeChangedEvent:9,dispidDialogMessageReceivedEvent:10,dispidDialogNotificationShownInAddinEvent:11,dispidDialogParentMessageReceivedEvent:12,dispidObjectDeletedEvent:13,dispidObjectSelectionChangedEvent:14,dispidObjectDataChangedEvent:15,dispidContentControlAddedEvent:16,dispidActivationStatusChangedEvent:32,dispidRichApiMessageEvent:33,dispidAppCommandInvokedEvent:39,dispidOlkItemSelectedChangedEvent:46,dispidOlkRecipientsChangedEvent:47,dispidOlkAppointmentTimeChangedEvent:48,dispidOlkRecurrenceChangedEvent:49,dispidOlkAttachmentsChangedEvent:50,dispidOlkEnhancedLocationsChangedEvent:51,dispidOlkInfobarClickedEvent:52,dispidTaskSelectionChangedEvent:56,dispidResourceSelectionChangedEvent:57,dispidViewSelectionChangedEvent:58,dispidDataNodeAddedEvent:60,dispidDataNodeReplacedEvent:61,dispidDataNodeDeletedEvent:62,dispidEventMax:63};OSF.DDA.ErrorCodeManager=function(){var n={};return{getErrorArgs:function(t){var i=n[t];return i?(i.name||(i.name=n[this.errorCodes.ooeInternalError].name),i.message||(i.message=n[this.errorCodes.ooeInternalError].message)):i=n[this.errorCodes.ooeInternalError],i},addErrorMessage:function(t,i){n[t]=i},errorCodes:{ooeSuccess:0,ooeChunkResult:1,ooeCoercionTypeNotSupported:1e3,ooeGetSelectionNotMatchDataType:1001,ooeCoercionTypeNotMatchBinding:1002,ooeInvalidGetRowColumnCounts:1003,ooeSelectionNotSupportCoercionType:1004,ooeInvalidGetStartRowColumn:1005,ooeNonUniformPartialGetNotSupported:1006,ooeGetDataIsTooLarge:1008,ooeFileTypeNotSupported:1009,ooeGetDataParametersConflict:1010,ooeInvalidGetColumns:1011,ooeInvalidGetRows:1012,ooeInvalidReadForBlankRow:1013,ooeUnsupportedDataObject:2e3,ooeCannotWriteToSelection:2001,ooeDataNotMatchSelection:2002,ooeOverwriteWorksheetData:2003,ooeDataNotMatchBindingSize:2004,ooeInvalidSetStartRowColumn:2005,ooeInvalidDataFormat:2006,ooeDataNotMatchCoercionType:2007,ooeDataNotMatchBindingType:2008,ooeSetDataIsTooLarge:2009,ooeNonUniformPartialSetNotSupported:2010,ooeInvalidSetColumns:2011,ooeInvalidSetRows:2012,ooeSetDataParametersConflict:2013,ooeCellDataAmountBeyondLimits:2014,ooeSelectionCannotBound:3e3,ooeBindingNotExist:3002,ooeBindingToMultipleSelection:3003,ooeInvalidSelectionForBindingType:3004,ooeOperationNotSupportedOnThisBindingType:3005,ooeNamedItemNotFound:3006,ooeMultipleNamedItemFound:3007,ooeInvalidNamedItemForBindingType:3008,ooeUnknownBindingType:3009,ooeOperationNotSupportedOnMatrixData:3010,ooeInvalidColumnsForBinding:3011,ooeSettingNameNotExist:4e3,ooeSettingsCannotSave:4001,ooeSettingsAreStale:4002,ooeOperationNotSupported:5e3,ooeInternalError:5001,ooeDocumentReadOnly:5002,ooeEventHandlerNotExist:5003,ooeInvalidApiCallInContext:5004,ooeShuttingDown:5005,ooeUnsupportedEnumeration:5007,ooeIndexOutOfRange:5008,ooeBrowserAPINotSupported:5009,ooeInvalidParam:5010,ooeRequestTimeout:5011,ooeInvalidOrTimedOutSession:5012,ooeInvalidApiArguments:5013,ooeOperationCancelled:5014,ooeWorkbookHidden:5015,ooeTooManyIncompleteRequests:5100,ooeRequestTokenUnavailable:5101,ooeActivityLimitReached:5102,ooeCustomXmlNodeNotFound:6e3,ooeCustomXmlError:6100,ooeCustomXmlExceedQuota:6101,ooeCustomXmlOutOfDate:6102,ooeNoCapability:7e3,ooeCannotNavTo:7001,ooeSpecifiedIdNotExist:7002,ooeNavOutOfBound:7004,ooeElementMissing:8e3,ooeProtectedError:8001,ooeInvalidCellsValue:8010,ooeInvalidTableOptionValue:8011,ooeInvalidFormatValue:8012,ooeRowIndexOutOfRange:8020,ooeColIndexOutOfRange:8021,ooeFormatValueOutOfRange:8022,ooeCellFormatAmountBeyondLimits:8023,ooeMemoryFileLimit:11e3,ooeNetworkProblemRetrieveFile:11001,ooeInvalidSliceSize:11002,ooeInvalidCallback:11101,ooeInvalidWidth:12e3,ooeInvalidHeight:12001,ooeNavigationError:12002,ooeInvalidScheme:12003,ooeAppDomains:12004,ooeRequireHTTPS:12005,ooeWebDialogClosed:12006,ooeDialogAlreadyOpened:12007,ooeEndUserAllow:12008,ooeEndUserIgnore:12009,ooeNotUILessDialog:12010,ooeCrossZone:12011,ooeNotSSOAgave:13e3,ooeSSOUserNotSignedIn:13001,ooeSSOUserAborted:13002,ooeSSOUnsupportedUserIdentity:13003,ooeSSOInvalidResourceUrl:13004,ooeSSOInvalidGrant:13005,ooeSSOClientError:13006,ooeSSOServerError:13007,ooeAddinIsAlreadyRequestingToken:13008,ooeSSOUserConsentNotSupportedByCurrentAddinCategory:13009,ooeSSOConnectionLost:13010,ooeResourceNotAllowed:13011,ooeSSOUnsupportedPlatform:13012,ooeAccessDenied:13990,ooeGeneralException:13991},initializeErrorMessages:function(t){n[OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported]={name:t.L_InvalidCoercion,message:t.L_CoercionTypeNotSupported};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType]={name:t.L_DataReadError,message:t.L_GetSelectionNotSupported};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding]={name:t.L_InvalidCoercion,message:t.L_CoercionTypeNotMatchBinding};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetRowColumnCounts]={name:t.L_DataReadError,message:t.L_InvalidGetRowColumnCounts};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSelectionNotSupportCoercionType]={name:t.L_DataReadError,message:t.L_SelectionNotSupportCoercionType};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetStartRowColumn]={name:t.L_DataReadError,message:t.L_InvalidGetStartRowColumn};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialGetNotSupported]={name:t.L_DataReadError,message:t.L_NonUniformPartialGetNotSupported};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeGetDataIsTooLarge]={name:t.L_DataReadError,message:t.L_GetDataIsTooLarge};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported]={name:t.L_DataReadError,message:t.L_FileTypeNotSupported};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeGetDataParametersConflict]={name:t.L_DataReadError,message:t.L_GetDataParametersConflict};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetColumns]={name:t.L_DataReadError,message:t.L_InvalidGetColumns};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetRows]={name:t.L_DataReadError,message:t.L_InvalidGetRows};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidReadForBlankRow]={name:t.L_DataReadError,message:t.L_InvalidReadForBlankRow};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedDataObject]={name:t.L_DataWriteError,message:t.L_UnsupportedDataObject};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection]={name:t.L_DataWriteError,message:t.L_CannotWriteToSelection};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchSelection]={name:t.L_DataWriteError,message:t.L_DataNotMatchSelection};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeOverwriteWorksheetData]={name:t.L_DataWriteError,message:t.L_OverwriteWorksheetData};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize]={name:t.L_DataWriteError,message:t.L_DataNotMatchBindingSize};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSetStartRowColumn]={name:t.L_DataWriteError,message:t.L_InvalidSetStartRowColumn};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidDataFormat]={name:t.L_InvalidFormat,message:t.L_InvalidDataFormat};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType]={name:t.L_InvalidDataObject,message:t.L_DataNotMatchCoercionType};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingType]={name:t.L_InvalidDataObject,message:t.L_DataNotMatchBindingType};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataIsTooLarge]={name:t.L_DataWriteError,message:t.L_SetDataIsTooLarge};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialSetNotSupported]={name:t.L_DataWriteError,message:t.L_NonUniformPartialSetNotSupported};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSetColumns]={name:t.L_DataWriteError,message:t.L_InvalidSetColumns};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSetRows]={name:t.L_DataWriteError,message:t.L_InvalidSetRows};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataParametersConflict]={name:t.L_DataWriteError,message:t.L_SetDataParametersConflict};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSelectionCannotBound]={name:t.L_BindingCreationError,message:t.L_SelectionCannotBound};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist]={name:t.L_InvalidBindingError,message:t.L_BindingNotExist};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingToMultipleSelection]={name:t.L_BindingCreationError,message:t.L_BindingToMultipleSelection};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType]={name:t.L_BindingCreationError,message:t.L_InvalidSelectionForBindingType};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnThisBindingType]={name:t.L_InvalidBindingOperation,message:t.L_OperationNotSupportedOnThisBindingType};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeNamedItemNotFound]={name:t.L_BindingCreationError,message:t.L_NamedItemNotFound};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeMultipleNamedItemFound]={name:t.L_BindingCreationError,message:t.L_MultipleNamedItemFound};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidNamedItemForBindingType]={name:t.L_BindingCreationError,message:t.L_InvalidNamedItemForBindingType};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeUnknownBindingType]={name:t.L_InvalidBinding,message:t.L_UnknownBindingType};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnMatrixData]={name:t.L_InvalidBindingOperation,message:t.L_OperationNotSupportedOnMatrixData};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidColumnsForBinding]={name:t.L_InvalidBinding,message:t.L_InvalidColumnsForBinding};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSettingNameNotExist]={name:t.L_ReadSettingsError,message:t.L_SettingNameNotExist};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSettingsCannotSave]={name:t.L_SaveSettingsError,message:t.L_SettingsCannotSave};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSettingsAreStale]={name:t.L_SettingsStaleError,message:t.L_SettingsAreStale};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupported]={name:t.L_HostError,message:t.L_OperationNotSupported};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError]={name:t.L_InternalError,message:t.L_InternalErrorDescription};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeDocumentReadOnly]={name:t.L_PermissionDenied,message:t.L_DocumentReadOnly};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeEventHandlerNotExist]={name:t.L_EventRegistrationError,message:t.L_EventHandlerNotExist};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext]={name:t.L_InvalidAPICall,message:t.L_InvalidApiCallInContext};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeShuttingDown]={name:t.L_ShuttingDown,message:t.L_ShuttingDown};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration]={name:t.L_UnsupportedEnumeration,message:t.L_UnsupportedEnumerationMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange]={name:t.L_IndexOutOfRange,message:t.L_IndexOutOfRange};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported]={name:t.L_APINotSupported,message:t.L_BrowserAPINotSupported};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTimeout]={name:t.L_APICallFailed,message:t.L_RequestTimeout};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidOrTimedOutSession]={name:t.L_InvalidOrTimedOutSession,message:t.L_InvalidOrTimedOutSessionMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests]={name:t.L_APICallFailed,message:t.L_TooManyIncompleteRequests};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeRequestTokenUnavailable]={name:t.L_APICallFailed,message:t.L_RequestTokenUnavailable};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeActivityLimitReached]={name:t.L_APICallFailed,message:t.L_ActivityLimitReached};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiArguments]={name:t.L_APICallFailed,message:t.L_InvalidApiArgumentsMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeWorkbookHidden]={name:t.L_APICallFailed,message:t.L_WorkbookHiddenMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlNodeNotFound]={name:t.L_InvalidNode,message:t.L_CustomXmlNodeNotFound};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError]={name:t.L_CustomXmlError,message:t.L_CustomXmlError};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlExceedQuota]={name:t.L_CustomXmlExceedQuotaName,message:t.L_CustomXmlExceedQuotaMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlOutOfDate]={name:t.L_CustomXmlOutOfDateName,message:t.L_CustomXmlOutOfDateMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeNoCapability]={name:t.L_PermissionDenied,message:t.L_NoCapability};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo]={name:t.L_CannotNavigateTo,message:t.L_CannotNavigateTo};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist]={name:t.L_SpecifiedIdNotExist,message:t.L_SpecifiedIdNotExist};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeNavOutOfBound]={name:t.L_NavOutOfBound,message:t.L_NavOutOfBound};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeCellDataAmountBeyondLimits]={name:t.L_DataWriteReminder,message:t.L_CellDataAmountBeyondLimits};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeElementMissing]={name:t.L_MissingParameter,message:t.L_ElementMissing};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeProtectedError]={name:t.L_PermissionDenied,message:t.L_NoCapability};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidCellsValue]={name:t.L_InvalidValue,message:t.L_InvalidCellsValue};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidTableOptionValue]={name:t.L_InvalidValue,message:t.L_InvalidTableOptionValue};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidFormatValue]={name:t.L_InvalidValue,message:t.L_InvalidFormatValue};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeRowIndexOutOfRange]={name:t.L_OutOfRange,message:t.L_RowIndexOutOfRange};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeColIndexOutOfRange]={name:t.L_OutOfRange,message:t.L_ColIndexOutOfRange};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeFormatValueOutOfRange]={name:t.L_OutOfRange,message:t.L_FormatValueOutOfRange};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeCellFormatAmountBeyondLimits]={name:t.L_FormattingReminder,message:t.L_CellFormatAmountBeyondLimits};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit]={name:t.L_MemoryLimit,message:t.L_CloseFileBeforeRetrieve};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile]={name:t.L_NetworkProblem,message:t.L_NetworkProblemRetrieveFile};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize]={name:t.L_InvalidValue,message:t.L_SliceSizeNotSupported};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeDialogAlreadyOpened]={name:t.L_DisplayDialogError,message:t.L_DialogAlreadyOpened};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidWidth]={name:t.L_IndexOutOfRange,message:t.L_IndexOutOfRange};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidHeight]={name:t.L_IndexOutOfRange,message:t.L_IndexOutOfRange};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeNavigationError]={name:t.L_DisplayDialogError,message:t.L_NetworkProblem};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidScheme]={name:t.L_DialogNavigateError,message:t.L_DialogInvalidScheme};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains]={name:t.L_DisplayDialogError,message:t.L_DialogAddressNotTrusted};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeRequireHTTPS]={name:t.L_DisplayDialogError,message:t.L_DialogRequireHTTPS};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeEndUserIgnore]={name:t.L_DisplayDialogError,message:t.L_UserClickIgnore};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeCrossZone]={name:t.L_DisplayDialogError,message:t.L_NewWindowCrossZoneErrorString};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave]={name:t.L_APINotSupported,message:t.L_InvalidSSOAddinMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserNotSignedIn]={name:t.L_UserNotSignedIn,message:t.L_UserNotSignedIn};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted]={name:t.L_UserAborted,message:t.L_UserAbortedMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity]={name:t.L_UnsupportedUserIdentity,message:t.L_UnsupportedUserIdentityMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl]={name:t.L_InvalidResourceUrl,message:t.L_InvalidResourceUrlMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant]={name:t.L_InvalidGrant,message:t.L_InvalidGrantMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError]={name:t.L_SSOClientError,message:t.L_SSOClientErrorMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError]={name:t.L_SSOServerError,message:t.L_SSOServerErrorMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeAddinIsAlreadyRequestingToken]={name:t.L_AddinIsAlreadyRequestingToken,message:t.L_AddinIsAlreadyRequestingTokenMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserConsentNotSupportedByCurrentAddinCategory]={name:t.L_SSOUserConsentNotSupportedByCurrentAddinCategory,message:t.L_SSOUserConsentNotSupportedByCurrentAddinCategoryMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost]={name:t.L_SSOConnectionLostError,message:t.L_SSOConnectionLostErrorMessage};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform]={name:t.L_SSOConnectionLostError,message:t.L_SSOUnsupportedPlatform};n[OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationCancelled]={name:t.L_OperationCancelledError,message:t.L_OperationCancelledErrorMessage}}}}(),function(n){var t;(function(n){var rt=function(){function n(){}return n}(),i,t,s,r,h,c,u,l,f,a,v,y,p,w,e,b,k,d,o,g,nt,tt,it;n.RequirementVersion=rt;i=function(){function n(n){this.isSetSupported=function(n,t){var f,u,e,i,r;if(n==undefined)return!1;if(t==undefined&&(t=0),f=this._setMap,u=f._sets,u.hasOwnProperty(n.toLowerCase())){e=u[n.toLowerCase()];try{if((i=this._getVersion(e),t=t+"",r=this._getVersion(t),i.major>0&&i.major>r.major)||i.minor>0&&i.minor>0&&i.major==r.major&&i.minor>=r.minor)return!0}catch(o){return!1}}return!1};this._getVersion=function(n){n=n+"";var t=n.split("."),i=0,r=0;if(t.length<2&&isNaN(Number(n)))throw"version format incorrect";else if(i=Number(t[0]),t.length>=2&&(r=Number(t[1])),isNaN(i)||isNaN(r))throw"version format incorrect";return{minor:r,major:i}};this._setMap=n;this.isSetSupported=this.isSetSupported.bind(this)}return n}();n.RequirementMatrix=i;t=function(){function n(n){this._addSetMap=function(n){for(var t in n)this._sets[t]=n[t]};this._sets=n}return n}();n.DefaultSetRequirement=t;s=function(n){function t(){n.call(this,{dialogapi:1.1})}return __extends(t,n),t}(t);n.DefaultDialogSetRequirement=s;r=function(n){function t(){n.call(this,{bindingevents:1.1,documentevents:1.1,excelapi:1.1,matrixbindings:1.1,matrixcoercion:1.1,selection:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1,textbindings:1.1,textcoercion:1.1})}return __extends(t,n),t}(t);n.ExcelClientDefaultSetRequirement=r;h=function(n){function t(){n.call(this);this._addSetMap({imagecoercion:1.1})}return __extends(t,n),t}(r);n.ExcelClientV1DefaultSetRequirement=h;c=function(n){function t(){n.call(this,{mailbox:1.3})}return __extends(t,n),t}(t);n.OutlookClientDefaultSetRequirement=c;u=function(n){function t(){n.call(this,{bindingevents:1.1,compressedfile:1.1,customxmlparts:1.1,documentevents:1.1,file:1.1,htmlcoercion:1.1,matrixbindings:1.1,matrixcoercion:1.1,ooxmlcoercion:1.1,pdffile:1.1,selection:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1,textbindings:1.1,textcoercion:1.1,textfile:1.1,wordapi:1.1})}return __extends(t,n),t}(t);n.WordClientDefaultSetRequirement=u;l=function(n){function t(){n.call(this);this._addSetMap({customxmlparts:1.2,wordapi:1.2,imagecoercion:1.1})}return __extends(t,n),t}(u);n.WordClientV1DefaultSetRequirement=l;f=function(n){function t(){n.call(this,{activeview:1.1,compressedfile:1.1,documentevents:1.1,file:1.1,pdffile:1.1,selection:1.1,settings:1.1,textcoercion:1.1})}return __extends(t,n),t}(t);n.PowerpointClientDefaultSetRequirement=f;a=function(n){function t(){n.call(this);this._addSetMap({imagecoercion:1.1})}return __extends(t,n),t}(f);n.PowerpointClientV1DefaultSetRequirement=a;v=function(n){function t(){n.call(this,{selection:1.1,textcoercion:1.1})}return __extends(t,n),t}(t);n.ProjectClientDefaultSetRequirement=v;y=function(n){function t(){n.call(this,{bindingevents:1.1,documentevents:1.1,matrixbindings:1.1,matrixcoercion:1.1,selection:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1,textbindings:1.1,textcoercion:1.1,file:1.1})}return __extends(t,n),t}(t);n.ExcelWebDefaultSetRequirement=y;p=function(n){function t(){n.call(this,{compressedfile:1.1,documentevents:1.1,file:1.1,imagecoercion:1.1,matrixcoercion:1.1,ooxmlcoercion:1.1,pdffile:1.1,selection:1.1,settings:1.1,tablecoercion:1.1,textcoercion:1.1,textfile:1.1})}return __extends(t,n),t}(t);n.WordWebDefaultSetRequirement=p;w=function(n){function t(){n.call(this,{activeview:1.1,settings:1.1})}return __extends(t,n),t}(t);n.PowerpointWebDefaultSetRequirement=w;e=function(n){function t(){n.call(this,{mailbox:1.3})}return __extends(t,n),t}(t);n.OutlookWebDefaultSetRequirement=e;b=function(n){function t(){n.call(this,{activeview:1.1,documentevents:1.1,selection:1.1,settings:1.1,textcoercion:1.1})}return __extends(t,n),t}(t);n.SwayWebDefaultSetRequirement=b;k=function(n){function t(){n.call(this,{bindingevents:1.1,partialtablebindings:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1})}return __extends(t,n),t}(t);n.AccessWebDefaultSetRequirement=k;d=function(n){function t(){n.call(this,{bindingevents:1.1,documentevents:1.1,matrixbindings:1.1,matrixcoercion:1.1,selection:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1,textbindings:1.1,textcoercion:1.1})}return __extends(t,n),t}(t);n.ExcelIOSDefaultSetRequirement=d;o=function(n){function t(){n.call(this,{bindingevents:1.1,compressedfile:1.1,customxmlparts:1.1,documentevents:1.1,file:1.1,htmlcoercion:1.1,matrixbindings:1.1,matrixcoercion:1.1,ooxmlcoercion:1.1,pdffile:1.1,selection:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1,textbindings:1.1,textcoercion:1.1,textfile:1.1})}return __extends(t,n),t}(t);n.WordIOSDefaultSetRequirement=o;g=function(n){function t(){n.call(this);this._addSetMap({customxmlparts:1.2,wordapi:1.2})}return __extends(t,n),t}(o);n.WordIOSV1DefaultSetRequirement=g;nt=function(n){function t(){n.call(this,{activeview:1.1,compressedfile:1.1,documentevents:1.1,file:1.1,pdffile:1.1,selection:1.1,settings:1.1,textcoercion:1.1})}return __extends(t,n),t}(t);n.PowerpointIOSDefaultSetRequirement=nt;tt=function(n){function t(){n.call(this,{mailbox:1.1})}return __extends(t,n),t}(t);n.OutlookIOSDefaultSetRequirement=tt;it=function(){function n(){}return n.initializeOsfDda=function(){OSF.OUtil.setNamespace("Requirement",OSF.DDA)},n.getDefaultRequirementMatrix=function(r){var u,f,o,e;return this.initializeDefaultSetMatrix(),u=undefined,f=r.get_requirementMatrix(),f!=undefined&&f.length>0&&typeof JSON!="undefined"?(o=JSON.parse(r.get_requirementMatrix().toLowerCase()),u=new i(new t(o))):(e=n.getClientFullVersionString(r),u=n.DefaultSetArrayMatrix!=undefined&&n.DefaultSetArrayMatrix[e]!=undefined?new i(n.DefaultSetArrayMatrix[e]):new i(new t({}))),u},n.getDefaultDialogRequirementMatrix=function(n){var r=undefined,u=n.get_dialogRequirementMatrix(),f;return u!=undefined&&u.length>0&&typeof JSON!="undefined"?(f=JSON.parse(n.get_requirementMatrix().toLowerCase()),r=new i(new t(f))):r=new i(new s),r},n.getClientFullVersionString=function(n){var i=n.get_appMinorVersion(),u="",r="",t=n.get_appName(),f=t==1024||t==4096||t==8192||t==65536;return f&&n.get_appVersion()==1?r=t==4096&&i>=15?"16.00.01":"16.00":n.get_appName()==64?r=n.get_appVersion():(u=i<10?"0"+i:""+i,r=n.get_appVersion()+"."+u),n.get_appName()+"-"+r},n.initializeDefaultSetMatrix=function(){n.DefaultSetArrayMatrix[n.Excel_RCLIENT_1600]=new r;n.DefaultSetArrayMatrix[n.Word_RCLIENT_1600]=new u;n.DefaultSetArrayMatrix[n.PowerPoint_RCLIENT_1600]=new f;n.DefaultSetArrayMatrix[n.Excel_RCLIENT_1601]=new h;n.DefaultSetArrayMatrix[n.Word_RCLIENT_1601]=new l;n.DefaultSetArrayMatrix[n.PowerPoint_RCLIENT_1601]=new a;n.DefaultSetArrayMatrix[n.Outlook_RCLIENT_1600]=new c;n.DefaultSetArrayMatrix[n.Excel_WAC_1600]=new y;n.DefaultSetArrayMatrix[n.Word_WAC_1600]=new p;n.DefaultSetArrayMatrix[n.Outlook_WAC_1600]=new e;n.DefaultSetArrayMatrix[n.Outlook_WAC_1601]=new e;n.DefaultSetArrayMatrix[n.Project_RCLIENT_1600]=new v;n.DefaultSetArrayMatrix[n.Access_WAC_1600]=new k;n.DefaultSetArrayMatrix[n.PowerPoint_WAC_1600]=new w;n.DefaultSetArrayMatrix[n.Excel_IOS_1600]=new d;n.DefaultSetArrayMatrix[n.SWAY_WAC_1600]=new b;n.DefaultSetArrayMatrix[n.Word_IOS_1600]=new o;n.DefaultSetArrayMatrix[n.Word_IOS_16001]=new g;n.DefaultSetArrayMatrix[n.PowerPoint_IOS_1600]=new nt;n.DefaultSetArrayMatrix[n.Outlook_IOS_1600]=new tt},n.Excel_RCLIENT_1600="1-16.00",n.Excel_RCLIENT_1601="1-16.01",n.Word_RCLIENT_1600="2-16.00",n.Word_RCLIENT_1601="2-16.01",n.PowerPoint_RCLIENT_1600="4-16.00",n.PowerPoint_RCLIENT_1601="4-16.01",n.Outlook_RCLIENT_1600="8-16.00",n.Excel_WAC_1600="16-16.00",n.Word_WAC_1600="32-16.00",n.Outlook_WAC_1600="64-16.00",n.Outlook_WAC_1601="64-16.01",n.Project_RCLIENT_1600="128-16.00",n.Access_WAC_1600="256-16.00",n.PowerPoint_WAC_1600="512-16.00",n.Excel_IOS_1600="1024-16.00",n.SWAY_WAC_1600="2048-16.00",n.Word_IOS_1600="4096-16.00",n.Word_IOS_16001="4096-16.00.01",n.PowerPoint_IOS_1600="8192-16.00",n.Outlook_IOS_1600="65536-16.00",n.DefaultSetArrayMatrix={},n}();n.RequirementsMatrixFactory=it})(t=n.Requirement||(n.Requirement={}))}(OfficeExt||(OfficeExt={}));OfficeExt.Requirement.RequirementsMatrixFactory.initializeOsfDda();Microsoft.Office.WebExtension.ApplicationMode={WebEditor:"webEditor",WebViewer:"webViewer",Client:"client"};Microsoft.Office.WebExtension.DocumentMode={ReadOnly:"readOnly",ReadWrite:"readWrite"};OSF.NamespaceManager=function(){var t,n=!1;return{enableShortcut:function(){n||(window.Office?t=window.Office:OSF.OUtil.setNamespace("Office",window),window.Office=Microsoft.Office.WebExtension,n=!0)},disableShortcut:function(){n&&(t?window.Office=t:OSF.OUtil.unsetNamespace("Office",window),n=!1)}}}();OSF.NamespaceManager.enableShortcut();Microsoft.Office.WebExtension.useShortNamespace=function(n){n?OSF.NamespaceManager.enableShortcut():OSF.NamespaceManager.disableShortcut()};Microsoft.Office.WebExtension.select=function(n,t){var i,r,o,u,f,e;if(n&&typeof n=="string"&&(r=n.indexOf("#"),r!=-1)){o=n.substring(0,r);u=n.substring(r+1);switch(o){case"binding":case"bindings":u&&(i=new OSF.DDA.BindingPromise(u));break}}if(i)return i.onFail=t,i;else if(t)if(f=typeof t,f=="function")e={},e[Microsoft.Office.WebExtension.Parameters.Callback]=t,OSF.DDA.issueAsyncResult(e,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext,OSF.DDA.ErrorCodeManager.getErrorArgs(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext));else throw OSF.OUtil.formatString(Strings.OfficeOM.L_CallbackNotAFunction,f);};OSF.DDA.Context=function(n,t,i,r,u){var e,f;OSF.OUtil.defineEnumerableProperties(this,{contentLanguage:{value:n.get_dataLocale()},displayLanguage:{value:n.get_appUILocale()},touchEnabled:{value:n.get_touchEnabled()},commerceAllowed:{value:n.get_commerceAllowed()},host:{value:OfficeExt.HostName.Host.getInstance().getHost()},platform:{value:OfficeExt.HostName.Host.getInstance().getPlatform()},isDialog:{value:OSF._OfficeAppFactory.getHostInfo().isDialog},diagnostics:{value:OfficeExt.HostName.Host.getInstance().getDiagnostics(n.get_hostFullVersion())}});i&&OSF.OUtil.defineEnumerableProperty(this,"license",{value:i});n.ui&&OSF.OUtil.defineEnumerableProperty(this,"ui",{value:n.ui});n.auth&&OSF.OUtil.defineEnumerableProperty(this,"auth",{value:n.auth});n.webAuth&&OSF.OUtil.defineEnumerableProperty(this,"webAuth",{value:n.webAuth});n.application&&OSF.OUtil.defineEnumerableProperty(this,"application",{value:n.application});n.get_isDialog()?(f=OfficeExt.Requirement.RequirementsMatrixFactory.getDefaultDialogRequirementMatrix(n),OSF.OUtil.defineEnumerableProperty(this,"requirements",{value:f})):(t&&OSF.OUtil.defineEnumerableProperty(this,"document",{value:t}),r&&(e=r.displayName||"appOM",delete r.displayName,OSF.OUtil.defineEnumerableProperty(this,e,{value:r})),u&&OSF.OUtil.defineEnumerableProperty(this,"officeTheme",{get:function(){return u()}}),f=OfficeExt.Requirement.RequirementsMatrixFactory.getDefaultRequirementMatrix(n),OSF.OUtil.defineEnumerableProperty(this,"requirements",{value:f}))};OSF.DDA.OutlookContext=function(n,t,i,r,u){OSF.DDA.OutlookContext.uber.constructor.call(this,n,null,i,r,u);t&&OSF.OUtil.defineEnumerableProperty(this,"roamingSettings",{value:t})};OSF.OUtil.extend(OSF.DDA.OutlookContext,OSF.DDA.Context);OSF.DDA.OutlookAppOm=function(n,t,i){};OSF.DDA.Application=function(n){};OSF.DDA.Document=function(n,t){var i;switch(n.get_clientMode()){case OSF.ClientMode.ReadOnly:i=Microsoft.Office.WebExtension.DocumentMode.ReadOnly;break;case OSF.ClientMode.ReadWrite:i=Microsoft.Office.WebExtension.DocumentMode.ReadWrite;break}t&&OSF.OUtil.defineEnumerableProperty(this,"settings",{value:t});OSF.OUtil.defineMutableProperties(this,{mode:{value:i},url:{value:n.get_docUrl()}})};OSF.DDA.JsomDocument=function(n,t,i){OSF.DDA.JsomDocument.uber.constructor.call(this,n,i);t&&OSF.OUtil.defineEnumerableProperty(this,"bindings",{get:function(){return t}});var r=OSF.DDA.AsyncMethodNames;OSF.DDA.DispIdHost.addAsyncMethods(this,[r.GetSelectedDataAsync,r.SetSelectedDataAsync]);OSF.DDA.DispIdHost.addEventSupport(this,new OSF.EventDispatch([Microsoft.Office.WebExtension.EventType.DocumentSelectionChanged]))};OSF.OUtil.extend(OSF.DDA.JsomDocument,OSF.DDA.Document);OSF.OUtil.defineEnumerableProperty(Microsoft.Office.WebExtension,"context",{get:function(){var n;return OSF&&OSF._OfficeAppFactory&&(n=OSF._OfficeAppFactory.getContext()),n}});OSF.DDA.License=function(n){OSF.OUtil.defineEnumerableProperty(this,"value",{value:n})};OSF.DDA.ApiMethodCall=function(n,t,i,r,u){var f=n.length,e=OSF.OUtil.delayExecutionAndCache(function(){return OSF.OUtil.formatString(Strings.OfficeOM.L_InvalidParameters,u)});this.verifyArguments=function(n,t){var u,i,r;for(u in n){if(i=n[u],r=t[u],i["enum"])switch(typeof r){case"string":if(OSF.OUtil.listContainsValue(i["enum"],r))break;case"undefined":throw OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration;default:throw e();}if(i.types&&!OSF.OUtil.listContainsValue(i.types,typeof r))throw e();}};this.extractRequiredArguments=function(t,i,r){var o,u,h,s,c,l;if(t.length<f)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_MissingRequiredArguments);for(o=[],u=0;u<f;u++)o.push(t[u]);for(this.verifyArguments(n,o),h={},u=0;u<f;u++){if(s=n[u],c=o[u],s.verify&&(l=s.verify(c,i,r),!l))throw e();h[s.name]=c}return h};this.fillOptions=function(n,i,r,u){var o,f,e;n=n||{};for(o in t)OSF.OUtil.listContainsKey(n,o)||(f=undefined,e=t[o],e.calculate&&i&&(f=e.calculate(i,r,u)),f||e.defaultValue===undefined||(f=e.defaultValue),n[o]=f);return n};this.constructCallArgs=function(n,t,u,f){var e={},o,s,h;for(o in n)e[o]=n[o];for(s in t)e[s]=t[s];for(h in i)e[h]=i[h](u,f);return r&&(e=r(e,u,f)),e}};OSF.OUtil.setNamespace("AsyncResultEnum",OSF.DDA);OSF.DDA.AsyncResultEnum.Properties={Context:"Context",Value:"Value",Status:"Status",Error:"Error"};Microsoft.Office.WebExtension.AsyncResultStatus={Succeeded:"succeeded",Failed:"failed"};OSF.DDA.AsyncResultEnum.ErrorCode={Success:0,Failed:1};OSF.DDA.AsyncResultEnum.ErrorProperties={Name:"Name",Message:"Message",Code:"Code"};OSF.DDA.AsyncMethodNames={};OSF.DDA.AsyncMethodNames.addNames=function(n){var t,i;for(t in n)i={},OSF.OUtil.defineEnumerableProperties(i,{id:{value:t},displayName:{value:n[t]}}),OSF.DDA.AsyncMethodNames[t]=i};OSF.DDA.AsyncMethodCall=function(n,t,i,r,u,f,e){function h(n,i,r,u){var f,e,h,c;if(n.length>s+2)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyArguments);for(h=n.length-1;h>=s;h--){c=n[h];switch(typeof c){case"object":if(f)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyOptionalObjects);else f=c;break;case"function":if(e)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyOptionalFunction);else e=c;break;default:throw OsfMsAjaxFactory.msAjaxError.argument(Strings.OfficeOM.L_InValidOptionalArgument);break}}if(f=o.fillOptions(f,i,r,u),e)if(f[Microsoft.Office.WebExtension.Parameters.Callback])throw Strings.OfficeOM.L_RedundantCallbackSpecification;else f[Microsoft.Office.WebExtension.Parameters.Callback]=e;return o.verifyArguments(t,f),f}var s=n.length,o=new OSF.DDA.ApiMethodCall(n,t,i,f,e);this.verifyAndExtractCall=function(n,t,i){var r=o.extractRequiredArguments(n,t,i),u=h(n,r,t,i);return o.constructCallArgs(r,u,t,i)};this.processResponse=function(n,t,i,f){return n==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?r?r(t,i,f):t:u?u(n,t):OSF.DDA.ErrorCodeManager.getErrorArgs(n)};this.getCallArgs=function(n){for(var i,t,r,u=n.length-1;u>=s;u--){i=n[u];switch(typeof i){case"object":t=i;break;case"function":r=i;break}}return t=t||{},r&&(t[Microsoft.Office.WebExtension.Parameters.Callback]=r),t}};OSF.DDA.AsyncMethodCallFactory=function(){return{manufacture:function(n){var t=n.supportedOptions?OSF.OUtil.createObject(n.supportedOptions):[],i=n.privateStateCallbacks?OSF.OUtil.createObject(n.privateStateCallbacks):[];return new OSF.DDA.AsyncMethodCall(n.requiredArguments||[],t,i,n.onSucceeded,n.onFailed,n.checkCallArgs,n.method.displayName)}}}();OSF.DDA.AsyncMethodCalls={};OSF.DDA.AsyncMethodCalls.define=function(n){OSF.DDA.AsyncMethodCalls[n.method.id]=OSF.DDA.AsyncMethodCallFactory.manufacture(n)};OSF.DDA.Error=function(n,t,i){OSF.OUtil.defineEnumerableProperties(this,{name:{value:n},message:{value:t},code:{value:i}})};OSF.DDA.AsyncResult=function(n,t){OSF.OUtil.defineEnumerableProperties(this,{value:{value:n[OSF.DDA.AsyncResultEnum.Properties.Value]},status:{value:t?Microsoft.Office.WebExtension.AsyncResultStatus.Failed:Microsoft.Office.WebExtension.AsyncResultStatus.Succeeded}});n[OSF.DDA.AsyncResultEnum.Properties.Context]&&OSF.OUtil.defineEnumerableProperty(this,"asyncContext",{value:n[OSF.DDA.AsyncResultEnum.Properties.Context]});t&&OSF.OUtil.defineEnumerableProperty(this,"error",{value:new OSF.DDA.Error(t[OSF.DDA.AsyncResultEnum.ErrorProperties.Name],t[OSF.DDA.AsyncResultEnum.ErrorProperties.Message],t[OSF.DDA.AsyncResultEnum.ErrorProperties.Code])})};OSF.DDA.issueAsyncResult=function(n,t,i){var f=n[Microsoft.Office.WebExtension.Parameters.Callback],u,r;f&&(u={},u[OSF.DDA.AsyncResultEnum.Properties.Context]=n[Microsoft.Office.WebExtension.Parameters.AsyncContext],t==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?u[OSF.DDA.AsyncResultEnum.Properties.Value]=i:(r={},i=i||OSF.DDA.ErrorCodeManager.getErrorArgs(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),r[OSF.DDA.AsyncResultEnum.ErrorProperties.Code]=t||OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,r[OSF.DDA.AsyncResultEnum.ErrorProperties.Name]=i.name||i,r[OSF.DDA.AsyncResultEnum.ErrorProperties.Message]=i.message||i),f(new OSF.DDA.AsyncResult(u,r)))};OSF.DDA.SyncMethodNames={};OSF.DDA.SyncMethodNames.addNames=function(n){var t,i;for(t in n)i={},OSF.OUtil.defineEnumerableProperties(i,{id:{value:t},displayName:{value:n[t]}}),OSF.DDA.SyncMethodNames[t]=i};OSF.DDA.SyncMethodCall=function(n,t,i,r,u){function o(n,i,r,u){var o,c,s,h;if(n.length>e+1)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyArguments);for(s=n.length-1;s>=e;s--){h=n[s];switch(typeof h){case"object":if(o)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyOptionalObjects);else o=h;break;default:throw OsfMsAjaxFactory.msAjaxError.argument(Strings.OfficeOM.L_InValidOptionalArgument);break}}return o=f.fillOptions(o,i,r,u),f.verifyArguments(t,o),o}var e=n.length,f=new OSF.DDA.ApiMethodCall(n,t,i,r,u);this.verifyAndExtractCall=function(n,t,i){var r=f.extractRequiredArguments(n,t,i),u=o(n,r,t,i);return f.constructCallArgs(r,u,t,i)}};OSF.DDA.SyncMethodCallFactory=function(){return{manufacture:function(n){var t=n.supportedOptions?OSF.OUtil.createObject(n.supportedOptions):[];return new OSF.DDA.SyncMethodCall(n.requiredArguments||[],t,n.privateStateCallbacks,n.checkCallArgs,n.method.displayName)}}}();OSF.DDA.SyncMethodCalls={};OSF.DDA.SyncMethodCalls.define=function(n){OSF.DDA.SyncMethodCalls[n.method.id]=OSF.DDA.SyncMethodCallFactory.manufacture(n)};OSF.DDA.ListType=function(){var n={};return{setListType:function(t,i){n[t]=i},isListType:function(t){return OSF.OUtil.listContainsKey(n,t)},getDescriptor:function(t){return n[t]}}}();OSF.DDA.HostParameterMap=function(n,t){function f(u,e){var a=u?{}:undefined,s,h,o,v,c,l;for(s in u){if(h=u[s],OSF.DDA.ListType.isListType(s)){o=[];for(v in h)o.push(f(h[v],e))}else OSF.OUtil.listContainsKey(i,s)?o=i[s][e](h):e==r&&n.preserveNesting(s)?o=f(h,e):(c=t[s],c?(l=c[e],l&&(o=l[h],o===undefined&&(o=h))):o=h);a[s]=o}return a}function h(i,r){var o,f,c,s;for(f in r)c=n.isComplexType(f)?h(i,t[f][e]):i[f],c!=undefined&&(o||(o={}),s=r[f],s==u&&(s=f),o[s]=n.pack(f,c));return o}function o(i,f,e){var h,a,c,l,p,v,y;e||(e={});for(h in f){if(a=f[h],a==u)c=i;else if(a==s){e[h]=i.toArray();continue}else c=i[a];if(c===null||c===undefined)e[h]=undefined;else if(c=n.unpack(h,c),n.isComplexType(h))l=t[h][r],n.preserveNesting(h)?e[h]=o(c,l):o(c,l,e);else if(OSF.DDA.ListType.isListType(h)){l={};p=OSF.DDA.ListType.getDescriptor(h);l[p]=u;v=new Array(c.length);for(y in c)v[y]=o(c[y],l);e[h]=v}else e[h]=c}return e}function c(n,i,r){var e=t[n][r],u,s,c;return r=="toHost"?(s=f(i,r),u=h(s,e)):r=="fromHost"&&(c=o(i,e),u=f(c,r)),u}var e="toHost",r="fromHost",s="sourceData",u="self",i={};i[Microsoft.Office.WebExtension.Parameters.Data]={toHost:function(n){if(n!=null&&n.rows!==undefined){var t={};t[OSF.DDA.TableDataProperties.TableRows]=n.rows;t[OSF.DDA.TableDataProperties.TableHeaders]=n.headers;n=t}return n},fromHost:function(n){return n}};i[Microsoft.Office.WebExtension.Parameters.SampleData]=i[Microsoft.Office.WebExtension.Parameters.Data];t||(t={});this.addMapping=function(n,i){var o,h,c,l,f,s,a,v;if(i.map){o=i.map;h={};for(c in o)l=o[c],l==u&&(l=c),h[l]=c}else o=i.toHost,h=i.fromHost;if(f=t[n],f){s=f[e];for(a in s)o[a]=s[a];s=f[r];for(v in s)h[v]=s[v]}else f=t[n]={};f[e]=o;f[r]=h};this.toHost=function(n,t){return c(n,t,e)};this.fromHost=function(n,t){return c(n,t,r)};this.self=u;this.sourceData=s;this.addComplexType=function(t){n.addComplexType(t)};this.getDynamicType=function(t){return n.getDynamicType(t)};this.setDynamicType=function(t,i){n.setDynamicType(t,i)};this.dynamicTypes=i;this.doMapValues=function(n,t){return f(n,t)}};OSF.DDA.SpecialProcessor=function(n,t){this.addComplexType=function(t){n.push(t)};this.getDynamicType=function(n){return t[n]};this.setDynamicType=function(n,i){t[n]=i};this.isComplexType=function(t){return OSF.OUtil.listContainsValue(n,t)};this.isDynamicType=function(n){return OSF.OUtil.listContainsKey(t,n)};this.preserveNesting=function(n){var t=[];return OSF.DDA.PropertyDescriptors&&t.push(OSF.DDA.PropertyDescriptors.Subset),OSF.DDA.DataNodeEventProperties&&(t=t.concat([OSF.DDA.DataNodeEventProperties.OldNode,OSF.DDA.DataNodeEventProperties.NewNode,OSF.DDA.DataNodeEventProperties.NextSiblingNode])),OSF.OUtil.listContainsValue(t,n)};this.pack=function(n,i){return this.isDynamicType(n)?t[n].toHost(i):i};this.unpack=function(n,i){return this.isDynamicType(n)?t[n].fromHost(i):i}};OSF.DDA.getDecoratedParameterMap=function(n,t){function r(n){var i=null,r,t;if(n)for(i={},r=n.length,t=0;t<r;t++)i[n[t].name]=n[t].value;return i}var i=new OSF.DDA.HostParameterMap(n),f=i.self,u;i.define=function(n){var t={},u=r(n.toHost);n.invertible?t.map=u:n.canonical?t.toHost=t.fromHost=u:(t.toHost=u,t.fromHost=r(n.fromHost));i.addMapping(n.type,t);n.isComplexType&&i.addComplexType(n.type)};for(u in t)i.define(t[u]);return i};OSF.OUtil.setNamespace("DispIdHost",OSF.DDA);OSF.DDA.DispIdHost.Methods={InvokeMethod:"invokeMethod",AddEventHandler:"addEventHandler",RemoveEventHandler:"removeEventHandler",OpenDialog:"openDialog",CloseDialog:"closeDialog",MessageParent:"messageParent",SendMessage:"sendMessage"};OSF.DDA.DispIdHost.Delegates={ExecuteAsync:"executeAsync",RegisterEventAsync:"registerEventAsync",UnregisterEventAsync:"unregisterEventAsync",ParameterMap:"parameterMap",OpenDialog:"openDialog",CloseDialog:"closeDialog",MessageParent:"messageParent",SendMessage:"sendMessage"};OSF.DDA.DispIdHost.Facade=function(n,t){function l(n){return n==OSF.DDA.EventDispId.dispidObjectDeletedEvent||n==OSF.DDA.EventDispId.dispidObjectSelectionChangedEvent||n==OSF.DDA.EventDispId.dispidObjectDataChangedEvent||n==OSF.DDA.EventDispId.dispidContentControlAddedEvent}function e(n,t,i,r){if(typeof n=="number")r||(r=t.getCallArgs(i)),OSF.DDA.issueAsyncResult(r,n,OSF.DDA.ErrorCodeManager.getErrorArgs(n));else throw n;}var r={},u=OSF.DDA.AsyncMethodNames,i=OSF.DDA.MethodDispId,c={GoToByIdAsync:i.dispidNavigateToMethod,GetSelectedDataAsync:i.dispidGetSelectedDataMethod,SetSelectedDataAsync:i.dispidSetSelectedDataMethod,GetDocumentCopyChunkAsync:i.dispidGetDocumentCopyChunkMethod,ReleaseDocumentCopyAsync:i.dispidReleaseDocumentCopyMethod,GetDocumentCopyAsync:i.dispidGetDocumentCopyMethod,AddFromSelectionAsync:i.dispidAddBindingFromSelectionMethod,AddFromPromptAsync:i.dispidAddBindingFromPromptMethod,AddFromNamedItemAsync:i.dispidAddBindingFromNamedItemMethod,GetAllAsync:i.dispidGetAllBindingsMethod,GetByIdAsync:i.dispidGetBindingMethod,ReleaseByIdAsync:i.dispidReleaseBindingMethod,GetDataAsync:i.dispidGetBindingDataMethod,SetDataAsync:i.dispidSetBindingDataMethod,AddRowsAsync:i.dispidAddRowsMethod,AddColumnsAsync:i.dispidAddColumnsMethod,DeleteAllDataValuesAsync:i.dispidClearAllRowsMethod,RefreshAsync:i.dispidLoadSettingsMethod,SaveAsync:i.dispidSaveSettingsMethod,GetActiveViewAsync:i.dispidGetActiveViewMethod,GetFilePropertiesAsync:i.dispidGetFilePropertiesMethod,GetOfficeThemeAsync:i.dispidGetOfficeThemeMethod,GetDocumentThemeAsync:i.dispidGetDocumentThemeMethod,ClearFormatsAsync:i.dispidClearFormatsMethod,SetTableOptionsAsync:i.dispidSetTableOptionsMethod,SetFormatsAsync:i.dispidSetFormatsMethod,GetAccessTokenAsync:i.dispidGetAccessTokenMethod,GetAuthContextAsync:i.dispidGetAuthContextMethod,ExecuteRichApiRequestAsync:i.dispidExecuteRichApiRequestMethod,AppCommandInvocationCompletedAsync:i.dispidAppCommandInvocationCompletedMethod,CloseContainerAsync:i.dispidCloseContainerMethod,OpenBrowserWindow:i.dispidOpenBrowserWindow,CreateDocumentAsync:i.dispidCreateDocumentMethod,InsertFormAsync:i.dispidInsertFormMethod,ExecuteFeature:i.dispidExecuteFeature,QueryFeature:i.dispidQueryFeature,AddDataPartAsync:i.dispidAddDataPartMethod,GetDataPartByIdAsync:i.dispidGetDataPartByIdMethod,GetDataPartsByNameSpaceAsync:i.dispidGetDataPartsByNamespaceMethod,GetPartXmlAsync:i.dispidGetDataPartXmlMethod,GetPartNodesAsync:i.dispidGetDataPartNodesMethod,DeleteDataPartAsync:i.dispidDeleteDataPartMethod,GetNodeValueAsync:i.dispidGetDataNodeValueMethod,GetNodeXmlAsync:i.dispidGetDataNodeXmlMethod,GetRelativeNodesAsync:i.dispidGetDataNodesMethod,SetNodeValueAsync:i.dispidSetDataNodeValueMethod,SetNodeXmlAsync:i.dispidSetDataNodeXmlMethod,AddDataPartNamespaceAsync:i.dispidAddDataNamespaceMethod,GetDataPartNamespaceAsync:i.dispidGetDataUriByPrefixMethod,GetDataPartPrefixAsync:i.dispidGetDataPrefixByUriMethod,GetNodeTextAsync:i.dispidGetDataNodeTextMethod,SetNodeTextAsync:i.dispidSetDataNodeTextMethod,GetSelectedTask:i.dispidGetSelectedTaskMethod,GetTask:i.dispidGetTaskMethod,GetWSSUrl:i.dispidGetWSSUrlMethod,GetTaskField:i.dispidGetTaskFieldMethod,GetSelectedResource:i.dispidGetSelectedResourceMethod,GetResourceField:i.dispidGetResourceFieldMethod,GetProjectField:i.dispidGetProjectFieldMethod,GetSelectedView:i.dispidGetSelectedViewMethod,GetTaskByIndex:i.dispidGetTaskByIndexMethod,GetResourceByIndex:i.dispidGetResourceByIndexMethod,SetTaskField:i.dispidSetTaskFieldMethod,SetResourceField:i.dispidSetResourceFieldMethod,GetMaxTaskIndex:i.dispidGetMaxTaskIndexMethod,GetMaxResourceIndex:i.dispidGetMaxResourceIndexMethod,CreateTask:i.dispidCreateTaskMethod},s,f,h,o;for(f in c)u[f]&&(r[u[f].id]=c[f]);u=OSF.DDA.SyncMethodNames;i=OSF.DDA.MethodDispId;s={MessageParent:i.dispidMessageParentMethod,SendMessage:i.dispidSendMessageMethod};for(f in s)u[f]&&(r[u[f].id]=s[f]);u=Microsoft.Office.WebExtension.EventType;i=OSF.DDA.EventDispId;h={SettingsChanged:i.dispidSettingsChangedEvent,DocumentSelectionChanged:i.dispidDocumentSelectionChangedEvent,BindingSelectionChanged:i.dispidBindingSelectionChangedEvent,BindingDataChanged:i.dispidBindingDataChangedEvent,ActiveViewChanged:i.dispidActiveViewChangedEvent,OfficeThemeChanged:i.dispidOfficeThemeChangedEvent,DocumentThemeChanged:i.dispidDocumentThemeChangedEvent,AppCommandInvoked:i.dispidAppCommandInvokedEvent,DialogMessageReceived:i.dispidDialogMessageReceivedEvent,DialogParentMessageReceived:i.dispidDialogParentMessageReceivedEvent,ObjectDeleted:i.dispidObjectDeletedEvent,ObjectSelectionChanged:i.dispidObjectSelectionChangedEvent,ObjectDataChanged:i.dispidObjectDataChangedEvent,ContentControlAdded:i.dispidContentControlAddedEvent,RichApiMessage:i.dispidRichApiMessageEvent,ItemChanged:i.dispidOlkItemSelectedChangedEvent,RecipientsChanged:i.dispidOlkRecipientsChangedEvent,AppointmentTimeChanged:i.dispidOlkAppointmentTimeChangedEvent,RecurrenceChanged:i.dispidOlkRecurrenceChangedEvent,AttachmentsChanged:i.dispidOlkAttachmentsChangedEvent,EnhancedLocationsChanged:i.dispidOlkEnhancedLocationsChangedEvent,InfobarClicked:i.dispidOlkInfobarClickedEvent,TaskSelectionChanged:i.dispidTaskSelectionChangedEvent,ResourceSelectionChanged:i.dispidResourceSelectionChangedEvent,ViewSelectionChanged:i.dispidViewSelectionChangedEvent,DataNodeInserted:i.dispidDataNodeAddedEvent,DataNodeReplaced:i.dispidDataNodeReplacedEvent,DataNodeDeleted:i.dispidDataNodeDeletedEvent};for(o in h)u[o]&&(r[u[o]]=h[o]);this[OSF.DDA.DispIdHost.Methods.InvokeMethod]=function(i,u,f,o){var s,l,a,c,y,w,p,b;try{l=i.id;a=OSF.DDA.AsyncMethodCalls[l];s=a.verifyAndExtractCall(u,f,o);var v=r[l],k=n(l),h=null;window.Excel&&window.Office.context.requirements.isSetSupported("RedirectV1Api")&&(window.Excel._RedirectV1APIs=!0);window.Excel&&window.Excel._RedirectV1APIs&&(h=window.Excel._V1APIMap[l])?(c=OSF.OUtil.shallowCopy(s),delete c[Microsoft.Office.WebExtension.Parameters.AsyncContext],h.preprocess&&(c=h.preprocess(c)),y=new window.Excel.RequestContext,w=h.call(y,c),y.sync().then(function(){var n=w.value,t=n.status;delete n.status;delete n["@odata.type"];h.postprocess&&(n=h.postprocess(n,c));t!=0&&(n=OSF.DDA.ErrorCodeManager.getErrorArgs(t));OSF.DDA.issueAsyncResult(s,t,n)})["catch"](function(n){OSF.DDA.issueAsyncResult(s,OSF.DDA.ErrorCodeManager.errorCodes.ooeFailure,null)})):(p=t.toHost?t.toHost(v,s):s,b=(new Date).getTime(),k[OSF.DDA.DispIdHost.Delegates.ExecuteAsync]({dispId:v,hostCallArgs:p,onCalling:function(){},onReceiving:function(){},onComplete:function(n,i){var r,u;if(r=n==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?t.fromHost?t.fromHost(v,i):i:i,u=a.processResponse(n,r,f,s),OSF.DDA.issueAsyncResult(s,n,u),OSF.AppTelemetry&&!(OSF.ConstantNames&&OSF.ConstantNames.IsCustomFunctionsRuntime))OSF.AppTelemetry.onMethodDone(v,p,Math.abs((new Date).getTime()-b),n)}}))}catch(d){e(d,a,u,s)}};this[OSF.DDA.DispIdHost.Methods.AddEventHandler]=function(i,u,f,o){function p(n){var t,i;n==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(t=c?u.addObjectEventHandler(s,h[Microsoft.Office.WebExtension.Parameters.Id],y):u.addEventHandler(s,y),t||(n=OSF.DDA.ErrorCodeManager.errorCodes.ooeEventHandlerAdditionFailed));n!=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(i=OSF.DDA.ErrorCodeManager.getErrorArgs(n));OSF.DDA.issueAsyncResult(h,n,i)}var h,s,y,c=!1,w,v,a,b,k;try{if(w=OSF.DDA.AsyncMethodCalls[OSF.DDA.AsyncMethodNames.AddHandlerAsync.id],h=w.verifyAndExtractCall(i,f,u),s=h[Microsoft.Office.WebExtension.Parameters.EventType],y=h[Microsoft.Office.WebExtension.Parameters.Handler],o){p(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return}v=r[s];c=l(v);a=c?h[Microsoft.Office.WebExtension.Parameters.Id]:f.id||"";b=c?u.getObjectEventHandlerCount(s,a):u.getEventHandlerCount(s);b==0?(k=n(s)[OSF.DDA.DispIdHost.Delegates.RegisterEventAsync],k({eventType:s,dispId:v,targetId:a,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)},onComplete:p,onEvent:function(n){var i=t.fromHost(v,n);c?u.fireObjectEvent(a,OSF.DDA.OMFactory.manufactureEventArgs(s,a,i)):u.fireEvent(OSF.DDA.OMFactory.manufactureEventArgs(s,f,i))}})):p(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(d){e(d,w,i,h)}};this[OSF.DDA.DispIdHost.Methods.RemoveEventHandler]=function(t,i,u){function w(n){var t;n!=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(t=OSF.DDA.ErrorCodeManager.getErrorArgs(n));OSF.DDA.issueAsyncResult(o,n,t)}var o,f,c,s=!1,v,y,h,p,a,b,k;try{v=OSF.DDA.AsyncMethodCalls[OSF.DDA.AsyncMethodNames.RemoveHandlerAsync.id];o=v.verifyAndExtractCall(t,u,i);f=o[Microsoft.Office.WebExtension.Parameters.EventType];c=o[Microsoft.Office.WebExtension.Parameters.Handler];y=r[f];s=l(y);h=s?o[Microsoft.Office.WebExtension.Parameters.Id]:u.id||"";c===null?(a=s?i.clearObjectEventHandlers(f,h):i.clearEventHandlers(f),p=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):(a=s?i.removeObjectEventHandler(f,h,c):i.removeEventHandler(f,c),p=a?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:OSF.DDA.ErrorCodeManager.errorCodes.ooeEventHandlerNotExist);b=s?i.getObjectEventHandlerCount(f,h):i.getEventHandlerCount(f);a&&b==0?(k=n(f)[OSF.DDA.DispIdHost.Delegates.UnregisterEventAsync],k({eventType:f,dispId:y,targetId:h,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)},onComplete:w})):w(p)}catch(d){e(d,v,t,o)}};this[OSF.DDA.DispIdHost.Methods.OpenDialog]=function(i,u,f){function a(n){var t,i;n!=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?i=OSF.DDA.ErrorCodeManager.getErrorArgs(n):(t={},t[Microsoft.Office.WebExtension.Parameters.Id]=l,t[Microsoft.Office.WebExtension.Parameters.Data]=u,i=c.processResponse(n,t,f,s),OSF.DialogShownStatus.hasDialogShown=!0,u.clearEventHandlers(o),u.clearEventHandlers(h));OSF.DDA.issueAsyncResult(s,n,i)}var s,l,o=Microsoft.Office.WebExtension.EventType.DialogMessageReceived,h=Microsoft.Office.WebExtension.EventType.DialogEventReceived,c;try{if((o==undefined||h==undefined)&&a(OSF.DDA.ErrorCodeManager.ooeOperationNotSupported),OSF.DDA.AsyncMethodNames.DisplayDialogAsync==null){a(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return}c=OSF.DDA.AsyncMethodCalls[OSF.DDA.AsyncMethodNames.DisplayDialogAsync.id];s=c.verifyAndExtractCall(i,f,u);var y=r[o],v=n(o),p=v[OSF.DDA.DispIdHost.Delegates.OpenDialog]!=undefined?v[OSF.DDA.DispIdHost.Delegates.OpenDialog]:v[OSF.DDA.DispIdHost.Delegates.RegisterEventAsync];l=JSON.stringify(s);OSF.DialogShownStatus.hasDialogShown||(u.clearQueuedEvent(o),u.clearQueuedEvent(h),u.clearQueuedEvent(Microsoft.Office.WebExtension.EventType.DialogParentMessageReceived));p({eventType:o,dispId:y,targetId:l,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)},onComplete:a,onEvent:function(n){var s=t.fromHost(y,n),e=OSF.DDA.OMFactory.manufactureEventArgs(o,f,s),r,i;e.type==h&&(r=OSF.DDA.ErrorCodeManager.getErrorArgs(e.error),i={},i[OSF.DDA.AsyncResultEnum.ErrorProperties.Code]=status||OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,i[OSF.DDA.AsyncResultEnum.ErrorProperties.Name]=r.name||r,i[OSF.DDA.AsyncResultEnum.ErrorProperties.Message]=r.message||r,e.error=new OSF.DDA.Error(i[OSF.DDA.AsyncResultEnum.ErrorProperties.Name],i[OSF.DDA.AsyncResultEnum.ErrorProperties.Message],i[OSF.DDA.AsyncResultEnum.ErrorProperties.Code]));u.fireOrQueueEvent(e);s[OSF.DDA.PropertyDescriptors.MessageType]==OSF.DialogMessageType.DialogClosed&&(u.clearEventHandlers(o),u.clearEventHandlers(h),u.clearEventHandlers(Microsoft.Office.WebExtension.EventType.DialogParentMessageReceived),OSF.DialogShownStatus.hasDialogShown=!1)}})}catch(w){e(w,c,i,s)}};this[OSF.DDA.DispIdHost.Methods.CloseDialog]=function(t,i,u,f){function v(n){s=n;OSF.DialogShownStatus.hasDialogShown=!1}var l,o,a,s=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,h;try{h=OSF.DDA.AsyncMethodCalls[OSF.DDA.AsyncMethodNames.CloseAsync.id];l=h.verifyAndExtractCall(t,f,u);o=Microsoft.Office.WebExtension.EventType.DialogMessageReceived;a=Microsoft.Office.WebExtension.EventType.DialogEventReceived;u.clearEventHandlers(o);u.clearEventHandlers(a);var y=r[o],c=n(o),p=c[OSF.DDA.DispIdHost.Delegates.CloseDialog]!=undefined?c[OSF.DDA.DispIdHost.Delegates.CloseDialog]:c[OSF.DDA.DispIdHost.Delegates.UnregisterEventAsync];p({eventType:o,dispId:y,targetId:i,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)},onComplete:v})}catch(w){e(w,h,t,l)}if(s!=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)throw OSF.OUtil.formatString(Strings.OfficeOM.L_FunctionCallFailed,OSF.DDA.AsyncMethodNames.CloseAsync.displayName,s);};this[OSF.DDA.DispIdHost.Methods.MessageParent]=function(t,i){var u={},f=OSF.DDA.SyncMethodCalls[OSF.DDA.SyncMethodNames.MessageParent.id],e=f.verifyAndExtractCall(t,i,u),o=n(OSF.DDA.SyncMethodNames.MessageParent.id),s=o[OSF.DDA.DispIdHost.Delegates.MessageParent],h=r[OSF.DDA.SyncMethodNames.MessageParent.id];return s({dispId:h,hostCallArgs:e,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)}})};this[OSF.DDA.DispIdHost.Methods.SendMessage]=function(t,i,u){var f={},e=OSF.DDA.SyncMethodCalls[OSF.DDA.SyncMethodNames.SendMessage.id],o=e.verifyAndExtractCall(t,u,f),s=n(OSF.DDA.SyncMethodNames.SendMessage.id),h=s[OSF.DDA.DispIdHost.Delegates.SendMessage],c=r[OSF.DDA.SyncMethodNames.SendMessage.id];return h({dispId:c,hostCallArgs:o,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)}})}};OSF.DDA.DispIdHost.addAsyncMethods=function(n,t,i){var f,r,u;for(f in t)r=t[f],u=r.displayName,n[u]||OSF.OUtil.defineEnumerableProperty(n,u,{value:function(t){return function(){var r=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.InvokeMethod];r(t,arguments,n,i)}}(r)})};OSF.DDA.DispIdHost.addEventSupport=function(n,t,i){var r=OSF.DDA.AsyncMethodNames.AddHandlerAsync.displayName,u=OSF.DDA.AsyncMethodNames.RemoveHandlerAsync.displayName;n[r]||OSF.OUtil.defineEnumerableProperty(n,r,{value:function(){var r=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.AddEventHandler];r(arguments,t,n,i)}});n[u]||OSF.OUtil.defineEnumerableProperty(n,u,{value:function(){var i=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.RemoveEventHandler];i(arguments,t,n)}})},function(n){var f=function(){function n(){}return n.isInstanceOfType=function(n,t){if(typeof t=="undefined"||t===null)return!1;if(t instanceof n)return!0;var i=t.constructor;return i&&typeof i=="function"&&i.__typeName&&i.__typeName!=="Object"||(i=Object),!!(i===n)||i.__typeName&&n.__typeName&&i.__typeName===n.__typeName},n}(),r,t,u,i;n.MsAjaxTypeHelper=f;r=function(){function n(){}return n.create=function(n,t){var i=new Error(n),r;if(i.message=n,t)for(r in t)i[r]=t[r];return i.popStackFrame(),i},n.parameterCount=function(t){var r="Sys.ParameterCountException: "+(t?t:"Parameter count mismatch."),i=n.create(r,{name:"Sys.ParameterCountException"});return i.popStackFrame(),i},n.argument=function(i,r){var f="Sys.ArgumentException: "+(r?r:"Value does not fall within the expected range."),u;return i&&(f+="\n"+t.format("Parameter name: {0}",i)),u=n.create(f,{name:"Sys.ArgumentException",paramName:i}),u.popStackFrame(),u},n.argumentNull=function(i,r){var f="Sys.ArgumentNullException: "+(r?r:"Value cannot be null."),u;return i&&(f+="\n"+t.format("Parameter name: {0}",i)),u=n.create(f,{name:"Sys.ArgumentNullException",paramName:i}),u.popStackFrame(),u},n.argumentOutOfRange=function(i,r,u){var f="Sys.ArgumentOutOfRangeException: "+(u?u:"Specified argument was out of the range of valid values."),e;return i&&(f+="\n"+t.format("Parameter name: {0}",i)),typeof r!="undefined"&&r!==null&&(f+="\n"+t.format("Actual value was {0}.",r)),e=n.create(f,{name:"Sys.ArgumentOutOfRangeException",paramName:i,actualValue:r}),e.popStackFrame(),e},n.argumentType=function(i,r,u,f){var e="Sys.ArgumentTypeException: ",o;return e+=f?f:r&&u?t.format("Object of type '{0}' cannot be converted to type '{1}'.",r.getName?r.getName():r,u.getName?u.getName():u):"Object cannot be converted to the required type.",i&&(e+="\n"+t.format("Parameter name: {0}",i)),o=n.create(e,{name:"Sys.ArgumentTypeException",paramName:i,actualType:r,expectedType:u}),o.popStackFrame(),o},n.argumentUndefined=function(i,r){var f="Sys.ArgumentUndefinedException: "+(r?r:"Value cannot be undefined."),u;return i&&(f+="\n"+t.format("Parameter name: {0}",i)),u=n.create(f,{name:"Sys.ArgumentUndefinedException",paramName:i}),u.popStackFrame(),u},n.invalidOperation=function(t){var r="Sys.InvalidOperationException: "+(t?t:"Operation is not valid due to the current state of the object."),i=n.create(r,{name:"Sys.InvalidOperationException"});return i.popStackFrame(),i},n}();n.MsAjaxError=r;t=function(){function n(){}return n.format=function(n){for(var r,i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return r=n,r.replace(/{(\d+)}/gm,function(n,t){var r=parseInt(t,10);return i[r]===undefined?"{"+t+"}":i[r]})},n.startsWith=function(n,t){return n.substr(0,t.length)===t},n}();n.MsAjaxString=t;u=function(){function n(){}return n.trace=function(n){},n}();n.MsAjaxDebug=u;OsfMsAjaxFactory.isMsAjaxLoaded()||(i=function(n,t,i){(n.__typeName===undefined||n.__typeName===null)&&(n.__typeName=t);(n.__class===undefined||n.__class===null)&&(n.__class=i)},i(Function,"Function",!0),i(Error,"Error",!0),i(Object,"Object",!0),i(String,"String",!0),i(Boolean,"Boolean",!0),i(Date,"Date",!0),i(Number,"Number",!0),i(RegExp,"RegExp",!0),i(Array,"Array",!0),Function.createCallback||(Function.createCallback=function(n,t){var i=Function._validateParams(arguments,[{name:"method",type:Function},{name:"context",mayBeNull:!0}]);if(i)throw i;return function(){var u=arguments.length,r,i;if(u>0){for(r=[],i=0;i<u;i++)r[i]=arguments[i];return r[u]=t,n.apply(this,r)}return n.call(this,t)}}),Function.createDelegate||(Function.createDelegate=function(n,t){var i=Function._validateParams(arguments,[{name:"instance",mayBeNull:!0},{name:"method",type:Function}]);if(i)throw i;return function(){return t.apply(n,arguments)}}),Function._validateParams||(Function._validateParams=function(n,t,i){var r,e=t.length,u,s,f,o;if(i=i||typeof i=="undefined",r=Function._validateParameterCount(n,t,i),r)return r.popStackFrame(),r;for(u=0,s=n.length;u<s;u++){if(f=t[Math.min(u,e-1)],o=f.name,f.parameterArray)o+="["+(u-e+1)+"]";else if(!i&&u>=e)break;if(r=Function._validateParameter(n[u],f,o),r)return r.popStackFrame(),r}return null}),Function._validateParameterCount||(Function._validateParameterCount=function(n,t,i){var u,e,f=t.length,o=n.length,s,h,c;if(o<f){for(s=f,u=0;u<f;u++)h=t[u],(h.optional||h.parameterArray)&&s--;o<s&&(e=!0)}else if(i&&o>f)for(e=!0,u=0;u<f;u++)if(t[u].parameterArray){e=!1;break}return e?(c=r.parameterCount(),c.popStackFrame(),c):null}),Function._validateParameter||(Function._validateParameter=function(n,t,i){var r,o=t.type,l=!!t.integer,a=!!t.domElement,v=!!t.mayBeNull,f,e,s,h,u,c;if(r=Function._validateParameterType(n,o,l,a,v,i),r)return r.popStackFrame(),r;if(f=t.elementType,e=!!t.elementMayBeNull,o===Array&&typeof n!="undefined"&&n!==null&&(f||!e))for(s=!!t.elementInteger,h=!!t.elementDomElement,u=0;u<n.length;u++)if(c=n[u],r=Function._validateParameterType(c,f,s,h,e,i+"["+u+"]"),r)return r.popStackFrame(),r;return null}),Function._validateParameterType||(Function._validateParameterType=function(t,i,r,u,f,e){var o,s;return typeof t=="undefined"?f?null:(o=n.MsAjaxError.argumentUndefined(e),o.popStackFrame(),o):t===null?f?null:(o=n.MsAjaxError.argumentNull(e),o.popStackFrame(),o):i&&!n.MsAjaxTypeHelper.isInstanceOfType(i,t)?(o=n.MsAjaxError.argumentType(e,typeof t,i),o.popStackFrame(),o):null}),window.Type||(window.Type=Function),Type.registerNamespace||(Type.registerNamespace=function(n){for(var i=n.split("."),r=window,t=0;t<i.length;t++)r[i[t]]=r[i[t]]||{},r=r[i[t]]}),Type.prototype.registerClass||(Type.prototype.registerClass=function(n){n={}}),typeof Sys=="undefined"&&Type.registerNamespace("Sys"),Error.prototype.popStackFrame||(Error.prototype.popStackFrame=function(){var u,t;if(arguments.length!==0)throw r.parameterCount();if(typeof this.stack!="undefined"&&this.stack!==null&&typeof this.fileName!="undefined"&&this.fileName!==null&&typeof this.lineNumber!="undefined"&&this.lineNumber!==null){for(var n=this.stack.split("\n"),i=n[0],f=this.fileName+":"+this.lineNumber;typeof i!="undefined"&&i!==null&&i.indexOf(f)===-1;)n.shift(),i=n[0];(u=n[1],typeof u!="undefined"&&u!==null)&&(t=u.match(/@(.*):(\d+)$/),typeof t!="undefined"&&t!==null)&&(this.fileName=t[1],this.lineNumber=parseInt(t[2]),n.shift(),this.stack=n.join("\n"))}}),OsfMsAjaxFactory.msAjaxError=r,OsfMsAjaxFactory.msAjaxString=t,OsfMsAjaxFactory.msAjaxDebug=u)}(OfficeExt||(OfficeExt={}));OSF.OUtil.setNamespace("SafeArray",OSF.DDA);OSF.DDA.SafeArray.Response={Status:0,Payload:1};OSF.DDA.SafeArray.UniqueArguments={Offset:"offset",Run:"run",BindingSpecificData:"bindingSpecificData",MergedCellGuid:"{66e7831f-81b2-42e2-823c-89e872d541b3}"};OSF.OUtil.setNamespace("Delegate",OSF.DDA.SafeArray);OSF.DDA.SafeArray.Delegate._onException=function(n,t){var i,r=n.number;if(r)switch(r){case-2146828218:i=OSF.DDA.ErrorCodeManager.errorCodes.ooeNoCapability;break;case-2147467259:i=OSF.DDA.ErrorCodeManager.errorCodes.ooeDialogAlreadyOpened;break;case-2146828283:i=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;break;case-2147209089:i=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;break;case-2147208704:i=OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests;break;case-2146827850:default:i=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;break}if(t.onComplete)t.onComplete(i||OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)};OSF.DDA.SafeArray.Delegate._onExceptionSyncMethod=function(n,t){var i,r=n.number;if(r)switch(r){case-2146828218:i=OSF.DDA.ErrorCodeManager.errorCodes.ooeNoCapability;break;case-2146827850:default:i=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;break}return i||OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError};OSF.DDA.SafeArray.Delegate.SpecialProcessor=function(){function n(n){var t,e,i,r,u,f,o;try{if(e=n.ubound(1),i=n.ubound(2),n=n.toArray(),e==1&&i==1)t=[n];else for(t=[],r=0;r<e;r++){for(u=[],f=0;f<i;f++)o=n[r*i+f],o!=OSF.DDA.SafeArray.UniqueArguments.MergedCellGuid&&u.push(o);u.length>0&&t.push(u)}}catch(s){}return t}var i=[],t={};t[Microsoft.Office.WebExtension.Parameters.Data]=function(){var t=0,i=1;return{toHost:function(n){if(OSF.DDA.TableDataProperties&&typeof n!="string"&&n[OSF.DDA.TableDataProperties.TableRows]!==undefined){var r=[];r[t]=n[OSF.DDA.TableDataProperties.TableRows];r[i]=n[OSF.DDA.TableDataProperties.TableHeaders];n=r}return n},fromHost:function(r){var f,e,u;return r.toArray?(e=r.dimensions(),e===2?f=n(r):(u=r.toArray(),u.length===2&&(u[0]!=null&&u[0].toArray||u[1]!=null&&u[1].toArray)?(f={},f[OSF.DDA.TableDataProperties.TableRows]=n(u[t]),f[OSF.DDA.TableDataProperties.TableHeaders]=n(u[i])):f=u)):f=r,f}}}();OSF.DDA.SafeArray.Delegate.SpecialProcessor.uber.constructor.call(this,i,t);this.unpack=function(n,i){var r,u;return this.isComplexType(n)||OSF.DDA.ListType.isListType(n)?(u=(i||typeof i=="unknown")&&i.toArray,r=u?i.toArray():i||{}):r=this.isDynamicType(n)?t[n].fromHost(i):i,r}};OSF.OUtil.extend(OSF.DDA.SafeArray.Delegate.SpecialProcessor,OSF.DDA.SpecialProcessor);OSF.DDA.SafeArray.Delegate.ParameterMap=OSF.DDA.getDecoratedParameterMap(new OSF.DDA.SafeArray.Delegate.SpecialProcessor,[{type:Microsoft.Office.WebExtension.Parameters.ValueFormat,toHost:[{name:Microsoft.Office.WebExtension.ValueFormat.Unformatted,value:0},{name:Microsoft.Office.WebExtension.ValueFormat.Formatted,value:1}]},{type:Microsoft.Office.WebExtension.Parameters.FilterType,toHost:[{name:Microsoft.Office.WebExtension.FilterType.All,value:0}]}]);OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.PropertyDescriptors.AsyncResultStatus,fromHost:[{name:Microsoft.Office.WebExtension.AsyncResultStatus.Succeeded,value:0},{name:Microsoft.Office.WebExtension.AsyncResultStatus.Failed,value:1}]});OSF.DDA.SafeArray.Delegate.executeAsync=function(n){function t(n){var i=n,f,r,u;if(OSF.OUtil.isArray(n))for(f=i.length,r=0;r<f;r++)i[r]=t(i[r]);else if(OSF.OUtil.isDate(n))i=n.getVarDate();else if(typeof n=="object"&&!OSF.OUtil.isArray(n)){i=[];for(u in n)OSF.OUtil.isFunction(n[u])||(i[u]=t(n[u]))}return i}function i(n){var u=n,r,t;if(n!=null&&n.toArray)for(r=n.toArray(),u=new Array(r.length),t=0;t<r.length;t++)u[t]=i(r[t]);return u}try{n.onCalling&&n.onCalling();OSF.ClientHostController.execute(n.dispId,t(n.hostCallArgs),function(t,r){var f=t.toArray(),o=f[OSF.DDA.SafeArray.Response.Status],u,e,s;if(o==OSF.DDA.ErrorCodeManager.errorCodes.ooeChunkResult)return u=f[OSF.DDA.SafeArray.Response.Payload],u=i(u),u!=null&&(n._chunkResultData||(n._chunkResultData=[]),n._chunkResultData[u[0]]=u[1]),!1;if(n.onReceiving&&n.onReceiving(),n.onComplete){if(o==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){if(f.length>2)for(u=[],e=1;e<f.length;e++)u[e-1]=f[e];else u=f[OSF.DDA.SafeArray.Response.Payload];n._chunkResultData&&(u=i(u),u!=null&&(s=u[u.length-1],n._chunkResultData.length==s?u[u.length-1]=n._chunkResultData:o=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))}else u=f[OSF.DDA.SafeArray.Response.Payload];n.onComplete(o,u)}return!0})}catch(r){OSF.DDA.SafeArray.Delegate._onException(r,n)}};OSF.DDA.SafeArray.Delegate._getOnAfterRegisterEvent=function(n,t){var i=(new Date).getTime();return function(r){t.onReceiving&&t.onReceiving();var u=r.toArray?r.toArray()[OSF.DDA.SafeArray.Response.Status]:r;if(t.onComplete)t.onComplete(u);if(OSF.AppTelemetry)OSF.AppTelemetry.onRegisterDone(n,t.dispId,Math.abs((new Date).getTime()-i),u)}};OSF.DDA.SafeArray.Delegate.registerEventAsync=function(n){n.onCalling&&n.onCalling();var t=OSF.DDA.SafeArray.Delegate._getOnAfterRegisterEvent(!0,n);try{OSF.ClientHostController.registerEvent(n.dispId,n.targetId,function(t,i){if(n.onEvent)n.onEvent(i);if(OSF.AppTelemetry)OSF.AppTelemetry.onEventDone(n.dispId)},t)}catch(i){OSF.DDA.SafeArray.Delegate._onException(i,n)}};OSF.DDA.SafeArray.Delegate.unregisterEventAsync=function(n){n.onCalling&&n.onCalling();var t=OSF.DDA.SafeArray.Delegate._getOnAfterRegisterEvent(!1,n);try{OSF.ClientHostController.unregisterEvent(n.dispId,n.targetId,t)}catch(i){OSF.DDA.SafeArray.Delegate._onException(i,n)}};OSF.ClientMode={ReadWrite:0,ReadOnly:1};OSF.DDA.RichInitializationReason={1:Microsoft.Office.WebExtension.InitializationReason.Inserted,2:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened};OSF.InitializationHelper=function(n,t,i,r,u){this._hostInfo=n;this._webAppState=t;this._context=i;this._settings=r;this._hostFacade=u;this._initializeSettings=this.initializeSettings};OSF.InitializationHelper.prototype.deserializeSettings=function(n,t){var r=OSF.OUtil.getSessionStorage(),i,u;return r&&(i=r.getItem(OSF._OfficeAppFactory.getCachedSessionSettingsKey()),i?n=JSON.parse(i):(i=JSON.stringify(n),r.setItem(OSF._OfficeAppFactory.getCachedSessionSettingsKey(),i))),u=OSF.DDA.SettingsManager.deserializeSettings(n),t?new OSF.DDA.RefreshableSettings(u):new OSF.DDA.Settings(u)};OSF.InitializationHelper.prototype.saveAndSetDialogInfo=function(n){};OSF.InitializationHelper.prototype.setAgaveHostCommunication=function(){};OSF.InitializationHelper.prototype.prepareRightBeforeWebExtensionInitialize=function(n){this.prepareApiSurface(n);Microsoft.Office.WebExtension.initialize(this.getInitializationReason(n))};OSF.InitializationHelper.prototype.prepareApiSurface=function(n){var r=new OSF.DDA.License(n.get_eToken()),u=OSF.DDA.OfficeTheme&&OSF.DDA.OfficeTheme.getOfficeTheme?OSF.DDA.OfficeTheme.getOfficeTheme:null,t,i;n.get_isDialog()?OSF.DDA.UI.ChildUI&&(n.ui=new OSF.DDA.UI.ChildUI):OSF.DDA.UI.ParentUI&&(n.ui=new OSF.DDA.UI.ParentUI,OfficeExt.Container&&OSF.DDA.DispIdHost.addAsyncMethods(n.ui,[OSF.DDA.AsyncMethodNames.CloseContainerAsync]));OSF.DDA.OpenBrowser&&OSF.DDA.DispIdHost.addAsyncMethods(n.ui,[OSF.DDA.AsyncMethodNames.OpenBrowserWindow]);OSF.DDA.ExecuteFeature&&OSF.DDA.DispIdHost.addAsyncMethods(n.ui,[OSF.DDA.AsyncMethodNames.ExecuteFeature]);OSF.DDA.QueryFeature&&OSF.DDA.DispIdHost.addAsyncMethods(n.ui,[OSF.DDA.AsyncMethodNames.QueryFeature]);OSF.DDA.Auth&&(n.auth=new OSF.DDA.Auth,OSF.DDA.DispIdHost.addAsyncMethods(n.auth,[OSF.DDA.AsyncMethodNames.GetAccessTokenAsync]));OSF._OfficeAppFactory.setContext(new OSF.DDA.Context(n,n.doc,r,null,u));t=OSF.DDA.DispIdHost.getClientDelegateMethods;i=OSF.DDA.SafeArray.Delegate.ParameterMap;OSF._OfficeAppFactory.setHostFacade(new OSF.DDA.DispIdHost.Facade(t,i))};OSF.InitializationHelper.prototype.getInitializationReason=function(n){return OSF.DDA.RichInitializationReason[n.get_reason()]};OSF.DDA.DispIdHost.getClientDelegateMethods=function(n){var t={},i,r;return t[OSF.DDA.DispIdHost.Delegates.ExecuteAsync]=OSF.DDA.SafeArray.Delegate.executeAsync,t[OSF.DDA.DispIdHost.Delegates.RegisterEventAsync]=OSF.DDA.SafeArray.Delegate.registerEventAsync,t[OSF.DDA.DispIdHost.Delegates.UnregisterEventAsync]=OSF.DDA.SafeArray.Delegate.unregisterEventAsync,t[OSF.DDA.DispIdHost.Delegates.OpenDialog]=OSF.DDA.SafeArray.Delegate.openDialog,t[OSF.DDA.DispIdHost.Delegates.CloseDialog]=OSF.DDA.SafeArray.Delegate.closeDialog,t[OSF.DDA.DispIdHost.Delegates.MessageParent]=OSF.DDA.SafeArray.Delegate.messageParent,t[OSF.DDA.DispIdHost.Delegates.SendMessage]=OSF.DDA.SafeArray.Delegate.sendMessage,OSF.DDA.AsyncMethodNames.RefreshAsync&&n==OSF.DDA.AsyncMethodNames.RefreshAsync.id&&(i=function(n,t,i){return OSF.DDA.ClientSettingsManager.read(t,i)},t[OSF.DDA.DispIdHost.Delegates.ExecuteAsync]=OSF.DDA.ClientSettingsManager.getSettingsExecuteMethod(i)),OSF.DDA.AsyncMethodNames.SaveAsync&&n==OSF.DDA.AsyncMethodNames.SaveAsync.id&&(r=function(n,t,i){return OSF.DDA.ClientSettingsManager.write(n[OSF.DDA.SettingsManager.SerializedSettings],n[Microsoft.Office.WebExtension.Parameters.OverwriteIfStale],t,i)},t[OSF.DDA.DispIdHost.Delegates.ExecuteAsync]=OSF.DDA.ClientSettingsManager.getSettingsExecuteMethod(r)),t},function(n){var t=function(){function n(){}return n.prototype.execute=function(n,t,i){typeof OsfOMToken!="undefined"&&OsfOMToken?window.external.Execute(n,t,i,OsfOMToken):window.external.Execute(n,t,i)},n.prototype.registerEvent=function(n,t,i,r){typeof OsfOMToken!="undefined"&&OsfOMToken?window.external.RegisterEvent(n,t,i,r,OsfOMToken):window.external.RegisterEvent(n,t,i,r)},n.prototype.unregisterEvent=function(n,t,i){typeof OsfOMToken!="undefined"&&OsfOMToken?window.external.UnregisterEvent(n,t,i,OsfOMToken):window.external.UnregisterEvent(n,t,i)},n}();n.RichClientHostController=t}(OfficeExt||(OfficeExt={})),function(n){var t=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t.prototype.messageParent=function(n){var t=n[Microsoft.Office.WebExtension.Parameters.MessageToParent];window.external.MessageParent(t)},t.prototype.openDialog=function(n,t,i,r){this.registerEvent(n,t,i,r)},t.prototype.closeDialog=function(n,t,i){this.unregisterEvent(n,t,i)},t.prototype.sendMessage=function(n){},t}(n.RichClientHostController);n.Win32RichClientHostController=t}(OfficeExt||(OfficeExt={})),function(n){var t;(function(t){var i=function(){function n(){this._osfOfficeTheme=null;this._osfOfficeThemeTimeStamp=null}return n.prototype.getOfficeTheme=function(){var t;if(OSF.DDA._OsfControlContext){if(this._osfOfficeTheme&&this._osfOfficeThemeTimeStamp&&(new Date).getTime()-this._osfOfficeThemeTimeStamp<n._osfOfficeThemeCacheValidPeriod){if(OSF.AppTelemetry)OSF.AppTelemetry.onPropertyDone("GetOfficeThemeInfo",0)}else{var r=(new Date).getTime(),u=OSF.DDA._OsfControlContext.GetOfficeThemeInfo(),i=(new Date).getTime();if(OSF.AppTelemetry)OSF.AppTelemetry.onPropertyDone("GetOfficeThemeInfo",Math.abs(i-r));this._osfOfficeTheme=JSON.parse(u);for(t in this._osfOfficeTheme)this._osfOfficeTheme[t]=OSF.OUtil.convertIntToCssHexColor(this._osfOfficeTheme[t]);this._osfOfficeThemeTimeStamp=i}return this._osfOfficeTheme}},n.instance=function(){return n._instance==null&&(n._instance=new n),n._instance},n._osfOfficeThemeCacheValidPeriod=5e3,n._instance=null,n}();t.OfficeThemeManager=i;OSF.OUtil.setNamespace("OfficeTheme",OSF.DDA);OSF.DDA.OfficeTheme.getOfficeTheme=n.OfficeTheme.OfficeThemeManager.instance().getOfficeTheme})(t=n.OfficeTheme||(n.OfficeTheme={}))}(OfficeExt||(OfficeExt={}));OSF.initializeRichCommon=function(){OSF.DDA.ClientSettingsManager={getSettingsExecuteMethod:function(n){return function(t){var i,r;try{r=n(t.hostCallArgs,t.onCalling,t.onReceiving);i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}catch(u){i=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;r={name:Strings.OfficeOM.L_InternalError,message:u}}if(t.onComplete)t.onComplete(i,r)}},read:function(n,t){var r=[],u=[],f,i;for(n&&n(),typeof OsfOMToken!="undefined"&&OsfOMToken?OSF.DDA._OsfControlContext.GetSettings(OsfOMToken).Read(r,u):OSF.DDA._OsfControlContext.GetSettings().Read(r,u),t&&t(),f={},i=0;i<r.length;i++)f[r[i]]=u[i];return f},write:function(n,t,i,r){var u=[],f=[];for(var e in n)u.push(e),f.push(n[e]);i&&i();typeof OsfOMToken!="undefined"&&OsfOMToken?OSF.DDA._OsfControlContext.GetSettings(OsfOMToken).Write(u,f):OSF.DDA._OsfControlContext.GetSettings().Write(u,f);r&&r()}};OSF.InitializationHelper.prototype.initializeSettings=function(n){var t=OSF.DDA.ClientSettingsManager.read();return this.deserializeSettings(t,n)};OSF.InitializationHelper.prototype.getAppContext=function(n,t){var u,i,f="Warning: Office.js is loaded outside of Office client",e,o,s,h,c,l,a,v;try{if(window.external&&typeof window.external.GetContext!="undefined")i=OSF.DDA._OsfControlContext=window.external.GetContext();else{OsfMsAjaxFactory.msAjaxDebug.trace(f);return}}catch(ut){OsfMsAjaxFactory.msAjaxDebug.trace(f);return}var y=i.GetAppType(),p=i.GetSolutionRef(),w=i.GetAppVersionMajor(),b=i.GetAppVersionMinor(),k=i.GetAppUILocale(),d=i.GetAppDataLocale(),g=i.GetDocUrl(),nt=i.GetAppCapabilities(),tt=i.GetActivationMode(),it=i.GetControlIntegrationLevel(),rt=[],r;try{r=i.GetSolutionToken()}catch(ft){}typeof i.GetCorrelationId!="undefined"&&(e=i.GetCorrelationId());typeof i.GetInstanceId!="undefined"&&(o=i.GetInstanceId());typeof i.GetTouchEnabled!="undefined"&&(s=i.GetTouchEnabled());typeof i.GetCommerceAllowed!="undefined"&&(h=i.GetCommerceAllowed());typeof i.GetSupportedMatrix!="undefined"&&(c=i.GetSupportedMatrix());typeof i.GetHostCustomMessage!="undefined"&&(l=i.GetHostCustomMessage());typeof i.GetHostFullVersion!="undefined"&&(a=i.GetHostFullVersion());typeof i.GetDialogRequirementMatrix!="undefined"&&(v=i.GetDialogRequirementMatrix());r=r?r.toString():"";u=new OSF.OfficeAppContext(p,y,w,k,d,g,nt,rt,tt,it,r,e,o,s,h,b,c,l,a,undefined,undefined,undefined,v);OSF.AppTelemetry&&OSF.AppTelemetry.initialize(u);t(u)}};OSF.ClientHostController=new OfficeExt.Win32RichClientHostController;OSF.initializeRichCommon(),function(n){var t=function(){function n(n){this._table=n;this._fields={}}return Object.defineProperty(n.prototype,"Fields",{get:function(){return this._fields},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Table",{get:function(){return this._table},enumerable:!0,configurable:!0}),n.prototype.SerializeFields=function(){},n.prototype.SetSerializedField=function(n,t){typeof t!="undefined"&&t!==null&&(this._serializedFields[n]=t.toString())},n.prototype.SerializeRow=function(){return this._serializedFields={},this.SetSerializedField("Table",this._table),this.SerializeFields(),JSON.stringify(this._serializedFields)},n}(),i,r,u,f,e;n.BaseUsageData=t;i=function(n){function t(){n.call(this,"AppActivated")}return __extends(t,n),Object.defineProperty(t.prototype,"CorrelationId",{get:function(){return this.Fields.CorrelationId},set:function(n){this.Fields.CorrelationId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SessionId",{get:function(){return this.Fields.SessionId},set:function(n){this.Fields.SessionId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AppId",{get:function(){return this.Fields.AppId},set:function(n){this.Fields.AppId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AppInstanceId",{get:function(){return this.Fields.AppInstanceId},set:function(n){this.Fields.AppInstanceId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AppURL",{get:function(){return this.Fields.AppURL},set:function(n){this.Fields.AppURL=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AssetId",{get:function(){return this.Fields.AssetId},set:function(n){this.Fields.AssetId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Browser",{get:function(){return this.Fields.Browser},set:function(n){this.Fields.Browser=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"UserId",{get:function(){return this.Fields.UserId},set:function(n){this.Fields.UserId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Host",{get:function(){return this.Fields.Host},set:function(n){this.Fields.Host=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HostVersion",{get:function(){return this.Fields.HostVersion},set:function(n){this.Fields.HostVersion=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ClientId",{get:function(){return this.Fields.ClientId},set:function(n){this.Fields.ClientId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AppSizeWidth",{get:function(){return this.Fields.AppSizeWidth},set:function(n){this.Fields.AppSizeWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AppSizeHeight",{get:function(){return this.Fields.AppSizeHeight},set:function(n){this.Fields.AppSizeHeight=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Message",{get:function(){return this.Fields.Message},set:function(n){this.Fields.Message=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DocUrl",{get:function(){return this.Fields.DocUrl},set:function(n){this.Fields.DocUrl=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OfficeJSVersion",{get:function(){return this.Fields.OfficeJSVersion},set:function(n){this.Fields.OfficeJSVersion=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HostJSVersion",{get:function(){return this.Fields.HostJSVersion},set:function(n){this.Fields.HostJSVersion=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"WacHostEnvironment",{get:function(){return this.Fields.WacHostEnvironment},set:function(n){this.Fields.WacHostEnvironment=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsFromWacAutomation",{get:function(){return this.Fields.IsFromWacAutomation},set:function(n){this.Fields.IsFromWacAutomation=n},enumerable:!0,configurable:!0}),t.prototype.SerializeFields=function(){this.SetSerializedField("CorrelationId",this.CorrelationId);this.SetSerializedField("SessionId",this.SessionId);this.SetSerializedField("AppId",this.AppId);this.SetSerializedField("AppInstanceId",this.AppInstanceId);this.SetSerializedField("AppURL",this.AppURL);this.SetSerializedField("AssetId",this.AssetId);this.SetSerializedField("Browser",this.Browser);this.SetSerializedField("UserId",this.UserId);this.SetSerializedField("Host",this.Host);this.SetSerializedField("HostVersion",this.HostVersion);this.SetSerializedField("ClientId",this.ClientId);this.SetSerializedField("AppSizeWidth",this.AppSizeWidth);this.SetSerializedField("AppSizeHeight",this.AppSizeHeight);this.SetSerializedField("Message",this.Message);this.SetSerializedField("DocUrl",this.DocUrl);this.SetSerializedField("OfficeJSVersion",this.OfficeJSVersion);this.SetSerializedField("HostJSVersion",this.HostJSVersion);this.SetSerializedField("WacHostEnvironment",this.WacHostEnvironment);this.SetSerializedField("IsFromWacAutomation",this.IsFromWacAutomation)},t}(t);n.AppActivatedUsageData=i;r=function(n){function t(){n.call(this,"ScriptLoad")}return __extends(t,n),Object.defineProperty(t.prototype,"CorrelationId",{get:function(){return this.Fields.CorrelationId},set:function(n){this.Fields.CorrelationId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SessionId",{get:function(){return this.Fields.SessionId},set:function(n){this.Fields.SessionId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ScriptId",{get:function(){return this.Fields.ScriptId},set:function(n){this.Fields.ScriptId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"StartTime",{get:function(){return this.Fields.StartTime},set:function(n){this.Fields.StartTime=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ResponseTime",{get:function(){return this.Fields.ResponseTime},set:function(n){this.Fields.ResponseTime=n},enumerable:!0,configurable:!0}),t.prototype.SerializeFields=function(){this.SetSerializedField("CorrelationId",this.CorrelationId);this.SetSerializedField("SessionId",this.SessionId);this.SetSerializedField("ScriptId",this.ScriptId);this.SetSerializedField("StartTime",this.StartTime);this.SetSerializedField("ResponseTime",this.ResponseTime)},t}(t);n.ScriptLoadUsageData=r;u=function(n){function t(){n.call(this,"AppClosed")}return __extends(t,n),Object.defineProperty(t.prototype,"CorrelationId",{get:function(){return this.Fields.CorrelationId},set:function(n){this.Fields.CorrelationId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SessionId",{get:function(){return this.Fields.SessionId},set:function(n){this.Fields.SessionId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FocusTime",{get:function(){return this.Fields.FocusTime},set:function(n){this.Fields.FocusTime=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AppSizeFinalWidth",{get:function(){return this.Fields.AppSizeFinalWidth},set:function(n){this.Fields.AppSizeFinalWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AppSizeFinalHeight",{get:function(){return this.Fields.AppSizeFinalHeight},set:function(n){this.Fields.AppSizeFinalHeight=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OpenTime",{get:function(){return this.Fields.OpenTime},set:function(n){this.Fields.OpenTime=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CloseMethod",{get:function(){return this.Fields.CloseMethod},set:function(n){this.Fields.CloseMethod=n},enumerable:!0,configurable:!0}),t.prototype.SerializeFields=function(){this.SetSerializedField("CorrelationId",this.CorrelationId);this.SetSerializedField("SessionId",this.SessionId);this.SetSerializedField("FocusTime",this.FocusTime);this.SetSerializedField("AppSizeFinalWidth",this.AppSizeFinalWidth);this.SetSerializedField("AppSizeFinalHeight",this.AppSizeFinalHeight);this.SetSerializedField("OpenTime",this.OpenTime);this.SetSerializedField("CloseMethod",this.CloseMethod)},t}(t);n.AppClosedUsageData=u;f=function(n){function t(){n.call(this,"APIUsage")}return __extends(t,n),Object.defineProperty(t.prototype,"CorrelationId",{get:function(){return this.Fields.CorrelationId},set:function(n){this.Fields.CorrelationId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SessionId",{get:function(){return this.Fields.SessionId},set:function(n){this.Fields.SessionId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"APIType",{get:function(){return this.Fields.APIType},set:function(n){this.Fields.APIType=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"APIID",{get:function(){return this.Fields.APIID},set:function(n){this.Fields.APIID=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Parameters",{get:function(){return this.Fields.Parameters},set:function(n){this.Fields.Parameters=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ResponseTime",{get:function(){return this.Fields.ResponseTime},set:function(n){this.Fields.ResponseTime=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ErrorType",{get:function(){return this.Fields.ErrorType},set:function(n){this.Fields.ErrorType=n},enumerable:!0,configurable:!0}),t.prototype.SerializeFields=function(){this.SetSerializedField("CorrelationId",this.CorrelationId);this.SetSerializedField("SessionId",this.SessionId);this.SetSerializedField("APIType",this.APIType);this.SetSerializedField("APIID",this.APIID);this.SetSerializedField("Parameters",this.Parameters);this.SetSerializedField("ResponseTime",this.ResponseTime);this.SetSerializedField("ErrorType",this.ErrorType)},t}(t);n.APIUsageUsageData=f;e=function(n){function t(){n.call(this,"AppInitialization")}return __extends(t,n),Object.defineProperty(t.prototype,"CorrelationId",{get:function(){return this.Fields.CorrelationId},set:function(n){this.Fields.CorrelationId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SessionId",{get:function(){return this.Fields.SessionId},set:function(n){this.Fields.SessionId=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SuccessCode",{get:function(){return this.Fields.SuccessCode},set:function(n){this.Fields.SuccessCode=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Message",{get:function(){return this.Fields.Message},set:function(n){this.Fields.Message=n},enumerable:!0,configurable:!0}),t.prototype.SerializeFields=function(){this.SetSerializedField("CorrelationId",this.CorrelationId);this.SetSerializedField("SessionId",this.SessionId);this.SetSerializedField("SuccessCode",this.SuccessCode);this.SetSerializedField("Message",this.Message)},t}(t);n.AppInitializationUsageData=e}(OSFLog||(OSFLog={})),function(n){"use strict";function u(){}function f(n,t,i){}function e(){try{return new t}catch(n){return null}}var i,r,t;(function(n){n[n.info=0]="info";n[n.warning=1]="warning";n[n.error=2]="error"})(n.TraceLevel||(n.TraceLevel={}));i=n.TraceLevel,function(n){n[n.none=0]="none";n[n.flush=1]="flush"}(n.SendFlag||(n.SendFlag={}));r=n.SendFlag;n.allowUploadingData=u;n.sendLog=f;t=function(){function n(){}return n.prototype.writeLog=function(n){},n.prototype.loadProxyFrame=function(){},n}();OSF.Logger||(OSF.Logger=n);n.ulsEndpoint=e()}(Logger||(Logger={})),function(n){function s(n,t){var r=t.rename===undefined?t.name:t.rename,u=t.type,i=undefined;switch(u){case"string":i=oteljs.makeStringDataField(r,n);break;case"double":typeof n=="string"&&(n=parseFloat(n));i=oteljs.makeDoubleDataField(r,n);break;case"int64":typeof n=="string"&&(n=parseInt(n));i=oteljs.makeInt64DataField(r,n);break;case"boolean":typeof n=="string"&&(n=n==="true");i=oteljs.makeBooleanDataField(r,n);break}return i}function i(n){for(var r,i=0;i<t.length;i++)if(r=t[i],r.name===n)return r;return undefined}function h(n){var t=i(n);return t===undefined?!1:t.enabled}function c(n,t){var r=i(n),e,u,o,h,f,a,v;if(r===undefined)return undefined;for(e=[],u=0,o=r.points;u<o.length;u++){var c=o[u],y=c.name,l=t[y];l!==undefined&&(h=s(l,c),h!==undefined&&e.push(h))}return f={dataCategories:oteljs.DataCategories.ProductServiceUsage},r.critical&&(f.samplingPolicy=oteljs.SamplingPolicy.CriticalBusinessImpact),r.basic&&(f.diagnosticLevel=oteljs.DiagnosticLevel.BasicEvent),a="Office.Extensibility.OfficeJs."+n+"X",v={eventName:a,dataFields:e,eventFlags:f},v}function l(n,t){if(h(n)&&typeof OTel!="undefined")OTel.OTelLogger.onTelemetryLoaded(function(){var i=c(n,t);i!==undefined&&Microsoft.Office.WebExtension.sendTelemetryEvent(i)})}var r={name:"AppActivated",enabled:!0,basic:!0,critical:!0,points:[{name:"Browser",type:"string"},{name:"Message",type:"string"},{name:"AppURL",type:"string"},{name:"Host",type:"string"},{name:"AppSizeWidth",type:"int64"},{name:"AppSizeHeight",type:"int64"},{name:"IsFromWacAutomation",type:"string"},]},u={name:"ScriptLoad",enabled:!0,basic:!1,critical:!1,points:[{name:"ScriptId",type:"string"},{name:"StartTime",type:"double"},{name:"ResponseTime",type:"double"},]},f={name:"APIUsage",enabled:!1,basic:!1,critical:!1,points:[{name:"APIType",type:"string"},{name:"APIID",type:"int64"},{name:"Parameters",type:"string"},{name:"ResponseTime",type:"int64"},{name:"ErrorType",type:"int64"},]},e={name:"AppInitialization",enabled:!0,basic:!1,critical:!1,points:[{name:"SuccessCode",type:"int64"},{name:"Message",type:"string"},]},o={name:"AppClosed",enabled:!0,basic:!1,critical:!1,points:[{name:"FocusTime",type:"int64"},{name:"AppSizeFinalWidth",type:"int64"},{name:"AppSizeFinalHeight",type:"int64"},{name:"OpenTime",type:"int64"},]},t=[r,u,f,e,o,],a=function(){function n(){}return n.prototype.getAriaCDNLocation=function(){return OSF._OfficeAppFactory.getLoadScriptHelper().getOfficeJsBasePath()+"ariatelemetry/aria-web-telemetry.js"},n.getInstance=function(){return n.AriaLoggerObj===undefined&&(n.AriaLoggerObj=new n),n.AriaLoggerObj},n.prototype.isIUsageData=function(n){return n.Fields!==undefined},n.prototype.sendTelemetry=function(t,i){var r=1e3;n.EnableSendingTelemetryWithLegacyAria&&OSF.OUtil.loadScript(this.getAriaCDNLocation(),function(){var u,n,r,f;try{this.ALogger||(u="db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439",this.ALogger=AWTLogManager.initialize(u));n=new AWTEventProperties;n.setName("Office.Extensibility.OfficeJS."+t);for(r in i)r.toLowerCase()!=="table"&&n.setProperty(r,i[r]);f=new Date;n.setProperty("Date",f.toISOString());this.ALogger.logEvent(n)}catch(e){}},r);n.EnableSendingTelemetryWithOTel&&l(t,i)},n.prototype.logData=function(n){this.isIUsageData(n)?this.sendTelemetry(n.Table,n.Fields):this.sendTelemetry(n.Table,n)},n.EnableSendingTelemetryWithOTel=!0,n.EnableSendingTelemetryWithLegacyAria=!1,n}();n.AriaLogger=a}(OSFAriaLogger||(OSFAriaLogger={})),function(n){"use strict";function r(n){return n&&(n=n.replace(/[{}]/g,"").toLowerCase()),n||""}function a(f){var v,e,h;if(n.enableTelemetry&&!t){t=new o;t.hostVersion=f.get_hostFullVersion()?f.get_hostFullVersion():f.get_appVersion();t.appId=f.get_id();t.host=f.get_appName();t.browser=window.navigator.userAgent;t.correlationId=r(f.get_correlationId());t.clientId=(new s).getClientId();t.appInstanceId=f.get_appInstanceId();t.appInstanceId&&(t.appInstanceId=t.appInstanceId.replace(/[{}]/g,"").toLowerCase());t.message=f.get_hostCustomMessage();t.officeJSVersion=OSF.ConstantNames.FileVersion;t.hostJSVersion="0.0.0.0";f._wacHostEnvironment&&(t.wacHostEnvironment=f._wacHostEnvironment);f._isFromWacAutomation!==undefined&&f._isFromWacAutomation!==null&&(t.isFromWacAutomation=f._isFromWacAutomation.toString().toLowerCase());v=f.get_docUrl();t.docUrl=l.test(v)?v:"";e=location.href;e&&(e=e.split("?")[0].split("#")[0]);t.appURL=c.filter(e),function(n,t){var f,e,i,r,u;t.assetId="";t.userId="";try{f=decodeURIComponent(n);e=new DOMParser;i=e.parseFromString(f,"text/xml");r=i.getElementsByTagName("t")[0].attributes.getNamedItem("cid");u=i.getElementsByTagName("t")[0].attributes.getNamedItem("oid");r&&r.nodeValue?t.userId=r.nodeValue:u&&u.nodeValue&&(t.userId=u.nodeValue);t.assetId=i.getElementsByTagName("t")[0].attributes.getNamedItem("aid").nodeValue}catch(o){}finally{f=null;i=null;e=null}}(f.get_eToken(),t);t.sessionId=i;t.name=f.get_addinName();typeof OTel!="undefined"&&OTel.OTelLogger.initialize(t);var y=10,w=16,b=0,k=11601,a=OSF._OfficeAppFactory.getHostInfo().hostPlatform,p=t.hostVersion;a&&(p||a.toLowerCase()!=="win32")?a&&p&&(h=p.split("."),a.toLowerCase()==="win32"&&(h.length<3||parseInt(h[0],y)>=w&&parseInt(h[1],y)>=b&&parseInt(h[2],y)>=k)&&(OSFAriaLogger.AriaLogger.EnableSendingTelemetryWithLegacyAria=!1)):OSFAriaLogger.AriaLogger.EnableSendingTelemetryWithLegacyAria=!1,function(){var h=new Date,i=null,e=0,s=!1,r=function(){document.hasFocus()?i==null&&(i=new Date):i&&(e+=Math.abs((new Date).getTime()-i.getTime()),i=null)},t=[],o,f;for(t.push(new u("focus",r)),t.push(new u("blur",r)),t.push(new u("focusout",r)),t.push(new u("focusin",r)),o=function(){for(var r=0;r<t.length;r++)OSF.OUtil.removeEventListener(window,t[r].name,t[r].handler);if(t.length=0,!s){document.hasFocus()&&i&&(e+=Math.abs((new Date).getTime()-i.getTime()),i=null);n.onAppClosed(Math.abs((new Date).getTime()-h.getTime()),e);s=!0}},t.push(new u("beforeunload",o)),t.push(new u("unload",o)),f=0;f<t.length;f++)OSF.OUtil.addEventListener(window,t[f].name,t[f].handler);r()}();n.onAppActivated()}}function v(){if(t){(new s).enumerateLog(function(n,t){return(new f).LogRawData(t)},!0);var n=new OSFLog.AppActivatedUsageData;n.SessionId=i;n.AppId=t.appId;n.AssetId=t.assetId;n.AppURL=t.appURL;n.UserId="";n.ClientId=t.clientId;n.Browser=t.browser;n.Host=t.host;n.HostVersion=t.hostVersion;n.CorrelationId=r(t.correlationId);n.AppSizeWidth=window.innerWidth;n.AppSizeHeight=window.innerHeight;n.AppInstanceId=t.appInstanceId;n.Message=t.message;n.DocUrl=t.docUrl;n.OfficeJSVersion=t.officeJSVersion;n.HostJSVersion=t.hostJSVersion;t.wacHostEnvironment&&(n.WacHostEnvironment=t.wacHostEnvironment);t.isFromWacAutomation!==undefined&&t.isFromWacAutomation!==null&&(n.IsFromWacAutomation=t.isFromWacAutomation);(new f).LogData(n)}}function y(n,t,u,e){var o=new OSFLog.ScriptLoadUsageData;o.CorrelationId=r(e);o.SessionId=i;o.ScriptId=n;o.StartTime=t;o.ResponseTime=u;(new f).LogData(o)}function p(n,u,o,s,h){if(t){var c=new OSFLog.APIUsageUsageData;c.CorrelationId=r(e);c.SessionId=i;c.APIType=n;c.APIID=u;c.Parameters=o;c.ResponseTime=s;c.ErrorType=h;(new f).LogData(c)}}function w(n,t,i,r){var u=null,f;if(t)if(typeof t=="number")u=String(t);else if(typeof t=="object")for(f in t)u!==null?u+=",":u="",typeof t[f]=="number"&&(u+=String(t[f]));else u="";OSF.AppTelemetry.onCallDone("method",n,u,i,r)}function b(n,t){OSF.AppTelemetry.onCallDone("property",-1,n,t)}function k(n,t){OSF.AppTelemetry.onCallDone("event",n,null,0,t)}function d(n,t,i,r){OSF.AppTelemetry.onCallDone(n?"registerevent":"unregisterevent",t,null,i,r)}function g(n,u){if(t){var f=new OSFLog.AppClosedUsageData;f.CorrelationId=r(e);f.SessionId=i;f.FocusTime=u;f.OpenTime=n;f.AppSizeFinalWidth=window.innerWidth;f.AppSizeFinalHeight=window.innerHeight;(new s).saveLog(i,f.SerializeRow())}}function nt(n){e=r(n)}function h(n,t){var u=new OSFLog.AppInitializationUsageData;u.CorrelationId=r(e);u.SessionId=i;u.SuccessCode=n?1:0;u.Message=t;(new f).LogData(u)}function tt(n){h(!1,n)}function it(n){h(!0,n)}var t,i=OSF.OUtil.Guid.generateNewGuid(),e="",l=new RegExp("^https?://store\\.office(ppe|-int)?\\.com/","i"),o,c;n.enableTelemetry=!0;o=function(){function n(){}return n}();n.AppInfo=o;var u=function(){function n(n,t){this.name=n;this.handler=t}return n}(),s=function(){function n(){this.clientIDKey="Office API client";this.logIdSetKey="Office App Log Id Set"}return n.prototype.getClientId=function(){var n=this.getValue(this.clientIDKey);return(!n||n.length<=0||n.length>40)&&(n=OSF.OUtil.Guid.generateNewGuid(),this.setValue(this.clientIDKey,n)),n},n.prototype.saveLog=function(n,t){var i=this.getValue(this.logIdSetKey);i=(i&&i.length>0?i+";":"")+n;this.setValue(this.logIdSetKey,i);this.setValue(n,t)},n.prototype.enumerateLog=function(n,t){var f=this.getValue(this.logIdSetKey),r,e,i,u;if(f){r=f.split(";");for(e in r)i=r[e],u=this.getValue(i),u&&(n&&n(i,u),t&&this.remove(i));t&&this.remove(this.logIdSetKey)}},n.prototype.getValue=function(n){var t=OSF.OUtil.getLocalStorage(),i="";return t&&(i=t.getItem(n)),i},n.prototype.setValue=function(n,t){var i=OSF.OUtil.getLocalStorage();i&&i.setItem(n,t)},n.prototype.remove=function(n){var t=OSF.OUtil.getLocalStorage();if(t)try{t.removeItem(n)}catch(i){}},n}(),f=function(){function t(){}return t.prototype.LogData=function(t){if(n.enableTelemetry)try{OSFAriaLogger.AriaLogger.getInstance().logData(t)}catch(i){}},t.prototype.LogRawData=function(t){if(n.enableTelemetry)try{OSFAriaLogger.AriaLogger.getInstance().logData(JSON.parse(t))}catch(i){}},t}();c=function(){function n(){}return n.hashString=function(n){var t=0,i,r;if(n.length===0)return t;for(i=0;i<n.length;i++)r=n.charCodeAt(i),t=(t<<5)-t+r|0;return t},n.stringToHash=function(t){var i=n.hashString(t),r=i.toString();return i<0?"1"+r.substring(1):"0"+r},n.startsWith=function(n,t){return n.indexOf(t)==-0},n.isFileUrl=function(t){return n.startsWith(t.toLowerCase(),"file:")},n.removeHttpPrefix=function(t){var i="";return n.startsWith(t.toLowerCase(),n.httpsPrefix)?i=n.httpsPrefix:n.startsWith(t.toLowerCase(),n.httpPrefix)&&(i=n.httpPrefix),t.slice(i.length)},n.getUrlDomain=function(t){var i=n.removeHttpPrefix(t);return i=i.split("/")[0],i.split(":")[0]},n.isIp4Address=function(n){var t=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;return t.test(n)},n.filter=function(t){var r,i;if(n.isFileUrl(t))return i=n.stringToHash(t),"file://"+i;if(r=n.getUrlDomain(t),n.isIp4Address(r)){if(i=n.stringToHash(t),n.startsWith(r,"10."))return"IP10Range_"+i;else if(n.startsWith(r,"192."))return"IP192Range_"+i;else if(n.startsWith(r,"127."))return"IP127Range_"+i;return"IPOther_"+i}return r},n.httpPrefix="http://",n.httpsPrefix="https://",n}();n.initialize=a;n.onAppActivated=v;n.onScriptDone=y;n.onCallDone=p;n.onMethodDone=w;n.onPropertyDone=b;n.onEventDone=k;n.onRegisterDone=d;n.onAppClosed=g;n.setOsfControlAppCorrelationId=nt;n.doAppInitializationLogging=h;n.logAppCommonMessage=tt;n.logAppException=it;OSF.AppTelemetry=n}(OSFAppTelemetry||(OSFAppTelemetry={}));Microsoft.Office.WebExtension.FileType={Text:"text",Compressed:"compressed",Pdf:"pdf"};OSF.OUtil.augmentList(OSF.DDA.PropertyDescriptors,{FileProperties:"FileProperties",FileSliceProperties:"FileSliceProperties"});OSF.DDA.FileProperties={Handle:"FileHandle",FileSize:"FileSize",SliceSize:Microsoft.Office.WebExtension.Parameters.SliceSize};OSF.DDA.File=function(n,t,i){var r,u;OSF.OUtil.defineEnumerableProperties(this,{size:{value:t},sliceCount:{value:Math.ceil(t/i)}});r={};r[OSF.DDA.FileProperties.Handle]=n;r[OSF.DDA.FileProperties.SliceSize]=i;u=OSF.DDA.AsyncMethodNames;OSF.DDA.DispIdHost.addAsyncMethods(this,[u.GetDocumentCopyChunkAsync,u.ReleaseDocumentCopyAsync],r)};OSF.DDA.FileSliceOffset="fileSliceoffset";OSF.DDA.AsyncMethodNames.addNames({GetDocumentCopyAsync:"getFileAsync",GetDocumentCopyChunkAsync:"getSliceAsync",ReleaseDocumentCopyAsync:"closeAsync"});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.GetDocumentCopyAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.FileType,"enum":Microsoft.Office.WebExtension.FileType}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.SliceSize,value:{types:["number"],defaultValue:4194304}}],checkCallArgs:function(n,t,i){var r=n[Microsoft.Office.WebExtension.Parameters.SliceSize];if(r<=0||r>4194304)throw OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize;return n},onSucceeded:function(n,t,i){return new OSF.DDA.File(n[OSF.DDA.FileProperties.Handle],n[OSF.DDA.FileProperties.FileSize],i[Microsoft.Office.WebExtension.Parameters.SliceSize])}});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.GetDocumentCopyChunkAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.SliceIndex,types:["number"]}],privateStateCallbacks:[{name:OSF.DDA.FileProperties.Handle,value:function(n,t){return t[OSF.DDA.FileProperties.Handle]}},{name:OSF.DDA.FileProperties.SliceSize,value:function(n,t){return t[OSF.DDA.FileProperties.SliceSize]}}],checkCallArgs:function(n,t,i){var r=n[Microsoft.Office.WebExtension.Parameters.SliceIndex];if(r<0||r>=t.sliceCount)throw OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange;return n[OSF.DDA.FileSliceOffset]=parseInt((r*i[OSF.DDA.FileProperties.SliceSize]).toString()),n},onSucceeded:function(n,t,i){var r={};return OSF.OUtil.defineEnumerableProperties(r,{data:{value:n[Microsoft.Office.WebExtension.Parameters.Data]},index:{value:i[Microsoft.Office.WebExtension.Parameters.SliceIndex]},size:{value:n[OSF.DDA.FileProperties.SliceSize]}}),r}});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.ReleaseDocumentCopyAsync,privateStateCallbacks:[{name:OSF.DDA.FileProperties.Handle,value:function(n,t){return t[OSF.DDA.FileProperties.Handle]}}]});Microsoft.Office.WebExtension.EventType={};OSF.EventDispatch=function(n){var i,t,r;if(this._eventHandlers={},this._objectEventHandlers={},this._queuedEventsArgs={},n!=null)for(i=0;i<n.length;i++)t=n[i],r=t=="objectDeleted"||t=="objectSelectionChanged"||t=="objectDataChanged"||t=="contentControlAdded",r?this._objectEventHandlers[t]={}:this._eventHandlers[t]=[],this._queuedEventsArgs[t]=[]};OSF.EventDispatch.prototype={getSupportedEvents:function(){var n=[];for(var t in this._eventHandlers)n.push(t);for(t in this._objectEventHandlers)n.push(t);return n},supportsEvent:function(n){for(var t in this._eventHandlers)if(n==t)return!0;for(t in this._objectEventHandlers)if(n==t)return!0;return!1},hasEventHandler:function(n,t){var i=this._eventHandlers[n],r;if(i&&i.length>0)for(r=0;r<i.length;r++)if(i[r]===t)return!0;return!1},hasObjectEventHandler:function(n,t,i){var f=this._objectEventHandlers[n],r,u;if(f!=null)for(r=f[t],u=0;r!=null&&u<r.length;u++)if(r[u]===i)return!0;return!1},addEventHandler:function(n,t){if(typeof t!="function")return!1;var i=this._eventHandlers[n];return i&&!this.hasEventHandler(n,t)?(i.push(t),!0):!1},addObjectEventHandler:function(n,t,i){if(typeof i!="function")return!1;var r=this._objectEventHandlers[n];return r&&!this.hasObjectEventHandler(n,t,i)?(r[t]==null&&(r[t]=[]),r[t].push(i),!0):!1},addEventHandlerAndFireQueuedEvent:function(n,t){var r=this._eventHandlers[n],u=r.length==0,i=this.addEventHandler(n,t);return u&&i&&this.fireQueuedEvent(n),i},removeEventHandler:function(n,t){var i=this._eventHandlers[n],r;if(i&&i.length>0)for(r=0;r<i.length;r++)if(i[r]===t)return i.splice(r,1),!0;return!1},removeObjectEventHandler:function(n,t,i){var f=this._objectEventHandlers[n],r,u;if(f!=null)for(r=f[t],u=0;r!=null&&u<r.length;u++)if(r[u]===i)return r.splice(u,1),!0;return!1},clearEventHandlers:function(n){return typeof this._eventHandlers[n]!="undefined"&&this._eventHandlers[n].length>0?(this._eventHandlers[n]=[],!0):!1},clearObjectEventHandlers:function(n,t){return this._objectEventHandlers[n]!=null&&this._objectEventHandlers[n][t]!=null?(this._objectEventHandlers[n][t]=[],!0):!1},getEventHandlerCount:function(n){return this._eventHandlers[n]!=undefined?this._eventHandlers[n].length:-1},getObjectEventHandlerCount:function(n,t){return this._objectEventHandlers[n]==null||this._objectEventHandlers[n][t]==null?0:this._objectEventHandlers[n][t].length},fireEvent:function(n){var t,r,i;if(n.type==undefined)return!1;if(t=n.type,t&&this._eventHandlers[t]){for(r=this._eventHandlers[t],i=0;i<r.length;i++)r[i](n);return!0}else return!1},fireObjectEvent:function(n,t){var i,f,r,u;if(t.type==undefined)return!1;if(i=t.type,i&&this._objectEventHandlers[i]&&(f=this._objectEventHandlers[i],r=f[n],r!=null)){for(u=0;u<r.length;u++)r[u](t);return!0}return!1},fireOrQueueEvent:function(n){var t=n.type,i,r;return t&&this._eventHandlers[t]?(i=this._eventHandlers[t],r=this._queuedEventsArgs[t],i.length==0?r.push(n):this.fireEvent(n),!0):!1},fireQueuedEvent:function(n){var t,i,r,u;if(n&&this._eventHandlers[n]&&(t=this._eventHandlers[n],i=this._queuedEventsArgs[n],t.length>0)){for(r=t[0];i.length>0;)u=i.shift(),r(u);return!0}return!1},clearQueuedEvent:function(n){if(n&&this._eventHandlers[n]){var t=this._queuedEventsArgs[n];t&&(this._queuedEventsArgs[n]=[])}}};OSF.DDA.OMFactory=OSF.DDA.OMFactory||{};OSF.DDA.OMFactory.manufactureEventArgs=function(n,t,i){var r;switch(n){case Microsoft.Office.WebExtension.EventType.DocumentSelectionChanged:r=new OSF.DDA.DocumentSelectionChangedEventArgs(t);break;case Microsoft.Office.WebExtension.EventType.BindingSelectionChanged:r=new OSF.DDA.BindingSelectionChangedEventArgs(this.manufactureBinding(i,t.document),i[OSF.DDA.PropertyDescriptors.Subset]);break;case Microsoft.Office.WebExtension.EventType.BindingDataChanged:r=new OSF.DDA.BindingDataChangedEventArgs(this.manufactureBinding(i,t.document));break;case Microsoft.Office.WebExtension.EventType.SettingsChanged:r=new OSF.DDA.SettingsChangedEventArgs(t);break;case Microsoft.Office.WebExtension.EventType.ActiveViewChanged:r=new OSF.DDA.ActiveViewChangedEventArgs(i);break;case Microsoft.Office.WebExtension.EventType.OfficeThemeChanged:r=new OSF.DDA.Theming.OfficeThemeChangedEventArgs(i);break;case Microsoft.Office.WebExtension.EventType.DocumentThemeChanged:r=new OSF.DDA.Theming.DocumentThemeChangedEventArgs(i);break;case Microsoft.Office.WebExtension.EventType.AppCommandInvoked:r=OSF.DDA.AppCommand.AppCommandInvokedEventArgs.create(i);break;case Microsoft.Office.WebExtension.EventType.ObjectDeleted:case Microsoft.Office.WebExtension.EventType.ObjectSelectionChanged:case Microsoft.Office.WebExtension.EventType.ObjectDataChanged:case Microsoft.Office.WebExtension.EventType.ContentControlAdded:r=new OSF.DDA.ObjectEventArgs(n,i[Microsoft.Office.WebExtension.Parameters.Id]);break;case Microsoft.Office.WebExtension.EventType.RichApiMessage:r=new OSF.DDA.RichApiMessageEventArgs(n,i);break;case Microsoft.Office.WebExtension.EventType.DataNodeInserted:r=new OSF.DDA.NodeInsertedEventArgs(this.manufactureDataNode(i[OSF.DDA.DataNodeEventProperties.NewNode]),i[OSF.DDA.DataNodeEventProperties.InUndoRedo]);break;case Microsoft.Office.WebExtension.EventType.DataNodeReplaced:r=new OSF.DDA.NodeReplacedEventArgs(this.manufactureDataNode(i[OSF.DDA.DataNodeEventProperties.OldNode]),this.manufactureDataNode(i[OSF.DDA.DataNodeEventProperties.NewNode]),i[OSF.DDA.DataNodeEventProperties.InUndoRedo]);break;case Microsoft.Office.WebExtension.EventType.DataNodeDeleted:r=new OSF.DDA.NodeDeletedEventArgs(this.manufactureDataNode(i[OSF.DDA.DataNodeEventProperties.OldNode]),this.manufactureDataNode(i[OSF.DDA.DataNodeEventProperties.NextSiblingNode]),i[OSF.DDA.DataNodeEventProperties.InUndoRedo]);break;case Microsoft.Office.WebExtension.EventType.TaskSelectionChanged:r=new OSF.DDA.TaskSelectionChangedEventArgs(t);break;case Microsoft.Office.WebExtension.EventType.ResourceSelectionChanged:r=new OSF.DDA.ResourceSelectionChangedEventArgs(t);break;case Microsoft.Office.WebExtension.EventType.ViewSelectionChanged:r=new OSF.DDA.ViewSelectionChangedEventArgs(t);break;case Microsoft.Office.WebExtension.EventType.DialogMessageReceived:r=new OSF.DDA.DialogEventArgs(i);break;case Microsoft.Office.WebExtension.EventType.DialogParentMessageReceived:r=new OSF.DDA.DialogParentEventArgs(i);break;case Microsoft.Office.WebExtension.EventType.ItemChanged:if(OSF._OfficeAppFactory.getHostInfo().hostType=="outlook")r=new OSF.DDA.OlkItemSelectedChangedEventArgs(i),t.initialize(r.initialData),(OSF._OfficeAppFactory.getHostInfo().hostPlatform=="win32"||OSF._OfficeAppFactory.getHostInfo().hostPlatform=="mac")&&t.setCurrentItemNumber(r.itemNumber.itemNumber);else throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,n));break;case Microsoft.Office.WebExtension.EventType.RecipientsChanged:if(OSF._OfficeAppFactory.getHostInfo().hostType=="outlook")r=new OSF.DDA.OlkRecipientsChangedEventArgs(i);else throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,n));break;case Microsoft.Office.WebExtension.EventType.AppointmentTimeChanged:if(OSF._OfficeAppFactory.getHostInfo().hostType=="outlook")r=new OSF.DDA.OlkAppointmentTimeChangedEventArgs(i);else throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,n));break;case Microsoft.Office.WebExtension.EventType.RecurrenceChanged:if(OSF._OfficeAppFactory.getHostInfo().hostType=="outlook")r=new OSF.DDA.OlkRecurrenceChangedEventArgs(i);else throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,n));break;case Microsoft.Office.WebExtension.EventType.AttachmentsChanged:if(OSF._OfficeAppFactory.getHostInfo().hostType=="outlook")r=new OSF.DDA.OlkAttachmentsChangedEventArgs(i);else throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,n));break;case Microsoft.Office.WebExtension.EventType.EnhancedLocationsChanged:if(OSF._OfficeAppFactory.getHostInfo().hostType=="outlook")r=new OSF.DDA.OlkEnhancedLocationsChangedEventArgs(i);else throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,n));break;case Microsoft.Office.WebExtension.EventType.InfobarClicked:if(OSF._OfficeAppFactory.getHostInfo().hostType=="outlook")r=new OSF.DDA.OlkInfobarClickedEventArgs(i);else throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,n));break;default:throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,n));}return r};OSF.DDA.AsyncMethodNames.addNames({AddHandlerAsync:"addHandlerAsync",RemoveHandlerAsync:"removeHandlerAsync"});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.AddHandlerAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.EventType,"enum":Microsoft.Office.WebExtension.EventType,verify:function(n,t,i){return i.supportsEvent(n)}},{name:Microsoft.Office.WebExtension.Parameters.Handler,types:["function"]}],supportedOptions:[],privateStateCallbacks:[]});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.RemoveHandlerAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.EventType,"enum":Microsoft.Office.WebExtension.EventType,verify:function(n,t,i){return i.supportsEvent(n)}}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.Handler,value:{types:["function","object"],defaultValue:null}}],privateStateCallbacks:[]});OSF.DialogShownStatus={hasDialogShown:!1,isWindowDialog:!1};OSF.OUtil.augmentList(OSF.DDA.EventDescriptors,{DialogMessageReceivedEvent:"DialogMessageReceivedEvent"});OSF.OUtil.augmentList(Microsoft.Office.WebExtension.EventType,{DialogMessageReceived:"dialogMessageReceived",DialogEventReceived:"dialogEventReceived"});OSF.OUtil.augmentList(OSF.DDA.PropertyDescriptors,{MessageType:"messageType",MessageContent:"messageContent"});OSF.DDA.DialogEventType={};OSF.OUtil.augmentList(OSF.DDA.DialogEventType,{DialogClosed:"dialogClosed",NavigationFailed:"naviationFailed"});OSF.DDA.AsyncMethodNames.addNames({DisplayDialogAsync:"displayDialogAsync",CloseAsync:"close"});OSF.DDA.SyncMethodNames.addNames({MessageParent:"messageParent",AddMessageHandler:"addEventHandler",SendMessage:"sendMessage"});OSF.DDA.UI.ParentUI=function(){var i,t,n;i=Microsoft.Office.WebExtension.EventType.DialogParentMessageReceived!=null?new OSF.EventDispatch([Microsoft.Office.WebExtension.EventType.DialogMessageReceived,Microsoft.Office.WebExtension.EventType.DialogEventReceived,Microsoft.Office.WebExtension.EventType.DialogParentMessageReceived]):new OSF.EventDispatch([Microsoft.Office.WebExtension.EventType.DialogMessageReceived,Microsoft.Office.WebExtension.EventType.DialogEventReceived]);t=OSF.DDA.AsyncMethodNames.DisplayDialogAsync.displayName;n=this;n[t]||OSF.OUtil.defineEnumerableProperty(n,t,{value:function(){var t=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.OpenDialog];t(arguments,i,n)}});OSF.OUtil.finalizeProperties(this)};OSF.DDA.UI.ChildUI=function(n){var i=OSF.DDA.SyncMethodNames.MessageParent.displayName,t=this,r;t[i]||OSF.OUtil.defineEnumerableProperty(t,i,{value:function(){var n=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.MessageParent];return n(arguments,t)}});r=OSF.DDA.SyncMethodNames.AddMessageHandler.displayName;t[r]||typeof OSF.DialogParentMessageEventDispatch=="undefined"||OSF.DDA.DispIdHost.addEventSupport(t,OSF.DialogParentMessageEventDispatch,n);OSF.OUtil.finalizeProperties(this)};OSF.DialogHandler=function(){};OSF.DDA.DialogEventArgs=function(n){n[OSF.DDA.PropertyDescriptors.MessageType]==OSF.DialogMessageType.DialogMessageReceived?OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.DialogMessageReceived},message:{value:n[OSF.DDA.PropertyDescriptors.MessageContent]}}):OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.DialogEventReceived},error:{value:n[OSF.DDA.PropertyDescriptors.MessageType]}})};OSF.DDA.DialogParentEventArgs=function(n){OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.DialogParentMessageReceived},message:{value:n[OSF.DDA.PropertyDescriptors.MessageContent]}})};OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.DisplayDialogAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Url,types:["string"]}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.Width,value:{types:["number"],defaultValue:99}},{name:Microsoft.Office.WebExtension.Parameters.Height,value:{types:["number"],defaultValue:99}},{name:Microsoft.Office.WebExtension.Parameters.RequireHTTPs,value:{types:["boolean"],defaultValue:!0}},{name:Microsoft.Office.WebExtension.Parameters.DisplayInIframe,value:{types:["boolean"],defaultValue:!1}},{name:Microsoft.Office.WebExtension.Parameters.HideTitle,value:{types:["boolean"],defaultValue:!1}},{name:Microsoft.Office.WebExtension.Parameters.UseDeviceIndependentPixels,value:{types:["boolean"],defaultValue:!1}},{name:Microsoft.Office.WebExtension.Parameters.PromptBeforeOpen,value:{types:["boolean"],defaultValue:!0}},{name:Microsoft.Office.WebExtension.Parameters.EnforceAppDomain,value:{types:["boolean"],defaultValue:!1}}],privateStateCallbacks:[],onSucceeded:function(n,t,i){var o=n[Microsoft.Office.WebExtension.Parameters.Id],u=n[Microsoft.Office.WebExtension.Parameters.Data],r=new OSF.DialogHandler,s=OSF.DDA.AsyncMethodNames.CloseAsync.displayName,f,e;return OSF.OUtil.defineEnumerableProperty(r,s,{value:function(){var n=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.CloseDialog];n(arguments,o,u,r)}}),f=OSF.DDA.SyncMethodNames.AddMessageHandler.displayName,OSF.OUtil.defineEnumerableProperty(r,f,{value:function(){var t=OSF.DDA.SyncMethodCalls[OSF.DDA.SyncMethodNames.AddMessageHandler.id],n=t.verifyAndExtractCall(arguments,r,u),i=n[Microsoft.Office.WebExtension.Parameters.EventType],f=n[Microsoft.Office.WebExtension.Parameters.Handler];return u.addEventHandlerAndFireQueuedEvent(i,f)}}),e=OSF.DDA.SyncMethodNames.SendMessage.displayName,OSF.OUtil.defineEnumerableProperty(r,e,{value:function(){var n=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.SendMessage];return n(arguments,u,r)}}),r},checkCallArgs:function(n,t,i){return n[Microsoft.Office.WebExtension.Parameters.Width]<=0&&(n[Microsoft.Office.WebExtension.Parameters.Width]=1),!n[Microsoft.Office.WebExtension.Parameters.UseDeviceIndependentPixels]&&n[Microsoft.Office.WebExtension.Parameters.Width]>100&&(n[Microsoft.Office.WebExtension.Parameters.Width]=99),n[Microsoft.Office.WebExtension.Parameters.Height]<=0&&(n[Microsoft.Office.WebExtension.Parameters.Height]=1),!n[Microsoft.Office.WebExtension.Parameters.UseDeviceIndependentPixels]&&n[Microsoft.Office.WebExtension.Parameters.Height]>100&&(n[Microsoft.Office.WebExtension.Parameters.Height]=99),n[Microsoft.Office.WebExtension.Parameters.RequireHTTPs]||(n[Microsoft.Office.WebExtension.Parameters.RequireHTTPs]=!0),n}});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.CloseAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[]});OSF.DDA.SyncMethodCalls.define({method:OSF.DDA.SyncMethodNames.MessageParent,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.MessageToParent,types:["string","number","boolean"]}],supportedOptions:[]});OSF.DDA.SyncMethodCalls.define({method:OSF.DDA.SyncMethodNames.AddMessageHandler,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.EventType,"enum":Microsoft.Office.WebExtension.EventType,verify:function(n,t,i){return i.supportsEvent(n)}},{name:Microsoft.Office.WebExtension.Parameters.Handler,types:["function"]}],supportedOptions:[]});OSF.DDA.SyncMethodCalls.define({method:OSF.DDA.SyncMethodNames.SendMessage,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.MessageContent,types:["string"]}],supportedOptions:[],privateStateCallbacks:[]});OSF.DDA.SafeArray.Delegate.openDialog=function(n){try{n.onCalling&&n.onCalling();var t=OSF.DDA.SafeArray.Delegate._getOnAfterRegisterEvent(!0,n);OSF.ClientHostController.openDialog(n.dispId,n.targetId,function(t,i){if(n.onEvent)n.onEvent(i);if(OSF.AppTelemetry)OSF.AppTelemetry.onEventDone(n.dispId)},t)}catch(i){OSF.DDA.SafeArray.Delegate._onException(i,n)}};OSF.DDA.SafeArray.Delegate.closeDialog=function(n){n.onCalling&&n.onCalling();var t=OSF.DDA.SafeArray.Delegate._getOnAfterRegisterEvent(!1,n);try{OSF.ClientHostController.closeDialog(n.dispId,n.targetId,t)}catch(i){OSF.DDA.SafeArray.Delegate._onException(i,n)}};OSF.DDA.SafeArray.Delegate.messageParent=function(n){try{n.onCalling&&n.onCalling();var i=(new Date).getTime(),t=OSF.ClientHostController.messageParent(n.hostCallArgs);if(n.onReceiving&&n.onReceiving(),OSF.AppTelemetry)OSF.AppTelemetry.onMethodDone(n.dispId,n.hostCallArgs,Math.abs((new Date).getTime()-i),t);return t}catch(r){return OSF.DDA.SafeArray.Delegate._onExceptionSyncMethod(r)}};OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,fromHost:[{name:OSF.DDA.EventDescriptors.DialogMessageReceivedEvent,value:OSF.DDA.SafeArray.Delegate.ParameterMap.self}],isComplexType:!0});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.EventDescriptors.DialogMessageReceivedEvent,fromHost:[{name:OSF.DDA.PropertyDescriptors.MessageType,value:0},{name:OSF.DDA.PropertyDescriptors.MessageContent,value:1}],isComplexType:!0});OSF.DDA.SafeArray.Delegate.sendMessage=function(n){try{n.onCalling&&n.onCalling();var r=(new Date).getTime(),t=OSF.ClientHostController.sendMessage(n.hostCallArgs);return n.onReceiving&&n.onReceiving(),t}catch(i){return OSF.DDA.SafeArray.Delegate._onExceptionSyncMethod(i)}};OSF.DDA.AsyncMethodNames.addNames({GetSelectedDataAsync:"getSelectedDataAsync",SetSelectedDataAsync:"setSelectedDataAsync"}),function(){function n(n,t,i){var r=n[Microsoft.Office.WebExtension.Parameters.Data];return OSF.DDA.TableDataProperties&&r&&(r[OSF.DDA.TableDataProperties.TableRows]!=undefined||r[OSF.DDA.TableDataProperties.TableHeaders]!=undefined)&&(r=OSF.DDA.OMFactory.manufactureTableData(r)),r=OSF.DDA.DataCoercion.coerceData(r,i[Microsoft.Office.WebExtension.Parameters.CoercionType]),r==undefined?null:r}OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.GetSelectedDataAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.CoercionType,"enum":Microsoft.Office.WebExtension.CoercionType}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.ValueFormat,value:{"enum":Microsoft.Office.WebExtension.ValueFormat,defaultValue:Microsoft.Office.WebExtension.ValueFormat.Unformatted}},{name:Microsoft.Office.WebExtension.Parameters.FilterType,value:{"enum":Microsoft.Office.WebExtension.FilterType,defaultValue:Microsoft.Office.WebExtension.FilterType.All}}],privateStateCallbacks:[],onSucceeded:n});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.SetSelectedDataAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Data,types:["string","object","number","boolean"]}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.CoercionType,value:{"enum":Microsoft.Office.WebExtension.CoercionType,calculate:function(n){return OSF.DDA.DataCoercion.determineCoercionType(n[Microsoft.Office.WebExtension.Parameters.Data])}}},{name:Microsoft.Office.WebExtension.Parameters.ImageLeft,value:{types:["number","boolean"],defaultValue:!1}},{name:Microsoft.Office.WebExtension.Parameters.ImageTop,value:{types:["number","boolean"],defaultValue:!1}},{name:Microsoft.Office.WebExtension.Parameters.ImageWidth,value:{types:["number","boolean"],defaultValue:!1}},{name:Microsoft.Office.WebExtension.Parameters.ImageHeight,value:{types:["number","boolean"],defaultValue:!1}}],privateStateCallbacks:[]})}();OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,fromHost:[{name:Microsoft.Office.WebExtension.Parameters.Data,value:OSF.DDA.SafeArray.Delegate.ParameterMap.self}],toHost:[{name:Microsoft.Office.WebExtension.Parameters.CoercionType,value:0},{name:Microsoft.Office.WebExtension.Parameters.ValueFormat,value:1},{name:Microsoft.Office.WebExtension.Parameters.FilterType,value:2}]});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,toHost:[{name:Microsoft.Office.WebExtension.Parameters.CoercionType,value:0},{name:Microsoft.Office.WebExtension.Parameters.Data,value:1},{name:Microsoft.Office.WebExtension.Parameters.ImageLeft,value:2},{name:Microsoft.Office.WebExtension.Parameters.ImageTop,value:3},{name:Microsoft.Office.WebExtension.Parameters.ImageWidth,value:4},{name:Microsoft.Office.WebExtension.Parameters.ImageHeight,value:5},]});OSF.DDA.SettingsManager={SerializedSettings:"serializedSettings",RefreshingSettings:"refreshingSettings",DateJSONPrefix:"Date(",DataJSONSuffix:")",serializeSettings:function(n){return OSF.OUtil.serializeSettings(n)},deserializeSettings:function(n){return OSF.OUtil.deserializeSettings(n)}};OSF.DDA.Settings=function(n){n=n||{};var t=function(n){var i=OSF.OUtil.getSessionStorage(),t,r;i&&(t=OSF.DDA.SettingsManager.serializeSettings(n),r=JSON?JSON.stringify(t):Sys.Serialization.JavaScriptSerializer.serialize(t),i.setItem(OSF._OfficeAppFactory.getCachedSessionSettingsKey(),r))};OSF.OUtil.defineEnumerableProperties(this,{get:{value:function(t){var r=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]),i;if(r)throw r;return i=n[t],typeof i=="undefined"?null:i}},set:{value:function(i,r){var u=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"value",mayBeNull:!0}]);if(u)throw u;n[i]=r;t(n)}},remove:{value:function(i){var r=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(r)throw r;delete n[i];t(n)}}});OSF.DDA.DispIdHost.addAsyncMethods(this,[OSF.DDA.AsyncMethodNames.SaveAsync],n)};OSF.DDA.RefreshableSettings=function(n){OSF.DDA.RefreshableSettings.uber.constructor.call(this,n);OSF.DDA.DispIdHost.addAsyncMethods(this,[OSF.DDA.AsyncMethodNames.RefreshAsync],n);OSF.DDA.DispIdHost.addEventSupport(this,new OSF.EventDispatch([Microsoft.Office.WebExtension.EventType.SettingsChanged]))};OSF.OUtil.extend(OSF.DDA.RefreshableSettings,OSF.DDA.Settings);OSF.OUtil.augmentList(Microsoft.Office.WebExtension.EventType,{SettingsChanged:"settingsChanged"});OSF.DDA.SettingsChangedEventArgs=function(n){OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.SettingsChanged},settings:{value:n}})};OSF.DDA.AsyncMethodNames.addNames({RefreshAsync:"refreshAsync",SaveAsync:"saveAsync"});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.RefreshAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[{name:OSF.DDA.SettingsManager.RefreshingSettings,value:function(n,t){return t}}],onSucceeded:function(n,t,i){var f=n[OSF.DDA.SettingsManager.SerializedSettings],u=OSF.DDA.SettingsManager.deserializeSettings(f),e=i[OSF.DDA.SettingsManager.RefreshingSettings];for(var r in e)t.remove(r);for(r in u)t.set(r,u[r]);return t}});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.SaveAsync,requiredArguments:[],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.OverwriteIfStale,value:{types:["boolean"],defaultValue:!0}}],privateStateCallbacks:[{name:OSF.DDA.SettingsManager.SerializedSettings,value:function(n,t){return OSF.DDA.SettingsManager.serializeSettings(t)}}]});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidLoadSettingsMethod,fromHost:[{name:OSF.DDA.SettingsManager.SerializedSettings,value:OSF.DDA.SafeArray.Delegate.ParameterMap.self}]});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidSaveSettingsMethod,toHost:[{name:OSF.DDA.SettingsManager.SerializedSettings,value:OSF.DDA.SettingsManager.SerializedSettings},{name:Microsoft.Office.WebExtension.Parameters.OverwriteIfStale,value:Microsoft.Office.WebExtension.Parameters.OverwriteIfStale}]});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.EventDispId.dispidSettingsChangedEvent});Microsoft.Office.WebExtension.BindingType={Table:"table",Text:"text",Matrix:"matrix"};OSF.DDA.BindingProperties={Id:"BindingId",Type:Microsoft.Office.WebExtension.Parameters.BindingType};OSF.OUtil.augmentList(OSF.DDA.ListDescriptors,{BindingList:"BindingList"});OSF.OUtil.augmentList(OSF.DDA.PropertyDescriptors,{Subset:"subset",BindingProperties:"BindingProperties"});OSF.DDA.ListType.setListType(OSF.DDA.ListDescriptors.BindingList,OSF.DDA.PropertyDescriptors.BindingProperties);OSF.DDA.BindingPromise=function(n,t){this._id=n;OSF.OUtil.defineEnumerableProperty(this,"onFail",{get:function(){return t},set:function(n){var i=typeof n;if(i!="undefined"&&i!="function")throw OSF.OUtil.formatString(Strings.OfficeOM.L_CallbackNotAFunction,i);t=n}})};OSF.DDA.BindingPromise.prototype={_fetch:function(n){if(this.binding)n&&n(this.binding);else if(!this._binding){var t=this;Microsoft.Office.WebExtension.context.document.bindings.getByIdAsync(this._id,function(i){if(i.status==Microsoft.Office.WebExtension.AsyncResultStatus.Succeeded)OSF.OUtil.defineEnumerableProperty(t,"binding",{value:i.value}),n&&n(t.binding);else if(t.onFail)t.onFail(i)})}return this},getDataAsync:function(){var n=arguments;return this._fetch(function(t){t.getDataAsync.apply(t,n)}),this},setDataAsync:function(){var n=arguments;return this._fetch(function(t){t.setDataAsync.apply(t,n)}),this},addHandlerAsync:function(){var n=arguments;return this._fetch(function(t){t.addHandlerAsync.apply(t,n)}),this},removeHandlerAsync:function(){var n=arguments;return this._fetch(function(t){t.removeHandlerAsync.apply(t,n)}),this}};OSF.DDA.BindingFacade=function(n){this._eventDispatches=[];OSF.OUtil.defineEnumerableProperty(this,"document",{value:n});var t=OSF.DDA.AsyncMethodNames;OSF.DDA.DispIdHost.addAsyncMethods(this,[t.AddFromSelectionAsync,t.AddFromNamedItemAsync,t.GetAllAsync,t.GetByIdAsync,t.ReleaseByIdAsync])};OSF.DDA.UnknownBinding=function(n,t){OSF.OUtil.defineEnumerableProperties(this,{document:{value:t},id:{value:n}})};OSF.DDA.Binding=function(n,t){var r,u,i,f;OSF.OUtil.defineEnumerableProperties(this,{document:{value:t},id:{value:n}});r=OSF.DDA.AsyncMethodNames;OSF.DDA.DispIdHost.addAsyncMethods(this,[r.GetDataAsync,r.SetDataAsync]);u=Microsoft.Office.WebExtension.EventType;i=t.bindings._eventDispatches;i[n]||(i[n]=new OSF.EventDispatch([u.BindingSelectionChanged,u.BindingDataChanged]));f=i[n];OSF.DDA.DispIdHost.addEventSupport(this,f)};OSF.DDA.generateBindingId=function(){return"UnnamedBinding_"+OSF.OUtil.getUniqueId()+"_"+(new Date).getTime()};OSF.DDA.OMFactory=OSF.DDA.OMFactory||{};OSF.DDA.OMFactory.manufactureBinding=function(n,t){var r=n[OSF.DDA.BindingProperties.Id],u=n[OSF.DDA.BindingProperties.RowCount],f=n[OSF.DDA.BindingProperties.ColumnCount],s=n[OSF.DDA.BindingProperties.HasHeaders],i,e,o;switch(n[OSF.DDA.BindingProperties.Type]){case Microsoft.Office.WebExtension.BindingType.Text:i=new OSF.DDA.TextBinding(r,t);break;case Microsoft.Office.WebExtension.BindingType.Matrix:i=new OSF.DDA.MatrixBinding(r,t,u,f);break;case Microsoft.Office.WebExtension.BindingType.Table:e=function(){return OSF.DDA.ExcelDocument&&Microsoft.Office.WebExtension.context.document&&Microsoft.Office.WebExtension.context.document instanceof OSF.DDA.ExcelDocument};o=e()&&OSF.DDA.ExcelTableBinding?OSF.DDA.ExcelTableBinding:OSF.DDA.TableBinding;i=new o(r,t,u,f,s);break;default:i=new OSF.DDA.UnknownBinding(r,t)}return i};OSF.DDA.AsyncMethodNames.addNames({AddFromSelectionAsync:"addFromSelectionAsync",AddFromNamedItemAsync:"addFromNamedItemAsync",GetAllAsync:"getAllAsync",GetByIdAsync:"getByIdAsync",ReleaseByIdAsync:"releaseByIdAsync",GetDataAsync:"getDataAsync",SetDataAsync:"setDataAsync"}),function(){function n(n){return OSF.DDA.OMFactory.manufactureBinding(n,Microsoft.Office.WebExtension.context.document)}function t(n){return n.id}function i(n,t,i){var r=n[Microsoft.Office.WebExtension.Parameters.Data];return OSF.DDA.TableDataProperties&&r&&(r[OSF.DDA.TableDataProperties.TableRows]!=undefined||r[OSF.DDA.TableDataProperties.TableHeaders]!=undefined)&&(r=OSF.DDA.OMFactory.manufactureTableData(r)),r=OSF.DDA.DataCoercion.coerceData(r,i[Microsoft.Office.WebExtension.Parameters.CoercionType]),r==undefined?null:r}OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.AddFromSelectionAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.BindingType,"enum":Microsoft.Office.WebExtension.BindingType}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:{types:["string"],calculate:OSF.DDA.generateBindingId}},{name:Microsoft.Office.WebExtension.Parameters.Columns,value:{types:["object"],defaultValue:null}}],privateStateCallbacks:[],onSucceeded:n});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.AddFromNamedItemAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.ItemName,types:["string"]},{name:Microsoft.Office.WebExtension.Parameters.BindingType,"enum":Microsoft.Office.WebExtension.BindingType}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:{types:["string"],calculate:OSF.DDA.generateBindingId}},{name:Microsoft.Office.WebExtension.Parameters.Columns,value:{types:["object"],defaultValue:null}}],privateStateCallbacks:[{name:Microsoft.Office.WebExtension.Parameters.FailOnCollision,value:function(){return!0}}],onSucceeded:n});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.GetAllAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[],onSucceeded:function(t){return OSF.OUtil.mapList(t[OSF.DDA.ListDescriptors.BindingList],n)}});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.GetByIdAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Id,types:["string"]}],supportedOptions:[],privateStateCallbacks:[],onSucceeded:n});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.ReleaseByIdAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Id,types:["string"]}],supportedOptions:[],privateStateCallbacks:[],onSucceeded:function(n,t,i){var r=i[Microsoft.Office.WebExtension.Parameters.Id];delete t._eventDispatches[r]}});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.GetDataAsync,requiredArguments:[],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.CoercionType,value:{"enum":Microsoft.Office.WebExtension.CoercionType,calculate:function(n,t){return OSF.DDA.DataCoercion.getCoercionDefaultForBinding(t.type)}}},{name:Microsoft.Office.WebExtension.Parameters.ValueFormat,value:{"enum":Microsoft.Office.WebExtension.ValueFormat,defaultValue:Microsoft.Office.WebExtension.ValueFormat.Unformatted}},{name:Microsoft.Office.WebExtension.Parameters.FilterType,value:{"enum":Microsoft.Office.WebExtension.FilterType,defaultValue:Microsoft.Office.WebExtension.FilterType.All}},{name:Microsoft.Office.WebExtension.Parameters.Rows,value:{types:["object","string"],defaultValue:null}},{name:Microsoft.Office.WebExtension.Parameters.Columns,value:{types:["object"],defaultValue:null}},{name:Microsoft.Office.WebExtension.Parameters.StartRow,value:{types:["number"],defaultValue:0}},{name:Microsoft.Office.WebExtension.Parameters.StartColumn,value:{types:["number"],defaultValue:0}},{name:Microsoft.Office.WebExtension.Parameters.RowCount,value:{types:["number"],defaultValue:0}},{name:Microsoft.Office.WebExtension.Parameters.ColumnCount,value:{types:["number"],defaultValue:0}}],checkCallArgs:function(n,t,i){if(n[Microsoft.Office.WebExtension.Parameters.StartRow]==0&&n[Microsoft.Office.WebExtension.Parameters.StartColumn]==0&&n[Microsoft.Office.WebExtension.Parameters.RowCount]==0&&n[Microsoft.Office.WebExtension.Parameters.ColumnCount]==0&&(delete n[Microsoft.Office.WebExtension.Parameters.StartRow],delete n[Microsoft.Office.WebExtension.Parameters.StartColumn],delete n[Microsoft.Office.WebExtension.Parameters.RowCount],delete n[Microsoft.Office.WebExtension.Parameters.ColumnCount]),n[Microsoft.Office.WebExtension.Parameters.CoercionType]!=OSF.DDA.DataCoercion.getCoercionDefaultForBinding(t.type)&&(n[Microsoft.Office.WebExtension.Parameters.StartRow]||n[Microsoft.Office.WebExtension.Parameters.StartColumn]||n[Microsoft.Office.WebExtension.Parameters.RowCount]||n[Microsoft.Office.WebExtension.Parameters.ColumnCount]))throw OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding;return n},privateStateCallbacks:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:t}],onSucceeded:i});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.SetDataAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Data,types:["string","object","number","boolean"]}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.CoercionType,value:{"enum":Microsoft.Office.WebExtension.CoercionType,calculate:function(n){return OSF.DDA.DataCoercion.determineCoercionType(n[Microsoft.Office.WebExtension.Parameters.Data])}}},{name:Microsoft.Office.WebExtension.Parameters.Rows,value:{types:["object","string"],defaultValue:null}},{name:Microsoft.Office.WebExtension.Parameters.Columns,value:{types:["object"],defaultValue:null}},{name:Microsoft.Office.WebExtension.Parameters.StartRow,value:{types:["number"],defaultValue:0}},{name:Microsoft.Office.WebExtension.Parameters.StartColumn,value:{types:["number"],defaultValue:0}}],checkCallArgs:function(n,t,i){if(n[Microsoft.Office.WebExtension.Parameters.StartRow]==0&&n[Microsoft.Office.WebExtension.Parameters.StartColumn]==0&&(delete n[Microsoft.Office.WebExtension.Parameters.StartRow],delete n[Microsoft.Office.WebExtension.Parameters.StartColumn]),n[Microsoft.Office.WebExtension.Parameters.CoercionType]!=OSF.DDA.DataCoercion.getCoercionDefaultForBinding(t.type)&&(n[Microsoft.Office.WebExtension.Parameters.StartRow]||n[Microsoft.Office.WebExtension.Parameters.StartColumn]))throw OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding;return n},privateStateCallbacks:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:t}]})}();OSF.OUtil.augmentList(OSF.DDA.BindingProperties,{RowCount:"BindingRowCount",ColumnCount:"BindingColumnCount",HasHeaders:"HasHeaders"});OSF.DDA.MatrixBinding=function(n,t,i,r){OSF.DDA.MatrixBinding.uber.constructor.call(this,n,t);OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.BindingType.Matrix},rowCount:{value:i?i:0},columnCount:{value:r?r:0}})};OSF.OUtil.extend(OSF.DDA.MatrixBinding,OSF.DDA.Binding);OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.PropertyDescriptors.BindingProperties,fromHost:[{name:OSF.DDA.BindingProperties.Id,value:0},{name:OSF.DDA.BindingProperties.Type,value:1},{name:OSF.DDA.SafeArray.UniqueArguments.BindingSpecificData,value:2}],isComplexType:!0});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:Microsoft.Office.WebExtension.Parameters.BindingType,toHost:[{name:Microsoft.Office.WebExtension.BindingType.Text,value:0},{name:Microsoft.Office.WebExtension.BindingType.Matrix,value:1},{name:Microsoft.Office.WebExtension.BindingType.Table,value:2}],invertible:!0});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod,fromHost:[{name:OSF.DDA.PropertyDescriptors.BindingProperties,value:OSF.DDA.SafeArray.Delegate.ParameterMap.self}],toHost:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:0},{name:Microsoft.Office.WebExtension.Parameters.BindingType,value:1}]});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod,fromHost:[{name:OSF.DDA.PropertyDescriptors.BindingProperties,value:OSF.DDA.SafeArray.Delegate.ParameterMap.self}],toHost:[{name:Microsoft.Office.WebExtension.Parameters.ItemName,value:0},{name:Microsoft.Office.WebExtension.Parameters.Id,value:1},{name:Microsoft.Office.WebExtension.Parameters.BindingType,value:2},{name:Microsoft.Office.WebExtension.Parameters.FailOnCollision,value:3}]});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidReleaseBindingMethod,toHost:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:0}]});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidGetBindingMethod,fromHost:[{name:OSF.DDA.PropertyDescriptors.BindingProperties,value:OSF.DDA.SafeArray.Delegate.ParameterMap.self}],toHost:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:0}]});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidGetAllBindingsMethod,fromHost:[{name:OSF.DDA.ListDescriptors.BindingList,value:OSF.DDA.SafeArray.Delegate.ParameterMap.self}]});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidGetBindingDataMethod,fromHost:[{name:Microsoft.Office.WebExtension.Parameters.Data,value:OSF.DDA.SafeArray.Delegate.ParameterMap.self}],toHost:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:0},{name:Microsoft.Office.WebExtension.Parameters.CoercionType,value:1},{name:Microsoft.Office.WebExtension.Parameters.ValueFormat,value:2},{name:Microsoft.Office.WebExtension.Parameters.FilterType,value:3},{name:OSF.DDA.PropertyDescriptors.Subset,value:4}]});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidSetBindingDataMethod,toHost:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:0},{name:Microsoft.Office.WebExtension.Parameters.CoercionType,value:1},{name:Microsoft.Office.WebExtension.Parameters.Data,value:2},{name:OSF.DDA.SafeArray.UniqueArguments.Offset,value:3}]});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.SafeArray.UniqueArguments.BindingSpecificData,fromHost:[{name:OSF.DDA.BindingProperties.RowCount,value:0},{name:OSF.DDA.BindingProperties.ColumnCount,value:1},{name:OSF.DDA.BindingProperties.HasHeaders,value:2}],isComplexType:!0});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.PropertyDescriptors.Subset,toHost:[{name:OSF.DDA.SafeArray.UniqueArguments.Offset,value:0},{name:OSF.DDA.SafeArray.UniqueArguments.Run,value:1}],canonical:!0,isComplexType:!0});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.SafeArray.UniqueArguments.Offset,toHost:[{name:Microsoft.Office.WebExtension.Parameters.StartRow,value:0},{name:Microsoft.Office.WebExtension.Parameters.StartColumn,value:1}],canonical:!0,isComplexType:!0});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.SafeArray.UniqueArguments.Run,toHost:[{name:Microsoft.Office.WebExtension.Parameters.RowCount,value:0},{name:Microsoft.Office.WebExtension.Parameters.ColumnCount,value:1}],canonical:!0,isComplexType:!0});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidAddRowsMethod,toHost:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:0},{name:Microsoft.Office.WebExtension.Parameters.Data,value:1}]});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidAddColumnsMethod,toHost:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:0},{name:Microsoft.Office.WebExtension.Parameters.Data,value:1}]});OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidClearAllRowsMethod,toHost:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:0}]});OSF.DDA.AsyncMethodNames.addNames({ExecuteRichApiRequestAsync:"executeRichApiRequestAsync"});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.ExecuteRichApiRequestAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Data,types:["object"]}],supportedOptions:[]});OSF.OUtil.setNamespace("RichApi",OSF.DDA);OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,toHost:[{name:Microsoft.Office.WebExtension.Parameters.Data,value:0}],fromHost:[{name:Microsoft.Office.WebExtension.Parameters.Data,value:OSF.DDA.SafeArray.Delegate.ParameterMap.self}]});OSF.OUtil.augmentList(Microsoft.Office.WebExtension.EventType,{RichApiMessage:"richApiMessage"});OSF.DDA.RichApiMessageEventArgs=function(n,t){var u=t[Microsoft.Office.WebExtension.Parameters.Data],f=[],r,i;if(u)for(r=0;r<u.length;r++)i=u[r],i.toArray&&(i=i.toArray()),f.push({messageCategory:i[0],messageType:i[1],targetId:i[2],message:i[3],id:i[4],isRemoteOverride:i[5]});OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.RichApiMessage},entries:{value:f}})},function(n){var t=function(){function n(){this._eventDispatch=null;this._eventDispatch=new OSF.EventDispatch([Microsoft.Office.WebExtension.EventType.RichApiMessage,]);OSF.DDA.DispIdHost.addEventSupport(this,this._eventDispatch)}return n}();n.RichApiMessageManager=t}(OfficeExt||(OfficeExt={}));OSF.DDA.SafeArray.Delegate.ParameterMap.define({type:OSF.DDA.EventDispId.dispidRichApiMessageEvent,toHost:[{name:Microsoft.Office.WebExtension.Parameters.Data,value:0}],fromHost:[{name:Microsoft.Office.WebExtension.Parameters.Data,value:OSF.DDA.SafeArray.Delegate.ParameterMap.sourceData}]}),function(n){var t;(function(t){var u=function(){function r(){var n=this;this._pseudoDocument=null;this._eventDispatch=null;this._processAppCommandInvocation=function(t){var i=n._verifyManifestCallback(t.callbackName),r;if(i.errorCode!=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){n._invokeAppCommandCompletedMethod(t.appCommandId,i.errorCode,"");return}r=n._constructEventObjectForCallback(t);r?window.setTimeout(function(){i.callback(r)},0):n._invokeAppCommandCompletedMethod(t.appCommandId,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,"")}}return r.initializeOsfDda=function(){OSF.DDA.AsyncMethodNames.addNames({AppCommandInvocationCompletedAsync:"appCommandInvocationCompletedAsync"});OSF.DDA.AsyncMethodCalls.define({method:OSF.DDA.AsyncMethodNames.AppCommandInvocationCompletedAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Id,types:["string"]},{name:Microsoft.Office.WebExtension.Parameters.Status,types:["number"]},{name:Microsoft.Office.WebExtension.Parameters.AppCommandInvocationCompletedData,types:["string"]}]});OSF.OUtil.augmentList(OSF.DDA.EventDescriptors,{AppCommandInvokedEvent:"AppCommandInvokedEvent"});OSF.OUtil.augmentList(Microsoft.Office.WebExtension.EventType,{AppCommandInvoked:"appCommandInvoked"});OSF.OUtil.setNamespace("AppCommand",OSF.DDA);OSF.DDA.AppCommand.AppCommandInvokedEventArgs=n.AppCommand.AppCommandInvokedEventArgs},r.prototype.initializeAndChangeOnce=function(n){t.registerDdaFacade();this._pseudoDocument={};OSF.DDA.DispIdHost.addAsyncMethods(this._pseudoDocument,[OSF.DDA.AsyncMethodNames.AppCommandInvocationCompletedAsync,]);this._eventDispatch=new OSF.EventDispatch([Microsoft.Office.WebExtension.EventType.AppCommandInvoked,]);var i=function(t){n&&(t.status=="succeeded"?n(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):n(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))};OSF.DDA.DispIdHost.addEventSupport(this._pseudoDocument,this._eventDispatch);this._pseudoDocument.addHandlerAsync(Microsoft.Office.WebExtension.EventType.AppCommandInvoked,this._processAppCommandInvocation,i)},r.prototype._verifyManifestCallback=function(n){var u={callback:null,errorCode:OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidCallback},t,i,r,f;n=n.trim();try{for(t=n.split("."),i=window,r=0;r<t.length-1;r++)if(i[t[r]]&&(typeof i[t[r]]=="object"||typeof i[t[r]]=="function"))i=i[t[r]];else return u;if(f=i[t[t.length-1]],typeof f!="function")return u}catch(e){return u}return{callback:f,errorCode:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}},r.prototype._invokeAppCommandCompletedMethod=function(n,t,i){this._pseudoDocument.appCommandInvocationCompletedAsync(n,t,i)},r.prototype._constructEventObjectForCallback=function(n){var u=this,t=new i,r;try{r=JSON.parse(n.eventObjStr);this._translateEventObjectInternal(r,t);Object.defineProperty(t,"completed",{value:function(i){t.completedContext=i;var r=JSON.stringify(t);u._invokeAppCommandCompletedMethod(n.appCommandId,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,r)},enumerable:!0})}catch(f){t=null}return t},r.prototype._translateEventObjectInternal=function(n,t){var i,r;for(i in n)n.hasOwnProperty(i)&&(r=n[i],typeof r=="object"&&r!=null?(OSF.OUtil.defineEnumerableProperty(t,i,{value:{}}),this._translateEventObjectInternal(r,t[i])):Object.defineProperty(t,i,{value:r,enumerable:!0,writable:!0}))},r.prototype._constructObjectByTemplate=function(n,t){var r={},i;if(!n||!t)return r;for(i in n)if(n.hasOwnProperty(i)&&(r[i]=null,t[i]!=null)){var u=n[i],f=t[i],e=typeof f;typeof u=="object"&&u!=null?r[i]=this._constructObjectByTemplate(u,f):(e=="number"||e=="string"||e=="boolean")&&(r[i]=f)}return r},r.instance=function(){return r._instance==null&&(r._instance=new r),r._instance},r._instance=null,r}(),r,i;t.AppCommandManager=u;r=function(){function n(n,t,i){this.type=Microsoft.Office.WebExtension.EventType.AppCommandInvoked;this.appCommandId=n;this.callbackName=t;this.eventObjStr=i}return n.create=function(i){return new n(i[t.AppCommandInvokedEventEnums.AppCommandId],i[t.AppCommandInvokedEventEnums.CallbackName],i[t.AppCommandInvokedEventEnums.EventObjStr])},n}();t.AppCommandInvokedEventArgs=r;i=function(){function n(){}return n}();t.AppCommandCallbackEventArgs=i;t.AppCommandInvokedEventEnums={AppCommandId:"appCommandId",CallbackName:"callbackName",EventObjStr:"eventObjStr"}})(t=n.AppCommand||(n.AppCommand={}))}(OfficeExt||(OfficeExt={}));OfficeExt.AppCommand.AppCommandManager.initializeOsfDda(),function(n){var t;(function(t){function i(){if(OSF.DDA.SafeArray){var t=OSF.DDA.SafeArray.Delegate.ParameterMap;t.define({type:OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,toHost:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:0},{name:Microsoft.Office.WebExtension.Parameters.Status,value:1},{name:Microsoft.Office.WebExtension.Parameters.AppCommandInvocationCompletedData,value:2}]});t.define({type:OSF.DDA.EventDispId.dispidAppCommandInvokedEvent,fromHost:[{name:OSF.DDA.EventDescriptors.AppCommandInvokedEvent,value:t.self}],isComplexType:!0});t.define({type:OSF.DDA.EventDescriptors.AppCommandInvokedEvent,fromHost:[{name:n.AppCommand.AppCommandInvokedEventEnums.AppCommandId,value:0},{name:n.AppCommand.AppCommandInvokedEventEnums.CallbackName,value:1},{name:n.AppCommand.AppCommandInvokedEventEnums.EventObjStr,value:2},],isComplexType:!0})}}t.registerDdaFacade=i})(t=n.AppCommand||(n.AppCommand={}))}(OfficeExt||(OfficeExt={}));OSF.InitializationHelper.prototype.prepareRightAfterWebExtensionInitialize=function(){var n=OfficeExt.AppCommand.AppCommandManager.instance();n.initializeAndChangeOnce()};OSF.DDA.VisioDocument=function(n,t){OSF.DDA.VisioDocument.uber.constructor.call(this,n,new OSF.DDA.BindingFacade(this),t);OSF.OUtil.finalizeProperties(this)};OSF.OUtil.extend(OSF.DDA.VisioDocument,OSF.DDA.JsomDocument);OSF.InitializationHelper.prototype.loadAppSpecificScriptAndCreateOM=function(n,t,i){OSF.DDA.ErrorCodeManager.initializeErrorMessages(Strings.OfficeOM);n.doc=new OSF.DDA.VisioDocument(n,this._initializeSettings(!0));OSF.DDA.DispIdHost.addAsyncMethods(OSF.DDA.RichApi,[OSF.DDA.AsyncMethodNames.ExecuteRichApiRequestAsync]);OSF.DDA.RichApi.richApiMessageManager=new OfficeExt.RichApiMessageManager;t()};__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t,i;(function(n){n.OfficeRequire=function(){return null}()})(t=n._Internal||(n._Internal={})),function(n){var t;(function(t){function i(){return function(){"use strict";function vt(n){return typeof n=="function"||typeof n=="object"&&n!==null}function b(n){return typeof n=="function"}function yt(n){return typeof n=="object"&&n!==null}function wt(n){k=n}function bt(n){f=n}function ni(){var t=process.nextTick,n=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(n)&&n[1]==="0"&&n[2]==="10"&&(t=window.setImmediate),function(){t(c)}}function tr(){return function(){pt(c)}}function ti(){var n=0,i=new it(c),t=document.createTextNode("");return i.observe(t,{characterData:!0}),function(){t.data=n=++n%2}}function ii(){var n=new MessageChannel;return n.port1.onmessage=c,function(){n.port2.postMessage(0)}}function ri(){return function(){setTimeout(c,1)}}function c(){for(var t,i,n=0;n<h;n+=2)t=e[n],i=e[n+1],t(i),e[n]=undefined,e[n+1]=undefined;h=0}function l(){}function ui(){return new TypeError("You cannot resolve a promise with itself")}function fi(){return new TypeError("A promises callback cannot return that same promise.")}function ei(n){try{return n.then}catch(t){return y.error=t,y}}function oi(n,t,i,r){try{n.call(t,i,r)}catch(u){return u}}function si(n,i,u){f(function(n){var f=!1,e=oi(u,i,function(t){f||(f=!0,i!==t?v(n,t):r(n,t))},function(i){f||(f=!0,t(n,i))},"Settle: "+(n._label||" unknown promise"));!f&&e&&(f=!0,t(n,e))},n)}function hi(n,i){i._state===a?r(n,i._result):i._state===s?t(n,i._result):p(i,undefined,function(t){v(n,t)},function(i){t(n,i)})}function ci(n,i){if(i.constructor===n.constructor)hi(n,i);else{var u=ei(i);u===y?t(n,y.error):u===undefined?r(n,i):b(u)?si(n,i,u):r(n,i)}}function v(n,i){n===i?t(n,ui()):vt(i)?ci(n,i):r(n,i)}function li(n){n._onerror&&n._onerror(n._result);d(n)}function r(n,t){n._state===o&&(n._result=t,n._state=a,n._subscribers.length!==0&&f(d,n))}function t(n,t){n._state===o&&(n._state=s,n._result=t,f(li,n))}function p(n,t,i,r){var u=n._subscribers,e=u.length;n._onerror=null;u[e]=t;u[e+a]=i;u[e+s]=r;e===0&&n._state&&f(d,n)}function d(n){var i=n._subscribers,e=n._state,r,u,f,t;if(i.length!==0){for(f=n._result,t=0;t<i.length;t+=3)r=i[t],u=i[t+e],r?ft(e,r,u,f):u(f);n._subscribers.length=0}}function ut(){this.error=null}function ai(n,t){try{return n(t)}catch(i){return w.error=i,w}}function ft(n,i,u,f){var c=b(u),e,l,h,y;if(c){if(e=ai(u,f),e===w?(y=!0,l=e.error,e=null):h=!0,i===e){t(i,fi());return}}else e=f,h=!0;i._state!==o||(c&&h?v(i,e):y?t(i,l):n===a?r(i,e):n===s&&t(i,e))}function vi(n,i){try{i(function(t){v(n,t)},function(i){t(n,i)})}catch(r){t(n,r)}}function u(n,i){var u=this;u._instanceConstructor=n;u.promise=new n(l);u._validateInput(i)?(u._input=i,u.length=i.length,u._remaining=i.length,u._init(),u.length===0?r(u.promise,u._result):(u.length=u.length||0,u._enumerate(),u._remaining===0&&r(u.promise,u._result))):t(u.promise,u._validationError())}function yi(n){return new et(this,n).promise}function pi(n){function e(n){v(i,n)}function s(n){t(i,n)}var u=this,i=new u(l),f,r;if(!nt(n))return t(i,new TypeError("You must pass an array to race.")),i;for(f=n.length,r=0;i._state===o&&r<f;r++)p(u.resolve(n[r]),undefined,e,s);return i}function wi(n){var i=this,t;return n&&typeof n=="object"&&n.constructor===i?n:(t=new i(l),v(t,n),t)}function bi(n){var r=this,i=new r(l);return t(i,n),i}function ki(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}function di(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}function i(n){this._id=lt++;this._state=undefined;this._result=undefined;this._subscribers=[];l!==n&&(b(n)||ki(),this instanceof i||di(),vi(this,n))}var g,e,rt,w,et,ot,st,ht,ct,lt,at;g=Array.isArray?Array.isArray:function(n){return Object.prototype.toString.call(n)==="[object Array]"};var nt=g,h=0,gi={}.toString,pt,k,f=function(n,t){e[h]=n;e[h+1]=t;h+=2;h===2&&(k?k(c):rt())};var kt=typeof window!="undefined"?window:undefined,tt=kt||{},it=tt.MutationObserver||tt.WebKitMutationObserver,dt=typeof process!="undefined"&&{}.toString.call(process)==="[object process]",gt=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";e=new Array(1e3);rt=dt?ni():it?ti():gt?ii():ri();var o=void 0,a=1,s=2,y=new ut;return w=new ut,u.prototype._validateInput=function(n){return nt(n)},u.prototype._validationError=function(){return new n.Error("Array Methods must be provided an Array")},u.prototype._init=function(){this._result=new Array(this.length)},et=u,u.prototype._enumerate=function(){for(var n=this,i=n.length,r=n.promise,u=n._input,t=0;r._state===o&&t<i;t++)n._eachEntry(u[t],t)},u.prototype._eachEntry=function(n,t){var i=this,r=i._instanceConstructor;yt(n)?n.constructor===r&&n._state!==o?(n._onerror=null,i._settledAt(n._state,t,n._result)):i._willSettleAt(r.resolve(n),t):(i._remaining--,i._result[t]=n)},u.prototype._settledAt=function(n,i,u){var f=this,e=f.promise;e._state===o&&(f._remaining--,n===s?t(e,u):f._result[i]=u);f._remaining===0&&r(e,f._result)},u.prototype._willSettleAt=function(n,t){var i=this;p(n,undefined,function(n){i._settledAt(a,t,n)},function(n){i._settledAt(s,t,n)})},ot=yi,st=pi,ht=wi,ct=bi,lt=0,at=i,i.all=ot,i.race=st,i.resolve=ht,i.reject=ct,i._setScheduler=wt,i._setAsap=bt,i._asap=f,i.prototype={constructor:i,then:function(n,t){var u=this,i=u._state,r,e,o;return i===a&&!n||i===s&&!t?this:(r=new this.constructor(l),e=u._result,i?(o=arguments[i-1],f(function(){ft(i,r,o,e)})):p(u,r,n,t),r)},"catch":function(n){return this.then(null,n)}},at}.call(this)}t.Init=i})(t=n.PromiseImpl||(n.PromiseImpl={}))}(t=n._Internal||(n._Internal={})),function(n){function t(){var n=window.navigator.userAgent,t=n.indexOf("Edge/");return t>=0?(n=n.substring(t+5,n.length),n<"14.14393"?!0:!1):!1}function i(){return typeof window=="undefined"&&typeof Promise=="function"?Promise:typeof window!="undefined"&&window.Promise?t()?n.PromiseImpl.Init():window.Promise:n.PromiseImpl.Init()}n.OfficePromise=i()}(t=n._Internal||(n._Internal={}));i=t.OfficePromise;n.Promise=i}(OfficeExtension||(OfficeExtension={})),function(n){function ai(n){w._testReadyImpl=n}function vi(n){w.getGenericEventRegistration()._handleRichApiMessage(n)}var k=function(){function n(){}return n.prototype._resolveRequestUrlAndHeaderInfo=function(){return t._createPromiseFromResult(null)},n.prototype._createRequestExecutorOrNull=function(){return null},Object.defineProperty(n.prototype,"eventRegistration",{get:function(){return null},enumerable:!0,configurable:!0}),n}(),et,d,r,f,o,a,c,t,g,rt,v,l,ot,dt,ht,ut,gt,ct,s,u,tt,pt,ni,ft,ti,y,lt,ri,e,it,wt,at,vt,w,ui,fi,b,ei,bt,yt,p,i,oi,kt,st,h,nt,si,hi;n.SessionBase=k;et=function(){function n(){}return n.setCustomSendRequestFunc=function(t){n.s_customSendRequestFunc=t},n.xhrSendRequestFunc=function(n){return t.createPromise(function(i,u){var e=new XMLHttpRequest,s;if(e.open(n.method,n.url),e.onload=function(){var n={statusCode:e.status,headers:t._parseHttpResponseHeaders(e.getAllResponseHeaders()),body:e.responseText};i(n)},e.onerror=function(){u(new r.RuntimeError({code:f.connectionFailure,message:t._getResourceString(o.connectionFailureWithStatus,e.statusText)}))},n.headers)for(s in n.headers)e.setRequestHeader(s,n.headers[s]);e.send(t._getRequestBodyText(n))})},n.sendRequest=function(t){n.validateAndNormalizeRequest(t);var i=n.s_customSendRequestFunc;return i||(i=n.xhrSendRequestFunc),i(t)},n.setCustomSendLocalDocumentRequestFunc=function(t){n.s_customSendLocalDocumentRequestFunc=t},n.sendLocalDocumentRequest=function(t){n.validateAndNormalizeRequest(t);var i;return i=n.s_customSendLocalDocumentRequestFunc||n.officeJsSendLocalDocumentRequestFunc,i(t)},n.officeJsSendLocalDocumentRequestFunc=function(n){n=t._validateLocalDocumentRequest(n);var i=t._buildRequestMessageSafeArray(n);return t.createPromise(function(n,r){OSF.DDA.RichApi.executeRichApiRequestAsync(i,function(i){var r;r=i.status=="succeeded"?{statusCode:c.getResponseStatusCode(i),headers:c.getResponseHeaders(i),body:c.getResponseBody(i)}:c.buildHttpResponseFromOfficeJsError(i.error.code,i.error.message);t.log("Response:");t.log(JSON.stringify(r));n(r)})})},n.validateAndNormalizeRequest=function(n){if(t.isNullOrUndefined(n))throw r.RuntimeError._createInvalidArgError({argumentName:"request"});t.isNullOrEmptyString(n.method)&&(n.method="GET");n.method=n.method.toUpperCase()},n.logRequest=function(i){if(t._logEnabled){if(t.log("---HTTP Request---"),t.log(i.method+" "+i.url),i.headers)for(var r in i.headers)t.log(r+": "+i.headers[r]);n._logBodyEnabled&&t.log(t._getRequestBodyText(i))}},n.logResponse=function(i){if(t._logEnabled){if(t.log("---HTTP Response---"),t.log(""+i.statusCode),i.headers)for(var r in i.headers)t.log(r+": "+i.headers[r]);n._logBodyEnabled&&t.log(i.body)}},n._logBodyEnabled=!1,n}();n.HttpUtility=et;d=function(){function n(n){var t=this;this.m_bridge=n;this.m_promiseResolver={};this.m_handlers=[];this.m_bridge.onMessageFromHost=function(n){var f=JSON.parse(n),r,u,i,e;if(f.type==3&&(r=f.message,r&&r.entries))for(u=0;u<r.entries.length;u++)i=r.entries[u],Array.isArray(i)&&(e={messageCategory:i[0],messageType:i[1],targetId:i[2],message:i[3],id:i[4]},r.entries[u]=e);t.dispatchMessage(f)}}return n.init=function(i){var r,u;if(typeof i=="object"&&i)for(r=new n(i),n.s_instance=r,et.setCustomSendLocalDocumentRequestFunc(function(i){var u,f,o,e,s;return i=t._validateLocalDocumentRequest(i),u=0,t.isReadonlyRestRequest(i.method)||(u=1),f=i.url.indexOf("?"),f>=0&&(o=i.url.substr(f+1),e=t._parseRequestFlagsFromQueryStringIfAny(o),e>=0&&(u=e)),s={id:n.nextId(),type:1,flags:u,message:i},r.sendMessageToHostAndExpectResponse(s).then(function(n){return n.message})}),u=0;u<n.s_onInitedHandlers.length;u++)n.s_onInitedHandlers[u](r)},Object.defineProperty(n,"instance",{get:function(){return n.s_instance},enumerable:!0,configurable:!0}),n.prototype.sendMessageToHost=function(n){this.m_bridge.sendMessageToHost(JSON.stringify(n))},n.prototype.sendMessageToHostAndExpectResponse=function(n){var i=this,r=t.createPromise(function(t,r){i.m_promiseResolver[n.id]=t});return this.m_bridge.sendMessageToHost(JSON.stringify(n)),r},n.prototype.addHostMessageHandler=function(n){this.m_handlers.push(n)},n.prototype.removeHostMessageHandler=function(n){var t=this.m_handlers.indexOf(n);t>=0&&this.m_handlers.splice(t,1)},n.onInited=function(t){n.s_onInitedHandlers.push(t);n.s_instance&&t(n.s_instance)},n.prototype.dispatchMessage=function(n){var i,t;if(typeof n.id=="number"&&(i=this.m_promiseResolver[n.id],i)){i(n);delete this.m_promiseResolver[n.id];return}for(t=0;t<this.m_handlers.length;t++)this.m_handlers[t](n)},n.nextId=function(){return n.s_nextId++},n.s_onInitedHandlers=[],n.s_nextId=1,n}();n.HostBridge=d;typeof _richApiNativeBridge=="object"&&_richApiNativeBridge&&d.init(_richApiNativeBridge),function(n){var i=function(i){function r(n){var t=i.call(this,typeof n=="string"?n:n.message)||this;return Object.setPrototypeOf(t,r.prototype),t.name="RichApi.Error",typeof n=="string"?t.message=n:(t.code=n.code,t.message=n.message,t.traceMessages=n.traceMessages||[],t.innerError=n.innerError||null,t.debugInfo=t._createDebugInfo(n.debugInfo||{})),t}return __extends(r,i),r.prototype.toString=function(){return this.code+": "+this.message},r.prototype._createDebugInfo=function(t){var i={code:this.code,message:this.message},r;i.toString=function(){return JSON.stringify(this)};for(r in t)i[r]=t[r];return this.innerError&&(i.innerError=this.innerError instanceof n.RuntimeError?this.innerError.debugInfo:this.innerError),i},r._createInvalidArgError=function(i){return new n.RuntimeError({code:f.invalidArgument,message:t.isNullOrEmptyString(i.argumentName)?t._getResourceString(o.invalidArgumentGeneric):t._getResourceString(o.invalidArgument,i.argumentName),debugInfo:i.errorLocation?{errorLocation:i.errorLocation}:{},innerError:i.innerError})},r}(Error);n.RuntimeError=i}(r=n._Internal||(n._Internal={}));n.Error=r.RuntimeError;f=function(){function n(){}return n.apiNotFound="ApiNotFound",n.accessDenied="AccessDenied",n.generalException="GeneralException",n.activityLimitReached="ActivityLimitReached",n.invalidArgument="InvalidArgument",n.connectionFailure="ConnectionFailure",n.timeout="Timeout",n.invalidOrTimedOutSession="InvalidOrTimedOutSession",n.invalidObjectPath="InvalidObjectPath",n.invalidRequestContext="InvalidRequestContext",n.valueNotLoaded="ValueNotLoaded",n}();n.CoreErrorCodes=f;o=function(){function n(){}return n.apiNotFoundDetails="ApiNotFoundDetails",n.connectionFailureWithStatus="ConnectionFailureWithStatus",n.connectionFailureWithDetails="ConnectionFailureWithDetails",n.invalidArgument="InvalidArgument",n.invalidArgumentGeneric="InvalidArgumentGeneric",n.timeout="Timeout",n.invalidOrTimedOutSessionMessage="InvalidOrTimedOutSessionMessage",n.invalidObjectPath="InvalidObjectPath",n.invalidRequestContext="InvalidRequestContext",n.valueNotLoaded="ValueNotLoaded",n}();n.CoreResourceStrings=o;a=function(){function n(){}return n.flags="flags",n.sourceLibHeader="SdkVersion",n.processQuery="ProcessQuery",n.localDocument="http://document.localhost/",n.localDocumentApiPrefix="http://document.localhost/_api/",n}();n.CoreConstants=a;c=function(){function n(){}return n.buildMessageArrayForIRequestExecutor=function(i,r,u,f){var o=JSON.stringify(u.Body),e;return t.log("Request:"),t.log(o),e={},e[a.sourceLibHeader]=f,n.buildRequestMessageSafeArray(i,r,"POST",a.processQuery,e,o)},n.buildResponseOnSuccess=function(n,t){var i={ErrorCode:"",ErrorMessage:"",Headers:null,Body:null};return i.Body=JSON.parse(n),i.Headers=t,i},n.buildResponseOnError=function(i,r){var u={ErrorCode:"",ErrorMessage:"",Headers:null,Body:null};return u.ErrorCode=f.generalException,u.ErrorMessage=r,i==n.OfficeJsErrorCode_ooeNoCapability?u.ErrorCode=f.accessDenied:i==n.OfficeJsErrorCode_ooeActivityLimitReached?u.ErrorCode=f.activityLimitReached:i==n.OfficeJsErrorCode_ooeInvalidOrTimedOutSession&&(u.ErrorCode=f.invalidOrTimedOutSession,u.ErrorMessage=t._getResourceString(o.invalidOrTimedOutSessionMessage)),u},n.buildHttpResponseFromOfficeJsError=function(t,i){var u=500,r={};return r.error={},r.error.code=f.generalException,r.error.message=i,t===n.OfficeJsErrorCode_ooeNoCapability?(u=403,r.error.code=f.accessDenied):t===n.OfficeJsErrorCode_ooeActivityLimitReached&&(u=429,r.error.code=f.activityLimitReached),{statusCode:u,headers:{},body:JSON.stringify(r)}},n.buildRequestMessageSafeArray=function(n,t,i,r,u,f){var e=[],o;if(u)for(o in u)e.push(o),e.push(u[o]);var s=0,h="",c="",l="";return[n,i,r,e,f,s,t,h,c,l]},n.getResponseBody=function(t){return n.getResponseBodyFromSafeArray(t.value.data)},n.getResponseHeaders=function(t){return n.getResponseHeadersFromSafeArray(t.value.data)},n.getResponseBodyFromSafeArray=function(n){var t=n[2],i;return typeof t=="string"?t:(i=t,i.join(""))},n.getResponseHeadersFromSafeArray=function(n){var i=n[1],r,t;if(!i)return null;for(r={},t=0;t<i.length-1;t+=2)r[i[t]]=i[t+1];return r},n.getResponseStatusCode=function(t){return n.getResponseStatusCodeFromSafeArray(t.value.data)},n.getResponseStatusCodeFromSafeArray=function(n){return n[0]},n.OfficeJsErrorCode_ooeInvalidOrTimedOutSession=5012,n.OfficeJsErrorCode_ooeActivityLimitReached=5102,n.OfficeJsErrorCode_ooeNoCapability=7e3,n}();n.RichApiMessageUtility=c,function(n){function t(){if(typeof Promise!="undefined")return Promise;if(typeof Office!="undefined"&&Office.Promise)return Office.Promise;if(typeof OfficeExtension!="undefined"&&OfficeExtension.Promise)return OfficeExtension.Promise;throw new n.Error("No Promise implementation found");}n.getPromiseType=t}(r=n._Internal||(n._Internal={}));t=function(){function n(){}return n.log=function(t){n._logEnabled&&typeof console!="undefined"&&console.log&&console.log(t)},n.checkArgumentNull=function(t,i){if(n.isNullOrUndefined(t))throw r.RuntimeError._createInvalidArgError({argumentName:i});},n.isNullOrUndefined=function(n){return n===null?!0:typeof n=="undefined"?!0:!1},n.isUndefined=function(n){return typeof n=="undefined"?!0:!1},n.isNullOrEmptyString=function(n){return n===null?!0:typeof n=="undefined"?!0:n.length==0?!0:!1},n.isPlainJsonObject=function(t){if(n.isNullOrUndefined(t)||typeof t!="object"||Object.prototype.toString.apply(t)!=="[object Object]")return!1;var i=t;do i=Object.getPrototypeOf(i);while(i!==null&&Object.getPrototypeOf(i)!==null);return Object.getPrototypeOf(t)===i},n.trim=function(n){return n.replace(new RegExp("^\\s+|\\s+$","g"),"")},n.caseInsensitiveCompareString=function(t,i){return n.isNullOrUndefined(t)?n.isNullOrUndefined(i):n.isNullOrUndefined(i)?!1:t.toUpperCase()==i.toUpperCase()},n.isReadonlyRestRequest=function(t){return n.caseInsensitiveCompareString(t,"GET")},n._getResourceString=function(t,i){var r,f,u,e;return typeof window!="undefined"&&window.Strings&&window.Strings.OfficeOM&&(f="L_"+t,u=window.Strings.OfficeOM[f],u&&(r=u)),r||(r=n.s_resourceStringValues[t]),r||(r=t),n.isNullOrUndefined(i)||(Array.isArray(i)?(e=i,r=n._formatString(r,e)):r=r.replace("{0}",i)),r},n._formatString=function(n,t){return n.replace(/\{\d\}/g,function(n){var i=parseInt(n.substr(1,n.length-2));if(i<t.length)return t[i];else throw r.RuntimeError._createInvalidArgError({argumentName:"format"});})},Object.defineProperty(n,"Promise",{get:function(){return r.getPromiseType()},enumerable:!0,configurable:!0}),n.createPromise=function(t){return new n.Promise(t)},n._createPromiseFromResult=function(t){return n.createPromise(function(n,i){n(t)})},n._createPromiseFromException=function(t){return n.createPromise(function(n,i){i(t)})},n._createTimeoutPromise=function(t){return n.createPromise(function(n,i){setTimeout(function(){n(null)},t)})},n._createInvalidArgError=function(n){return r.RuntimeError._createInvalidArgError(n)},n._isLocalDocumentUrl=function(t){return n._getLocalDocumentUrlPrefixLength(t)>0},n._getLocalDocumentUrlPrefixLength=function(n){for(var i=["http://document.localhost","https://document.localhost","//document.localhost"],r=n.toLowerCase().trim(),t=0;t<i.length;t++)if(r===i[t])return i[t].length;else if(r.substr(0,i[t].length+1)===i[t]+"/")return i[t].length+1;return 0},n._validateLocalDocumentRequest=function(t){var f=n._getLocalDocumentUrlPrefixLength(t.url),i,u;if(f<=0)throw r.RuntimeError._createInvalidArgError({argumentName:"request"});return i=t.url.substr(f),u=i.toLowerCase(),u==="_api"?i="":u.substr(0,5)==="_api/"&&(i=i.substr(5)),{method:t.method,url:i,headers:t.headers,body:t.body}},n._parseRequestFlagsFromQueryStringIfAny=function(n){for(var i,u,r=n.split("&"),t=0;t<r.length;t++)if(i=r[t].split("="),i[0].toLowerCase()===a.flags)return u=parseInt(i[1]),u&511;return-1},n._getRequestBodyText=function(n){var t="";return typeof n.body=="string"?t=n.body:n.body&&typeof n.body=="object"&&(t=JSON.stringify(n.body)),t},n._parseResponseBody=function(t){if(typeof t.body=="string"){var i=n.trim(t.body);return JSON.parse(i)}else return t.body},n._buildRequestMessageSafeArray=function(t){var i=0,r,f,u;return n.isReadonlyRestRequest(t.method)||(i=1),t.url.substr(0,a.processQuery.length).toLowerCase()===a.processQuery.toLowerCase()&&(r=t.url.indexOf("?"),r>0&&(f=t.url.substr(r+1),u=n._parseRequestFlagsFromQueryStringIfAny(f),u>=0&&(i=u))),c.buildRequestMessageSafeArray("",i,t.method,t.url,t.headers,n._getRequestBodyText(t))},n._parseHttpResponseHeaders=function(t){var s={},h,o,r,i,u,f,e;if(!n.isNullOrEmptyString(t))for(h=new RegExp("\r?\n"),o=t.split(h),r=0;r<o.length;r++)i=o[r],i!=null&&(u=i.indexOf(":"),u>0&&(f=i.substr(0,u),e=i.substr(u+1),f=n.trim(f),e=n.trim(e),s[f.toUpperCase()]=e));return s},n._parseErrorResponse=function(t){var i=null,u,e,r;if(n.isPlainJsonObject(t.body))i=t.body;else if(!n.isNullOrEmptyString(t.body)){u=n.trim(t.body);try{i=JSON.parse(u)}catch(s){n.log("Error when parse "+u)}}return!n.isNullOrUndefined(i)&&typeof i=="object"&&i.error?(r=i.error.code,e=n._getResourceString(o.connectionFailureWithDetails,[t.statusCode.toString(),i.error.code,i.error.message])):e=n._getResourceString(o.connectionFailureWithStatus,t.statusCode.toString()),n.isNullOrEmptyString(r)&&(r=f.connectionFailure),{errorCode:r,errorMessage:e}},n._copyHeaders=function(n,t){if(n&&t)for(var i in n)t[i]=n[i]},n.addResourceStringValues=function(t){for(var i in t)n.s_resourceStringValues[i]=t[i]},n._logEnabled=!1,n.s_resourceStringValues={ApiNotFoundDetails:"The method or property {0} is part of the {1} requirement set, which is not available in your version of {2}.",ConnectionFailureWithStatus:"The request failed with status code of {0}.",ConnectionFailureWithDetails:"The request failed with status code of {0}, error code {1} and the following error message: {2}",InvalidArgument:"The argument '{0}' doesn't work for this situation, is missing, or isn't in the right format.",InvalidObjectPath:'The object path \'{0}\' isn\'t working for what you\'re trying to do. If you\'re using the object across multiple "context.sync" calls and outside the sequential execution of a ".run" batch, please use the "context.trackedObjects.add()" and "context.trackedObjects.remove()" methods to manage the object\'s lifetime.',InvalidRequestContext:"Cannot use the object across different request contexts.",Timeout:"The operation has timed out.",ValueNotLoaded:'The value of the result object has not been loaded yet. Before reading the value property, call "context.sync()" on the associated request context.'},n}();n.CoreUtility=t;n._internalConfig={showDisposeInfoInDebugInfo:!1,showInternalApiInDebugInfo:!1,enableEarlyDispose:!0,alwaysPolyfillClientObjectUpdateMethod:!1,alwaysPolyfillClientObjectRetrieveMethod:!1,enableConcurrentFlag:!0,enableUndoableFlag:!0};n.config={extendedErrorLogging:!1};g=function(){function n(){}return n.createSetPropertyAction=function(n,t,i,r,f){var e;u.validateObjectPath(t);var o={Id:n._nextId(),ActionType:4,Name:i,ObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},h=[r],s=u.setMethodArguments(n,o.ArgumentInfo,h);return u.validateReferencedObjectPaths(s),e=new v(o,0,f),e.referencedObjectPath=t._objectPath,e.referencedArgumentObjectPaths=s,t._addAction(e)},n.createQueryAction=function(n,t,i,r){u.validateObjectPath(t);var e={Id:n._nextId(),ActionType:2,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id,QueryInfo:i},f=new v(e,1,4);return f.referencedObjectPath=t._objectPath,t._addAction(f,r)},n.createQueryAsJsonAction=function(n,t,i,r){u.validateObjectPath(t);var e={Id:n._nextId(),ActionType:7,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id,QueryInfo:i},f=new v(e,1,4);return f.referencedObjectPath=t._objectPath,t._addAction(f,r)},n.createUpdateAction=function(n,t,i){u.validateObjectPath(t);var f={Id:n._nextId(),ActionType:9,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id,ObjectState:i},r=new v(f,0,0);return r.referencedObjectPath=t._objectPath,t._addAction(r)},n}();n.CommonActionFactory=g;rt=function(){function i(n,t){this.m_contextBase=n;this.m_objectPath=t}return Object.defineProperty(i.prototype,"_objectPath",{get:function(){return this.m_objectPath},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_context",{get:function(){return this.m_contextBase},enumerable:!0,configurable:!0}),i.prototype._addAction=function(n,i){var r=this;return i===void 0&&(i=null),t.createPromise(function(t,u){r._context._addServiceApiAction(n,i,t,u)})},i.prototype._retrieve=function(t,i){var r=n._internalConfig.alwaysPolyfillClientObjectRetrieveMethod,f;return(r||(r=!u.isSetSupported("RichApiRuntime","1.1")),f=ot._parseQueryOption(t),r)?g.createQueryAction(this._context,this,f,i):g.createQueryAsJsonAction(this._context,this,f,i)},i.prototype._recursivelyUpdate=function(i){var v=n._internalConfig.alwaysPolyfillClientObjectUpdateMethod,h,l,a,w,c,b,e,d,nt;v||(v=!u.isSetSupported("RichApiRuntime","1.2"));try{if(h=this[s.scalarPropertyNames],h||(h=[]),l=this[s.scalarPropertyUpdateable],!l)for(l=[],c=0;c<h.length;c++)l.push(!1);a=this[s.navigationPropertyNames];a||(a=[]);var y={},p={},k=0;for(e in i)if(w=h.indexOf(e),w>=0){if(!l[w])throw new r.RuntimeError({code:f.invalidArgument,message:t._getResourceString(tt.attemptingToSetReadOnlyProperty,e),debugInfo:{errorLocation:e}});y[e]=i[e];++k}else if(a.indexOf(e)>=0)p[e]=i[e];else throw new r.RuntimeError({code:f.invalidArgument,message:t._getResourceString(tt.propertyDoesNotExist,e),debugInfo:{errorLocation:e}});if(k>0)if(v)for(c=0;c<h.length;c++)e=h[c],b=y[e],u.isUndefined(b)||g.createSetPropertyAction(this._context,this,e,b);else g.createUpdateAction(this._context,this,y);for(e in p)d=this[e],nt=p[e],d._recursivelyUpdate(nt)}catch(it){throw new r.RuntimeError({code:f.invalidArgument,message:t._getResourceString(o.invalidArgument,"properties"),debugInfo:{errorLocation:this._className+".update"},innerError:it});}},i}();n.ClientObjectBase=rt;v=function(){function n(n,t,i){this.m_actionInfo=n;this.m_operationType=t;this.m_flags=i}return Object.defineProperty(n.prototype,"actionInfo",{get:function(){return this.m_actionInfo},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"operationType",{get:function(){return this.m_operationType},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"flags",{get:function(){return this.m_flags},enumerable:!0,configurable:!0}),n}();n.Action=v;l=function(){function i(n,t,i,r,u,f){this.m_objectPathInfo=n;this.m_parentObjectPath=t;this.m_isCollection=i;this.m_isInvalidAfterRequest=r;this.m_isValid=!0;this.m_operationType=u;this.m_flags=f}return Object.defineProperty(i.prototype,"objectPathInfo",{get:function(){return this.m_objectPathInfo},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"operationType",{get:function(){return this.m_operationType},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"flags",{get:function(){return this.m_flags},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCollection",{get:function(){return this.m_isCollection},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isInvalidAfterRequest",{get:function(){return this.m_isInvalidAfterRequest},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parentObjectPath",{get:function(){return this.m_parentObjectPath},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"argumentObjectPaths",{get:function(){return this.m_argumentObjectPaths},set:function(n){this.m_argumentObjectPaths=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isValid",{get:function(){return this.m_isValid},set:function(n){this.m_isValid=n;!n&&this.m_objectPathInfo.ObjectPathType===6&&this.m_savedObjectPathInfo&&(i.copyObjectPathInfo(this.m_savedObjectPathInfo.pathInfo,this.m_objectPathInfo),this.m_parentObjectPath=this.m_savedObjectPathInfo.parent,this.m_isValid=!0,this.m_savedObjectPathInfo=null)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"originalObjectPathInfo",{get:function(){return this.m_originalObjectPathInfo},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"getByIdMethodName",{get:function(){return this.m_getByIdMethodName},set:function(n){this.m_getByIdMethodName=n},enumerable:!0,configurable:!0}),i.prototype._updateAsNullObject=function(){this.resetForUpdateUsingObjectData();this.m_objectPathInfo.ObjectPathType=7;this.m_objectPathInfo.Name="";this.m_parentObjectPath=null},i.prototype.saveOriginalObjectPathInfo=function(){n.config.extendedErrorLogging&&!this.m_originalObjectPathInfo&&(this.m_originalObjectPathInfo={},i.copyObjectPathInfo(this.m_objectPathInfo,this.m_originalObjectPathInfo))},i.prototype.updateUsingObjectData=function(n,r){var v=n[s.referenceId],l,a,e,o,h,y,c,f;if(!t.isNullOrEmptyString(v)){this.m_savedObjectPathInfo||this.isInvalidAfterRequest||!i.isRestorableObjectPath(this.m_objectPathInfo.ObjectPathType)||(l={},i.copyObjectPathInfo(this.m_objectPathInfo,l),this.m_savedObjectPathInfo={pathInfo:l,parent:this.m_parentObjectPath});this.saveOriginalObjectPathInfo();this.resetForUpdateUsingObjectData();this.m_objectPathInfo.ObjectPathType=6;this.m_objectPathInfo.Name=v;delete this.m_objectPathInfo.ParentObjectPathId;this.m_parentObjectPath=null;return}if(r&&(a=r[s.collectionPropertyPath],!t.isNullOrEmptyString(a)&&r.context&&(f=u.tryGetObjectIdFromLoadOrRetrieveResult(n),!t.isNullOrUndefined(f)))){for(e=a.split("."),o=r.context[e[0]],h=1;h<e.length;h++)o=o[e[h]];this.saveOriginalObjectPathInfo();this.resetForUpdateUsingObjectData();this.m_parentObjectPath=o._objectPath;this.m_objectPathInfo.ParentObjectPathId=this.m_parentObjectPath.objectPathInfo.Id;this.m_objectPathInfo.ObjectPathType=5;this.m_objectPathInfo.Name="";this.m_objectPathInfo.ArgumentInfo.Arguments=[f];return}if(y=this.parentObjectPath&&this.parentObjectPath.isCollection,c=this.getByIdMethodName,(y||!t.isNullOrEmptyString(c))&&(f=u.tryGetObjectIdFromLoadOrRetrieveResult(n),!t.isNullOrUndefined(f))){this.saveOriginalObjectPathInfo();this.resetForUpdateUsingObjectData();t.isNullOrEmptyString(c)?(this.m_objectPathInfo.ObjectPathType=5,this.m_objectPathInfo.Name=""):(this.m_objectPathInfo.ObjectPathType=3,this.m_objectPathInfo.Name=c,this.m_getByIdMethodName=null);this.m_objectPathInfo.ArgumentInfo.Arguments=[f];return}},i.prototype.resetForUpdateUsingObjectData=function(){this.m_isInvalidAfterRequest=!1;this.m_isValid=!0;this.m_operationType=1;this.m_flags=4;this.m_objectPathInfo.ArgumentInfo={};this.m_argumentObjectPaths=null},i.isRestorableObjectPath=function(n){return n===1||n===5||n===3||n===4},i.copyObjectPathInfo=function(n,t){t.Id=n.Id;t.ArgumentInfo=n.ArgumentInfo;t.Name=n.Name;t.ObjectPathType=n.ObjectPathType;t.ParentObjectPathId=n.ParentObjectPathId},i}();n.ObjectPath=l;ot=function(){function n(){this.m_nextId=0}return n.prototype._nextId=function(){return++this.m_nextId},n.prototype._addServiceApiAction=function(n,t,i,r){this.m_serviceApiQueue||(this.m_serviceApiQueue=new gt(this));this.m_serviceApiQueue.add(n,t,i,r)},n._parseQueryOption=function(t){var f={},e,i;if(typeof t=="string")e=t,f.Select=u._parseSelectExpand(e);else if(Array.isArray(t))f.Select=t;else if(typeof t=="object")if(i=t,n.isLoadOption(i)){if(typeof i.select=="string")f.Select=u._parseSelectExpand(i.select);else if(Array.isArray(i.select))f.Select=i.select;else if(!u.isNullOrUndefined(i.select))throw r.RuntimeError._createInvalidArgError({argumentName:"option.select"});if(typeof i.expand=="string")f.Expand=u._parseSelectExpand(i.expand);else if(Array.isArray(i.expand))f.Expand=i.expand;else if(!u.isNullOrUndefined(i.expand))throw r.RuntimeError._createInvalidArgError({argumentName:"option.expand"});if(typeof i.top=="number")f.Top=i.top;else if(!u.isNullOrUndefined(i.top))throw r.RuntimeError._createInvalidArgError({argumentName:"option.top"});if(typeof i.skip=="number")f.Skip=i.skip;else if(!u.isNullOrUndefined(i.skip))throw r.RuntimeError._createInvalidArgError({argumentName:"option.skip"});}else f=n.parseStrictLoadOption(t);else if(!u.isNullOrUndefined(t))throw r.RuntimeError._createInvalidArgError({argumentName:"option"});return f},n.isLoadOption=function(n){if(!u.isUndefined(n.select)&&(typeof n.select=="string"||Array.isArray(n.select))||!u.isUndefined(n.expand)&&(typeof n.expand=="string"||Array.isArray(n.expand))||!u.isUndefined(n.top)&&typeof n.top=="number"||!u.isUndefined(n.skip)&&typeof n.skip=="number")return!0;for(var t in n)return!1;return!0},n.parseStrictLoadOption=function(t){var i={Select:[]};return n.parseStrictLoadOptionHelper(i,"","option",t),i},n.combineQueryPath=function(n,t,i){return n.length===0?t:n+i+t},n.parseStrictLoadOptionHelper=function(t,i,u,f){var e,o;for(e in f)if(o=f[e],e==="$all"){if(typeof o!="boolean")throw r.RuntimeError._createInvalidArgError({argumentName:n.combineQueryPath(u,e,".")});o&&t.Select.push(n.combineQueryPath(i,"*","/"))}else if(e==="$top"){if(typeof o!="number"||i.length>0)throw r.RuntimeError._createInvalidArgError({argumentName:n.combineQueryPath(u,e,".")});t.Top=o}else if(e==="$skip"){if(typeof o!="number"||i.length>0)throw r.RuntimeError._createInvalidArgError({argumentName:n.combineQueryPath(u,e,".")});t.Skip=o}else if(typeof o=="boolean")o&&t.Select.push(n.combineQueryPath(i,e,"/"));else if(typeof o=="object")n.parseStrictLoadOptionHelper(t,n.combineQueryPath(i,e,"/"),n.combineQueryPath(u,e,"."),o);else throw r.RuntimeError._createInvalidArgError({argumentName:n.combineQueryPath(u,e,".")});},n}();n.ClientRequestContextBase=ot;dt=function(){function n(n){this.m_objectPath=n}return n.prototype._handleResult=function(n){t.isNullOrUndefined(n)?this.m_objectPath._updateAsNullObject():this.m_objectPath.updateUsingObjectData(n,null)},n}();ht=function(){function i(n){this.m_contextBase=n;this.m_actions=[];this.m_actionResultHandler={};this.m_referencedObjectPaths={};this.m_instantiatedObjectPaths={};this.m_preSyncPromises=[]}return i.prototype.addAction=function(n){this.m_actions.push(n);n.actionInfo.ActionType==1&&(this.m_instantiatedObjectPaths[n.actionInfo.ObjectPathId]=n)},Object.defineProperty(i.prototype,"hasActions",{get:function(){return this.m_actions.length>0},enumerable:!0,configurable:!0}),i.prototype._getLastAction=function(){return this.m_actions[this.m_actions.length-1]},i.prototype.ensureInstantiateObjectPath=function(n){var i,t,r;if(n){if(this.m_instantiatedObjectPaths[n.objectPathInfo.Id])return;this.ensureInstantiateObjectPath(n.parentObjectPath);this.ensureInstantiateObjectPaths(n.argumentObjectPaths);this.m_instantiatedObjectPaths[n.objectPathInfo.Id]||(i={Id:this.m_contextBase._nextId(),ActionType:1,Name:"",ObjectPathId:n.objectPathInfo.Id},t=new v(i,1,4),t.referencedObjectPath=n,this.addReferencedObjectPath(n),this.addAction(t),r=new dt(n),this.addActionResultHandler(t,r))}},i.prototype.ensureInstantiateObjectPaths=function(n){if(n)for(var t=0;t<n.length;t++)this.ensureInstantiateObjectPath(n[t])},i.prototype.addReferencedObjectPath=function(n){if(n&&!this.m_referencedObjectPaths[n.objectPathInfo.Id]){if(!n.isValid)throw new r.RuntimeError({code:f.invalidObjectPath,message:t._getResourceString(o.invalidObjectPath,u.getObjectPathExpression(n)),debugInfo:{errorLocation:u.getObjectPathExpression(n)}});while(n)this.m_referencedObjectPaths[n.objectPathInfo.Id]=n,n.objectPathInfo.ObjectPathType==3&&this.addReferencedObjectPaths(n.argumentObjectPaths),n=n.parentObjectPath}},i.prototype.addReferencedObjectPaths=function(n){if(n)for(var t=0;t<n.length;t++)this.addReferencedObjectPath(n[t])},i.prototype.addActionResultHandler=function(n,t){this.m_actionResultHandler[n.actionInfo.Id]=t},i.prototype.aggregrateRequestFlags=function(n,t,i){return t===0&&(n=n|1,(i&2)==0&&(n=n&-17),(i&8)==0&&(n=n&-257),n=n&-5),i&1&&(n=n|2),(i&4)==0&&(n=n&-5),n},i.prototype.finallyNormalizeFlags=function(t){return(t&1)==0&&(t=t&-17,t=t&-257),n._internalConfig.enableConcurrentFlag||(t=t&-5),n._internalConfig.enableUndoableFlag||(t=t&-17),u.isSetSupported("RichApiRuntimeFlag","1.1")||(t=t&-5,t=t&-17),u.isSetSupported("RichApiRuntimeFlag","1.2")||(t=t&-257),typeof this.m_flagsForTesting=="number"&&(t=this.m_flagsForTesting),t},i.prototype.buildRequestMessageBodyAndRequestFlags=function(){var t,e,u,o,h,f,r,c;n._internalConfig.enableEarlyDispose&&i._calculateLastUsedObjectPathIds(this.m_actions);t=276;e={};for(u in this.m_referencedObjectPaths)t=this.aggregrateRequestFlags(t,this.m_referencedObjectPaths[u].operationType,this.m_referencedObjectPaths[u].flags),e[u]=this.m_referencedObjectPaths[u].objectPathInfo;for(o=[],h=!1,f=0;f<this.m_actions.length;f++)r=this.m_actions[f],r.actionInfo.ActionType===3&&r.actionInfo.Name===s.keepReference&&(h=!0),t=this.aggregrateRequestFlags(t,r.operationType,r.flags),o.push(r.actionInfo);return t=this.finallyNormalizeFlags(t),c={AutoKeepReference:this.m_contextBase._autoCleanup&&h,Actions:o,ObjectPaths:e},{body:c,flags:t}},i.prototype.processResponse=function(n){var t,i,r;if(n)for(t=0;t<n.length;t++)i=n[t],r=this.m_actionResultHandler[i.ActionId],r&&r._handleResult(i.Value)},i.prototype.invalidatePendingInvalidObjectPaths=function(){for(var n in this.m_referencedObjectPaths)this.m_referencedObjectPaths[n].isInvalidAfterRequest&&(this.m_referencedObjectPaths[n].isValid=!1)},i.prototype._addPreSyncPromise=function(n){this.m_preSyncPromises.push(n)},Object.defineProperty(i.prototype,"_preSyncPromises",{get:function(){return this.m_preSyncPromises},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_actions",{get:function(){return this.m_actions},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_objectPaths",{get:function(){return this.m_referencedObjectPaths},enumerable:!0,configurable:!0}),i.prototype._removeKeepReferenceAction=function(n){for(var i,t=this.m_actions.length-1;t>=0;t--)if(i=this.m_actions[t].actionInfo,i.ObjectPathId===n&&i.ActionType===3&&i.Name===s.keepReference){this.m_actions.splice(t,1);break}},i._updateLastUsedActionIdOfObjectPathId=function(n,t,r){for(var u,e,f;t;){if(n[t.objectPathInfo.Id])return;if(n[t.objectPathInfo.Id]=r,u=t.argumentObjectPaths,u)for(e=u.length,f=0;f<e;f++)i._updateLastUsedActionIdOfObjectPathId(n,u[f],r);t=t.parentObjectPath}},i._calculateLastUsedObjectPathIds=function(n){for(var o,v,s,h,l,u,f,t,c,e={},a=n.length,r=a-1;r>=0;--r)if(t=n[r],u=t.actionInfo.Id,t.referencedObjectPath&&i._updateLastUsedActionIdOfObjectPathId(e,t.referencedObjectPath,u),o=t.referencedArgumentObjectPaths,o)for(v=o.length,s=0;s<v;s++)i._updateLastUsedActionIdOfObjectPathId(e,o[s],u);h={};for(l in e)u=e[l],f=h[u],f||(f=[],h[u]=f),f.push(parseInt(l));for(r=0;r<a;r++)t=n[r],c=h[t.actionInfo.Id],c&&c.length>0?t.actionInfo.L=c:t.actionInfo.L&&delete t.actionInfo.L},i}();n.ClientRequestBase=ht;ut=function(){function n(n){this.m_type=n}return Object.defineProperty(n.prototype,"value",{get:function(){if(!this.m_isLoaded)throw new r.RuntimeError({code:f.valueNotLoaded,message:t._getResourceString(o.valueNotLoaded),debugInfo:{errorLocation:"clientResult.value"}});return this.m_value},enumerable:!0,configurable:!0}),n.prototype._handleResult=function(n){(this.m_isLoaded=!0,typeof n=="object"&&n&&n._IsNull)||(this.m_value=this.m_type===1?u.adjustToDateTime(n):n)},n}();n.ClientResult=ut;gt=function(){function n(n){this.m_context=n;this.m_actions=[]}return n.prototype.add=function(n,t,i,r){var u=this;this.m_actions.push({action:n,resultHandler:t,resolve:i,reject:r});this.m_actions.length===1&&setTimeout(function(){return u.processActions()},0)},n.prototype.processActions=function(){var s=this,i,n,u,r,o;if(this.m_actions.length!==0){for(i=this.m_actions,this.m_actions=[],n=new ht(this.m_context),u=0;u<i.length;u++)r=i[u],n.ensureInstantiateObjectPath(r.action.referencedObjectPath),n.ensureInstantiateObjectPaths(r.action.referencedArgumentObjectPaths),n.addAction(r.action),n.addReferencedObjectPath(r.action.referencedObjectPath),n.addReferencedObjectPaths(r.action.referencedArgumentObjectPaths);var f=n.buildRequestMessageBodyAndRequestFlags(),e=f.body,h=f.flags,c={Url:a.localDocumentApiPrefix,Headers:null,Body:e};t.log("Request:");t.log(JSON.stringify(e));o=new ct;o.executeAsync(this.m_context._customData,h,c).then(function(t){s.processResponse(n,i,t)}).catch(function(n){for(var r,t=0;t<i.length;t++)r=i[t],r.reject(n)})}},n.prototype.processResponse=function(n,t,i){var u=this.getErrorFromResponse(i),r=null;i.Body.Results?r=i.Body.Results:i.Body.ProcessedResults&&i.Body.ProcessedResults.Results&&(r=i.Body.ProcessedResults.Results);r||(r=[]);this.processActionResults(n,t,r,u)},n.prototype.getErrorFromResponse=function(n){return t.isNullOrEmptyString(n.ErrorCode)?n.Body&&n.Body.Error?new r.RuntimeError({code:n.Body.Error.Code,message:n.Body.Error.Message}):null:new r.RuntimeError({code:n.ErrorCode,message:n.ErrorMessage})},n.prototype.processActionResults=function(n,t,i,r){var e,f,o;for(n.processResponse(i),e=0;e<t.length;e++){var u=t[e],h=u.action.actionInfo.Id,s=!1;for(f=0;f<i.length;f++)if(h==i[f].ActionId){o=i[f].Value;u.resultHandler&&(u.resultHandler._handleResult(o),o=u.resultHandler.value);u.resolve&&u.resolve(o);s=!0;break}!s&&u.reject&&(r?u.reject(r):u.reject("No response for the action."))}},n}();ct=function(){function n(){}return n.prototype.executeAsync=function(i,r,u){var f=u.Url,e,o,s;if(f.charAt(f.length-1)!="/"&&(f=f+"/"),f=f+a.processQuery,f=f+"?"+a.flags+"="+r.toString(),e={method:"POST",url:f,headers:{},body:u.Body},e.headers[a.sourceLibHeader]=n.SourceLibHeaderValue,e.headers["CONTENT-TYPE"]="application/json",u.Headers)for(o in u.Headers)e.headers[o]=u.Headers[o];return s=t._isLocalDocumentUrl(e.url)?et.sendLocalDocumentRequest:et.sendRequest,s(e).then(function(n){var i,r;return n.statusCode===200?i={ErrorCode:null,ErrorMessage:null,Headers:n.headers,Body:t._parseResponseBody(n)}:(t.log("Error Response:"+n.body),r=t._parseErrorResponse(n),i={ErrorCode:r.errorCode,ErrorMessage:r.errorMessage,Headers:n.headers,Body:null}),i})},n.SourceLibHeaderValue="officejs-rest",n}();n.HttpRequestExecutor=ct;s=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.collectionPropertyPath="_collectionPropertyPath",t.id="Id",t.idLowerCase="id",t.idPrivate="_Id",t.keepReference="_KeepReference",t.objectPathIdPrivate="_ObjectPathId",t.referenceId="_ReferenceId",t.items="_Items",t.itemsLowerCase="items",t.scalarPropertyNames="_scalarPropertyNames",t.navigationPropertyNames="_navigationPropertyNames",t.scalarPropertyUpdateable="_scalarPropertyUpdateable",t}(a);n.CommonConstants=s;u=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return __extends(i,n),i.validateObjectPath=function(n){for(var u=n._objectPath;u;){if(!u.isValid)throw new r.RuntimeError({code:f.invalidObjectPath,message:t._getResourceString(o.invalidObjectPath,i.getObjectPathExpression(u)),debugInfo:{errorLocation:i.getObjectPathExpression(u)}});u=u.parentObjectPath}},i.validateReferencedObjectPaths=function(n){var e,u;if(n)for(e=0;e<n.length;e++)for(u=n[e];u;){if(!u.isValid)throw new r.RuntimeError({code:f.invalidObjectPath,message:t._getResourceString(o.invalidObjectPath,i.getObjectPathExpression(u))});u=u.parentObjectPath}},i._toCamelLowerCase=function(n){if(t.isNullOrEmptyString(n))return n;for(var i=0;i<n.length&&n.charCodeAt(i)>=65&&n.charCodeAt(i)<=90;)i++;return i<n.length?n.substr(0,i).toLowerCase()+n.substr(i):n.toLowerCase()},i.adjustToDateTime=function(n){var r,u;if(t.isNullOrUndefined(n))return null;if(typeof n=="string")return new Date(n);if(Array.isArray(n)){for(r=n,u=0;u<r.length;u++)r[u]=i.adjustToDateTime(r[u]);return r}throw t._createInvalidArgError({argumentName:"date"});},i.tryGetObjectIdFromLoadOrRetrieveResult=function(n){var i=n[s.id];return t.isNullOrUndefined(i)&&(i=n[s.idLowerCase]),t.isNullOrUndefined(i)&&(i=n[s.idPrivate]),i},i.getObjectPathExpression=function(n){for(var t="";n;){switch(n.objectPathInfo.ObjectPathType){case 1:t=t;break;case 2:t="new()"+(t.length>0?".":"")+t;break;case 3:t=i.normalizeName(n.objectPathInfo.Name)+"()"+(t.length>0?".":"")+t;break;case 4:t=i.normalizeName(n.objectPathInfo.Name)+(t.length>0?".":"")+t;break;case 5:t="getItem()"+(t.length>0?".":"")+t;break;case 6:t="_reference()"+(t.length>0?".":"")+t;break}n=n.parentObjectPath}return t},i.setMethodArguments=function(n,r,u){if(t.isNullOrUndefined(u))return null;var f=[],e=[],o=i.collectObjectPathInfos(n,u,f,e);return r.Arguments=u,o&&(r.ReferencedObjectPathIds=e),f},i.validateContext=function(n,i){if(n&&i&&i._context!==n)throw new r.RuntimeError({code:f.invalidRequestContext,message:t._getResourceString(o.invalidRequestContext)});},i.isSetSupported=function(n,t){return typeof window!="undefined"&&window.Office&&window.Office.context&&window.Office.context.requirements?window.Office.context.requirements.isSetSupported(n,t):!0},i.throwIfApiNotSupported=function(n,u,e,s){if(i._doApiNotSupportedCheck&&!i.isSetSupported(u,e)){var h=t._getResourceString(o.apiNotFoundDetails,[n,u+" "+e,s]);throw new r.RuntimeError({code:f.apiNotFound,message:h,debugInfo:{errorLocation:n}});}},i._parseSelectExpand=function(n){function e(n){var t=n.toLowerCase(),i,r;return t==="items"||t==="items/"?"*":(i=6,r=t.substr(0,i)==="items/"||t.substr(0,i)==="items.",r&&(n=n.substr(i)),n.replace(new RegExp("[/.]items[/.]","gi"),"/"))}var f=[],u,r,i;if(!t.isNullOrEmptyString(n))for(u=n.split(","),r=0;r<u.length;r++)i=u[r],i=e(i.trim()),i.length>0&&f.push(i);return f},i.changePropertyNameToCamelLowerCase=function(n){var o=95,r,t,u,f,e;if(Array.isArray(n)){for(t=[],r=0;r<n.length;r++)t.push(this.changePropertyNameToCamelLowerCase(n[r]));return t}else if(typeof n=="object"&&n!==null){t={};for(u in n)if(f=n[u],u===s.items){t={};t[s.itemsLowerCase]=this.changePropertyNameToCamelLowerCase(f);break}else e=i._toCamelLowerCase(u),t[e]=this.changePropertyNameToCamelLowerCase(f);return t}else return n},i.purifyJson=function(n){var f=95,r,i,u,t;if(Array.isArray(n)){for(i=[],r=0;r<n.length;r++)i.push(this.purifyJson(n[r]));return i}else if(typeof n=="object"&&n!==null){i={};for(u in n)u.charCodeAt(0)!==f&&(t=n[u],typeof t=="object"&&t!==null&&Array.isArray(t.items)&&(t=t.items),i[u]=this.purifyJson(t));return i}else return n},i.collectObjectPathInfos=function(n,r,u,f){for(var o,h,c,s=!1,e=0;e<r.length;e++)r[e]instanceof rt?(o=r[e],i.validateContext(n,o),r[e]=o._objectPath.objectPathInfo.Id,f.push(o._objectPath.objectPathInfo.Id),u.push(o._objectPath),s=!0):Array.isArray(r[e])?(h=[],c=i.collectObjectPathInfos(n,r[e],u,h),c?(f.push(h),s=!0):f.push(0)):t.isPlainJsonObject(r[e])?(f.push(0),i.replaceClientObjectPropertiesWithObjectPathIds(r[e],u)):f.push(0);return s},i.replaceClientObjectPropertiesWithObjectPathIds=function(n,r){var e,o,h,u,f,c;for(h in n)if(u=n[h],u instanceof rt)r.push(u._objectPath),n[h]=(e={},e[s.objectPathIdPrivate]=u._objectPath.objectPathInfo.Id,e);else if(Array.isArray(u))for(f=0;f<u.length;f++)u[f]instanceof rt?(c=u[f],r.push(c._objectPath),u[f]=(o={},o[s.objectPathIdPrivate]=c._objectPath.objectPathInfo.Id,o)):t.isPlainJsonObject(u[f])&&i.replaceClientObjectPropertiesWithObjectPathIds(u[f],r);else t.isPlainJsonObject(u)&&i.replaceClientObjectPropertiesWithObjectPathIds(u,r)},i.normalizeName=function(n){return n.substr(0,1).toLowerCase()+n.substr(1)},i._doApiNotSupportedCheck=!1,i}(t);n.CommonUtility=u;tt=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.propertyDoesNotExist="PropertyDoesNotExist",t.attemptingToSetReadOnlyProperty="AttemptingToSetReadOnlyProperty",t}(o);n.CommonResourceStrings=tt;pt=function(n){function t(t){var i=n.call(this)||this;return i.m_shouldPolyfill=t,i}return __extends(t,n),t.prototype._handleResult=function(t){n.prototype._handleResult.call(this,t);this.m_shouldPolyfill&&(this.m_value=u.changePropertyNameToCamelLowerCase(this.m_value));this.m_value=this.removeItemNodes(this.m_value)},t.prototype.removeItemNodes=function(n){return typeof n=="object"&&n!==null&&n[s.itemsLowerCase]&&(n=n[s.itemsLowerCase]),u.purifyJson(n)},t}(ut);n.ClientRetrieveResult=pt;ni=function(){function i(){}return i.invokeMethod=function(n,i,r,f,e,o){return r===void 0&&(r=0),f===void 0&&(f=[]),e===void 0&&(e=0),o===void 0&&(o=0),t.createPromise(function(t,o){var c=new ut,h={Id:n._context._nextId(),ActionType:3,Name:i,ObjectPathId:n._objectPath.objectPathInfo.Id,ArgumentInfo:{}},l=u.setMethodArguments(n._context,h.ArgumentInfo,f),s=new v(h,r,e);s.referencedObjectPath=n._objectPath;s.referencedArgumentObjectPaths=l;n._context._addServiceApiAction(s,c,t,o)})},i.invokeRetrieve=function(t,f){var e=n._internalConfig.alwaysPolyfillClientObjectRetrieveMethod,o;if(e||(e=!u.isSetSupported("RichApiRuntime","1.1")),typeof f[0]=="object"&&f[0].hasOwnProperty("$all")){if(!f[0].$all)throw r.RuntimeError._createInvalidArgError({});o=f[0]}else o=i._parseSelectOption(f);return t._retrieve(o,new pt(e))},i._parseSelectOption=function(n){if(!n||!n[0])throw r.RuntimeError._createInvalidArgError({});var t=n[0]&&typeof n[0]!="string"?n[0]:n;return Array.isArray(t)?t:i.parseRecursiveSelect(t)},i.parseRecursiveSelect=function(n){var t=function(n){return Object.keys(n).reduce(function(i,r){var u=n[r];return typeof u=="object"?i.concat(t(u).map(function(n){return r+"/"+n})):u?i.concat(r):i},[])};return t(n)},i.invokeRecursiveUpdate=function(n,i){return t.createPromise(function(t,r){n._recursivelyUpdate(i);var u={Id:n._context._nextId(),ActionType:5,Name:"Trace",ObjectPathId:0},f=new v(u,1,4);n._context._addServiceApiAction(f,null,t,r)})},i.createRootServiceObject=function(n,t){var i={Id:t._nextId(),ObjectPathType:1,Name:""},r=new l(i,null,!1,!1,1,4);return new n(t,r)},i.createTopLevelServiceObject=function(n,t,i,r,u){var f={Id:t._nextId(),ObjectPathType:2,Name:i},e=new l(f,null,r,!1,1,u|4);return new n(t,e)},i.createPropertyObject=function(n,t,i,r,u){var f={Id:t._context._nextId(),ObjectPathType:4,Name:i,ParentObjectPathId:t._objectPath.objectPathInfo.Id},e=new l(f,t._objectPath,r,!1,1,u|4);return new n(t._context,e)},i.createIndexerObject=function(n,t,i){var r={Id:t._context._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},u;return r.ArgumentInfo.Arguments=i,u=new l(r,t._objectPath,!1,!1,1,4),new n(t._context,u)},i.createMethodObject=function(n,t,i,r,f,e,o,s,h){var a={Id:t._context._nextId(),ObjectPathType:3,Name:i,ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},v=u.setMethodArguments(t._context,a.ArgumentInfo,f),c=new l(a,t._objectPath,e,o,r,h);return c.argumentObjectPaths=v,c.getByIdMethodName=s,new n(t._context,c)},i.createAndInstantiateMethodObject=function(n,i,r,f,e,o,s,h,c){return t.createPromise(function(t,a){var p={Id:i._context._nextId(),ObjectPathType:3,Name:r,ParentObjectPathId:i._objectPath.objectPathInfo.Id,ArgumentInfo:{}},b=u.setMethodArguments(i._context,p.ArgumentInfo,e),y=new l(p,i._objectPath,o,s,f,c);y.argumentObjectPaths=b;y.getByIdMethodName=h;var k=new ut,d={Id:i._context._nextId(),ActionType:1,Name:"",ObjectPathId:y.objectPathInfo.Id,QueryInfo:{}},w=new v(d,1,4);w.referencedObjectPath=y;i._context._addServiceApiAction(w,k,function(){return t(new n(i._context,y))},a)})},i.localDocumentContext=new ot,i}();n.OperationalApiHelper=ni;ft=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.propertyNotLoaded="PropertyNotLoaded",t.runMustReturnPromise="RunMustReturnPromise",t.cannotRegisterEvent="CannotRegisterEvent",t.invalidOrTimedOutSession="InvalidOrTimedOutSession",t.cannotUpdateReadOnlyProperty="CannotUpdateReadOnlyProperty",t}(f);n.ErrorCodes=ft;ti=function(){function n(n){this.m_callback=n}return n.prototype._handleResult=function(n){this.m_callback&&this.m_callback()},n}();y=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.createMethodAction=function(n,t,r,u,f,e){var s,h,o;return i.validateObjectPath(t),s={Id:n._nextId(),ActionType:3,Name:r,ObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},h=i.setMethodArguments(n,s.ArgumentInfo,f),i.validateReferencedObjectPaths(h),o=new v(s,u,i._fixupApiFlags(e)),o.referencedObjectPath=t._objectPath,o.referencedArgumentObjectPaths=h,t._addAction(o),o},t.createRecursiveQueryAction=function(n,t,r){i.validateObjectPath(t);var f={Id:n._nextId(),ActionType:6,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id,RecursiveQueryInfo:r},u=new v(f,1,4);return u.referencedObjectPath=t._objectPath,t._addAction(u),u},t.createEnsureUnchangedAction=function(n,t,r){i.validateObjectPath(t);var f={Id:n._nextId(),ActionType:8,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id,ObjectState:r},u=new v(f,1,4);return u.referencedObjectPath=t._objectPath,t._addAction(u),u},t.createInstantiateAction=function(n,t){i.validateObjectPath(t);n._pendingRequest.ensureInstantiateObjectPath(t._objectPath.parentObjectPath);n._pendingRequest.ensureInstantiateObjectPaths(t._objectPath.argumentObjectPaths);var u={Id:n._nextId(),ActionType:1,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id},r=new v(u,1,4);return r.referencedObjectPath=t._objectPath,t._addAction(r,new fi(t),!0),r},t.createTraceAction=function(n,t,i){var r={Id:n._nextId(),ActionType:5,Name:"Trace",ObjectPathId:0},u=new v(r,1,4);return n._pendingRequest.addAction(u),i&&n._pendingRequest.addTrace(r.Id,t),u},t.createTraceMarkerForCallback=function(n,i){var r=t.createTraceAction(n,null,!1);n._pendingRequest.addActionResultHandler(r,new ti(i))},t}(g);n.ActionFactory=y;lt=function(n){function u(t,r){var u=n.call(this,t,r)||this;return i.checkArgumentNull(t,"context"),u.m_context=t,u._objectPath&&!t._processingResult&&t._pendingRequest&&(y.createInstantiateAction(t,u),t._autoCleanup&&u._KeepReference&&t.trackedObjects._autoAdd(u)),u}return __extends(u,n),Object.defineProperty(u.prototype,"context",{get:function(){return this.m_context},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"isNull",{get:function(){return i.throwIfNotLoaded("isNull",this._isNull,null,this._isNull),this._isNull},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"isNullObject",{get:function(){return i.throwIfNotLoaded("isNullObject",this._isNull,null,this._isNull),this._isNull},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_isNull",{get:function(){return this.m_isNull},set:function(n){this.m_isNull=n;n&&this._objectPath&&this._objectPath._updateAsNullObject()},enumerable:!0,configurable:!0}),u.prototype._addAction=function(n,i,r){return i===void 0&&(i=null),r||(this.context._pendingRequest.ensureInstantiateObjectPath(this._objectPath),this.context._pendingRequest.ensureInstantiateObjectPaths(n.referencedArgumentObjectPaths)),this.context._pendingRequest.addAction(n),this.context._pendingRequest.addReferencedObjectPath(this._objectPath),this.context._pendingRequest.addReferencedObjectPaths(n.referencedArgumentObjectPaths),this.context._pendingRequest.addActionResultHandler(n,i),t._createPromiseFromResult(null)},u.prototype._handleResult=function(n){this._isNull=i.isNullOrUndefined(n);this.context.trackedObjects._autoTrackIfNecessaryWhenHandleObjectResultValue(this,n)},u.prototype._handleIdResult=function(n){this._isNull=i.isNullOrUndefined(n);i.fixObjectPathIfNecessary(this,n);this.context.trackedObjects._autoTrackIfNecessaryWhenHandleObjectResultValue(this,n)},u.prototype._handleRetrieveResult=function(n,t){this._handleIdResult(n)},u.prototype._recursivelySet=function(n,e,s,h,c){var y=n instanceof u,k=n,l,b,v,a,w;if(y)if(Object.getPrototypeOf(this)===Object.getPrototypeOf(n))n=JSON.parse(JSON.stringify(n));else throw r.RuntimeError._createInvalidArgError({argumentName:"properties",errorLocation:this._className+".set"});try{for(a=0;a<s.length;a++)l=s[a],n.hasOwnProperty(l)&&typeof n[l]!="undefined"&&(this[l]=n[l]);for(a=0;a<h.length;a++)l=h[a],n.hasOwnProperty(l)&&typeof n[l]!="undefined"&&(b=y?k[l]:n[l],this[l].set(b,e));for(v=!y,e&&!i.isNullOrUndefined(v)&&(v=e.throwOnReadOnly),a=0;a<c.length;a++)if(l=c[a],n.hasOwnProperty(l)&&typeof n[l]!="undefined"&&v)throw new r.RuntimeError({code:f.invalidArgument,message:t._getResourceString(p.cannotApplyPropertyThroughSetMethod,l),debugInfo:{errorLocation:l}});for(l in n)if(s.indexOf(l)<0&&h.indexOf(l)<0){if(w=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),l),!w)throw new r.RuntimeError({code:f.invalidArgument,message:t._getResourceString(tt.propertyDoesNotExist,l),debugInfo:{errorLocation:l}});if(v&&!w.set)throw new r.RuntimeError({code:f.invalidArgument,message:t._getResourceString(tt.attemptingToSetReadOnlyProperty,l),debugInfo:{errorLocation:l}});}}catch(d){throw new r.RuntimeError({code:f.invalidArgument,message:t._getResourceString(o.invalidArgument,"properties"),debugInfo:{errorLocation:this._className+".set"},innerError:d});}},u}(rt);n.ClientObject=lt;var ci=function(){function n(n){this.m_session=n}return n.prototype.executeAsync=function(n,i,r){var f={url:a.processQuery,method:"POST",headers:r.Headers,body:r.Body},u={id:d.nextId(),type:1,flags:i,message:f};return t.log(JSON.stringify(u)),this.m_session.sendMessageToHost(u).then(function(n){var i,r,u;return t.log("Received response: "+JSON.stringify(n)),i=n.message,i.statusCode===200?r={ErrorCode:null,ErrorMessage:null,Headers:i.headers,Body:t._parseResponseBody(i)}:(t.log("Error Response:"+i.body),u=t._parseErrorResponse(i),r={ErrorCode:u.errorCode,ErrorMessage:u.errorMessage,Headers:i.headers,Body:null}),r})},n}(),ii=function(n){function i(t){var i=n.call(this)||this;return i.m_bridge=t,i.m_bridge.addHostMessageHandler(function(n){n.type===3&&w.getGenericEventRegistration()._handleRichApiMessage(n.message)}),i}return __extends(i,n),i.getInstanceIfHostBridgeInited=function(){return d.instance?((t.isNullOrUndefined(i.s_instance)||i.s_instance.m_bridge!==d.instance)&&(i.s_instance=new i(d.instance)),i.s_instance):null},i.prototype._resolveRequestUrlAndHeaderInfo=function(){return t._createPromiseFromResult(null)},i.prototype._createRequestExecutorOrNull=function(){return t.log("NativeBridgeSession::CreateRequestExecutor"),new ci(this)},Object.defineProperty(i.prototype,"eventRegistration",{get:function(){return w.getGenericEventRegistration()},enumerable:!0,configurable:!0}),i.prototype.sendMessageToHost=function(n){return this.m_bridge.sendMessageToHostAndExpectResponse(n)},i}(k),li=function(u){function s(n){var f=u.call(this)||this,o;if(f.m_customRequestHeaders={},f.m_batchMode=0,f._onRunFinishedNotifiers=[],k._overrideSession)f.m_requestUrlAndHeaderInfoResolver=k._overrideSession;else if((i.isNullOrUndefined(n)||typeof n=="string"&&n.length===0)&&(n=s.defaultRequestUrlAndHeaders,n||(n={url:a.localDocument,headers:{}})),typeof n=="string")f.m_requestUrlAndHeaderInfo={url:n,headers:{}};else if(s.isRequestUrlAndHeaderInfoResolver(n))f.m_requestUrlAndHeaderInfoResolver=n;else if(s.isRequestUrlAndHeaderInfo(n))o=n,f.m_requestUrlAndHeaderInfo={url:o.url,headers:{}},t._copyHeaders(o.headers,f.m_requestUrlAndHeaderInfo.headers);else throw r.RuntimeError._createInvalidArgError({argumentName:"url"});return!f.m_requestUrlAndHeaderInfoResolver&&f.m_requestUrlAndHeaderInfo&&t._isLocalDocumentUrl(f.m_requestUrlAndHeaderInfo.url)&&ii.getInstanceIfHostBridgeInited()&&(f.m_requestUrlAndHeaderInfo=null,f.m_requestUrlAndHeaderInfoResolver=ii.getInstanceIfHostBridgeInited()),f.m_requestUrlAndHeaderInfoResolver instanceof k&&(f.m_session=f.m_requestUrlAndHeaderInfoResolver),f._processingResult=!1,f._customData=e.iterativeExecutor,f.sync=f.sync.bind(f),f}return __extends(s,u),Object.defineProperty(s.prototype,"session",{get:function(){return this.m_session},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"eventRegistration",{get:function(){return this.m_session?this.m_session.eventRegistration:r.officeJsEventRegistration},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"_url",{get:function(){return this.m_requestUrlAndHeaderInfo?this.m_requestUrlAndHeaderInfo.url:null},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"_pendingRequest",{get:function(){return this.m_pendingRequest==null&&(this.m_pendingRequest=new it(this)),this.m_pendingRequest},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"debugInfo",{get:function(){var t=new yt(this._rootObjectPropertyName,this._pendingRequest._objectPaths,this._pendingRequest._actions,n._internalConfig.showDisposeInfoInDebugInfo),i=t.process();return{pendingStatements:i}},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"trackedObjects",{get:function(){return this.m_trackedObjects||(this.m_trackedObjects=new bt(this)),this.m_trackedObjects},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"requestHeaders",{get:function(){return this.m_customRequestHeaders},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"batchMode",{get:function(){return this.m_batchMode},enumerable:!0,configurable:!0}),s.prototype.ensureInProgressBatchIfBatchMode=function(){if(this.m_batchMode===1&&!this.m_explicitBatchInProgress)throw i.createRuntimeError(f.generalException,t._getResourceString(p.notInsideBatch),null);},s.prototype.load=function(n,t){i.validateContext(this,n);var r=s._parseQueryOption(t);g.createQueryAction(this,n,r,n)},s.prototype.loadRecursive=function(n,t,u){var f,e,o;if(!i.isPlainJsonObject(t))throw r.RuntimeError._createInvalidArgError({argumentName:"options"});f={};for(e in t)f[e]=s._parseQueryOption(t[e]);o=y.createRecursiveQueryAction(this,n,{Queries:f,MaxDepth:u});this._pendingRequest.addActionResultHandler(o,n)},s.prototype.trace=function(n){y.createTraceAction(this,n,!0)},s.prototype._processOfficeJsErrorResponse=function(n,t){},s.prototype.ensureRequestUrlAndHeaderInfo=function(){var n=this;return i._createPromiseFromResult(null).then(function(){if(!n.m_requestUrlAndHeaderInfo)return n.m_requestUrlAndHeaderInfoResolver._resolveRequestUrlAndHeaderInfo().then(function(t){if(n.m_requestUrlAndHeaderInfo=t,n.m_requestUrlAndHeaderInfo||(n.m_requestUrlAndHeaderInfo={url:a.localDocument,headers:{}}),i.isNullOrEmptyString(n.m_requestUrlAndHeaderInfo.url)&&(n.m_requestUrlAndHeaderInfo.url=a.localDocument),n.m_requestUrlAndHeaderInfo.headers||(n.m_requestUrlAndHeaderInfo.headers={}),typeof n.m_requestUrlAndHeaderInfoResolver._createRequestExecutorOrNull=="function"){var r=n.m_requestUrlAndHeaderInfoResolver._createRequestExecutorOrNull();r&&(n._requestExecutor=r)}})})},s.prototype.syncPrivateMain=function(){var n=this;return this.ensureRequestUrlAndHeaderInfo().then(function(){var t=n._pendingRequest;return n.m_pendingRequest=null,n.processPreSyncPromises(t).then(function(){return n.syncPrivate(t)})})},s.prototype.syncPrivate=function(n){var o=this,c,e,l,f,u;if(!n.hasActions)return this.processPendingEventHandlers(n);var h=n.buildRequestMessageBodyAndRequestFlags(),a=h.body,s=h.flags;return this._requestFlagModifier&&(s|=this._requestFlagModifier),this._requestExecutor||(this._requestExecutor=t._isLocalDocumentUrl(this.m_requestUrlAndHeaderInfo.url)?new ei(this):new ct),c=this._requestExecutor,e={},t._copyHeaders(this.m_requestUrlAndHeaderInfo.headers,e),t._copyHeaders(this.m_customRequestHeaders,e),l={Url:this.m_requestUrlAndHeaderInfo.url,Headers:e,Body:a},n.invalidatePendingInvalidObjectPaths(),f=null,u=null,this._lastSyncStart=typeof performance=="undefined"?0:performance.now(),this._lastRequestFlags=s,c.executeAsync(this._customData,s,l).then(function(i){return o._lastSyncEnd=typeof performance=="undefined"?0:performance.now(),f=o.processRequestExecutorResponseMessage(n,i),o.processPendingEventHandlers(n).catch(function(n){t.log("Error in processPendingEventHandlers");t.log(JSON.stringify(n));u=n})}).then(function(){var e,o;if(f){t.log("Throw error from response: "+JSON.stringify(f));throw f;}if(u){t.log("Throw error from ProcessEventHandler: "+JSON.stringify(u));e=null;u instanceof r.RuntimeError?(e=u,e.traceMessages=n._responseTraceMessages):(o=null,o=typeof u=="string"?u:u.message,i.isNullOrEmptyString(o)&&(o=t._getResourceString(p.cannotRegisterEvent)),e=new r.RuntimeError({code:ft.cannotRegisterEvent,message:o,traceMessages:n._responseTraceMessages}));throw e;}})},s.prototype.processRequestExecutorResponseMessage=function(t,u){var h,f,s,c,e,o;if(u.Body&&u.Body.TraceIds&&t._setResponseTraceIds(u.Body.TraceIds),h=t._responseTraceMessages,f=null,u.Body&&(u.Body.Error&&u.Body.Error.ActionIndex>=0&&(s=new yt(this._rootObjectPropertyName,t._objectPaths,t._actions,!1,!0),c=s.processForDebugStatementInfo(u.Body.Error.ActionIndex),f={statement:c.statement,surroundingStatements:c.surroundingStatements,fullStatements:["Please enable config.extendedErrorLogging to see full statements."]},n.config.extendedErrorLogging&&(s=new yt(this._rootObjectPropertyName,t._objectPaths,t._actions,!1,!1),f.fullStatements=s.process())),e=null,u.Body.Results?e=u.Body.Results:u.Body.ProcessedResults&&u.Body.ProcessedResults.Results&&(e=u.Body.ProcessedResults.Results),e)){this._processingResult=!0;try{t.processResponse(e)}finally{this._processingResult=!1}}if(i.isNullOrEmptyString(u.ErrorCode)){if(u.Body&&u.Body.Error)return o={errorLocation:u.Body.Error.Location},f&&(o.statement=f.statement,o.surroundingStatements=f.surroundingStatements,o.fullStatements=f.fullStatements),new r.RuntimeError({code:u.Body.Error.Code,message:u.Body.Error.Message,traceMessages:h,debugInfo:o})}else return new r.RuntimeError({code:u.ErrorCode,message:u.ErrorMessage,traceMessages:h});return null},s.prototype.processPendingEventHandlers=function(n){for(var u,t=i._createPromiseFromResult(null),r=0;r<n._pendingProcessEventHandlers.length;r++)u=n._pendingProcessEventHandlers[r],t=t.then(this.createProcessOneEventHandlersFunc(u,n));return t},s.prototype.createProcessOneEventHandlersFunc=function(n,t){return function(){return n._processRegistration(t)}},s.prototype.processPreSyncPromises=function(n){for(var u,t=i._createPromiseFromResult(null),r=0;r<n._preSyncPromises.length;r++)u=n._preSyncPromises[r],t=t.then(this.createProcessOneProSyncFunc(u));return t},s.prototype.createProcessOneProSyncFunc=function(n){return function(){return n}},s.prototype.sync=function(n){return this.syncPrivateMain().then(function(){return n})},s.prototype.batch=function(n){var r=this,e,u,o,s;if(this.m_batchMode!==1)return t._createPromiseFromException(i.createRuntimeError(f.generalException,null,null));if(this.m_explicitBatchInProgress)return t._createPromiseFromException(i.createRuntimeError(f.generalException,t._getResourceString(p.pendingBatchInProgress),null));if(i.isNullOrUndefined(n))return i._createPromiseFromResult(null);this.m_explicitBatchInProgress=!0;e=this.m_pendingRequest;this.m_pendingRequest=new it(this);try{u=n(this._rootObject,this)}catch(h){return this.m_explicitBatchInProgress=!1,this.m_pendingRequest=e,t._createPromiseFromException(h)}return typeof u=="object"&&u&&typeof u.then=="function"?s=i._createPromiseFromResult(null).then(function(){return u}).then(function(n){return r.m_explicitBatchInProgress=!1,o=r.m_pendingRequest,r.m_pendingRequest=e,n}).catch(function(n){return r.m_explicitBatchInProgress=!1,o=r.m_pendingRequest,r.m_pendingRequest=e,t._createPromiseFromException(n)}):(this.m_explicitBatchInProgress=!1,o=this.m_pendingRequest,this.m_pendingRequest=e,s=i._createPromiseFromResult(u)),s.then(function(n){return r.ensureRequestUrlAndHeaderInfo().then(function(){return r.syncPrivate(o)}).then(function(){return n})})},s._run=function(n,t,i,r,u,f){return i===void 0&&(i=3),r===void 0&&(r=5e3),s._runCommon("run",null,n,0,t,i,r,null,u,f)},s.isValidRequestInfo=function(n){return typeof n=="string"||s.isRequestUrlAndHeaderInfo(n)||s.isRequestUrlAndHeaderInfoResolver(n)},s.isRequestUrlAndHeaderInfo=function(n){return typeof n=="object"&&n!==null&&Object.getPrototypeOf(n)===Object.getPrototypeOf({})&&!i.isNullOrUndefined(n.url)},s.isRequestUrlAndHeaderInfoResolver=function(n){return typeof n=="object"&&n!==null&&typeof n._resolveRequestUrlAndHeaderInfo=="function"},s._runBatch=function(n,t,i,r,u,f,e,o){return u===void 0&&(u=3),f===void 0&&(f=5e3),s._runBatchCommon(0,n,t,i,u,f,r,e,o)},s._runExplicitBatch=function(n,t,i,r,u,f,e,o){return u===void 0&&(u=3),f===void 0&&(f=5e3),s._runBatchCommon(1,n,t,i,u,f,r,e,o)},s._runBatchCommon=function(n,t,r,u,f,e,o,h,c){var v,k,g;f===void 0&&(f=3);e===void 0&&(e=5e3);var y,d,w=null,l=null,a=0,b=null;if(r.length>0)if(s.isValidRequestInfo(r[0]))w=r[0],a=1;else if(i.isPlainJsonObject(r[0])){if(b=r[0],w=b.session,w!=null&&!s.isValidRequestInfo(w))return s.createErrorPromise(t);l=b.previousObjects;a=1}if(r.length==a+1)d=r[a+0];else if(b==null&&r.length==a+2)l=r[a+0],d=r[a+1];else return s.createErrorPromise(t);if(l!=null)if(l instanceof lt)y=function(){return l.context};else if(l instanceof s)y=function(){return l};else if(Array.isArray(l)){if(v=l,v.length==0)return s.createErrorPromise(t);for(k=0;k<v.length;k++){if(!(v[k]instanceof lt))return s.createErrorPromise(t);if(v[k].context!=v[0].context)return s.createErrorPromise(t,p.invalidRequestContext)}y=function(){return v[0].context}}else return s.createErrorPromise(t);else y=u;return g=null,o&&(g=function(n){return o(b||{},n)}),s._runCommon(t,w,y,n,d,f,e,g,h,c)},s.createErrorPromise=function(n,r){return r===void 0&&(r=o.invalidArgument),t._createPromiseFromException(i.createRuntimeError(r,t._getResourceString(r),n))},s._runCommon=function(r,u,f,e,o,h,c,l,a,v){k._overrideSession&&(u=k._overrideSession);var g=t.createPromise(function(n,t){n()}),y,b=!1,w,d;return g.then(function(){if(y=f(u),y._autoCleanup)return new n.Promise(function(n,t){y._onRunFinishedNotifiers.push(function(){y._autoCleanup=!0;n()})});else y._autoCleanup=!0}).then(function(){if(typeof o!="function")return s.createErrorPromise(r);d=y.m_batchMode;y.m_batchMode=e;l&&l(y);var n;return n=e==1?o(y.batch.bind(y)):o(y),(i.isNullOrUndefined(n)||typeof n.then!="function")&&i.throwError(p.runMustReturnPromise),n}).then(function(n){return e===1?n:y.sync(n)}).then(function(n){b=!0;w=n}).catch(function(n){w=n}).then(function(){function r(){var u;n++;var f=y.m_pendingRequest,e=y.m_batchMode,i=new it(y);y.m_pendingRequest=i;y.m_batchMode=0;try{for(u in t)y.trackedObjects.remove(t[u])}finally{y.m_batchMode=e;y.m_pendingRequest=f}return y.syncPrivate(i).then(function(){a&&a(n)}).catch(function(){v&&v(n);n<h&&setTimeout(function(){r()},c)})}var t=y.trackedObjects._retrieveAndClearAutoCleanupList(),f,n;y._autoCleanup=!1;y.m_batchMode=d;for(f in t)t[f]._objectPath.isValid=!1;if(n=0,i._synchronousCleanup||s.isRequestUrlAndHeaderInfoResolver(u))return r();else r()}).then(function(){if(y._onRunFinishedNotifiers&&y._onRunFinishedNotifiers.length>0){var n=y._onRunFinishedNotifiers.shift();n()}if(b)return w;else throw w;})},s}(ot);n.ClientRequestContext=li;ri=function(){function n(n,t){var r;this.m_proxy=n;this.m_shouldPolyfill=t;var u=n[e.scalarPropertyNames],f=n[e.navigationPropertyNames],o=n[e.className],s=n[e.isCollection];if(u)for(r=0;r<u.length;r++)i.definePropertyThrowUnloadedException(this,o,u[r]);if(f)for(r=0;r<f.length;r++)i.definePropertyThrowUnloadedException(this,o,f[r]);s&&i.definePropertyThrowUnloadedException(this,o,e.itemsLowerCase)}return Object.defineProperty(n.prototype,"$proxy",{get:function(){return this.m_proxy},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"$isNullObject",{get:function(){if(!this.m_isLoaded)throw new r.RuntimeError({code:ft.valueNotLoaded,message:t._getResourceString(p.valueNotLoaded),debugInfo:{errorLocation:"retrieveResult.$isNullObject"}});return this.m_isNullObject},enumerable:!0,configurable:!0}),n.prototype.toJSON=function(){return this.m_isLoaded?this.m_isNullObject?null:(i.isUndefined(this.m_json)&&(this.m_json=i.purifyJson(this.m_value)),this.m_json):undefined},n.prototype.toString=function(){return JSON.stringify(this.toJSON())},n.prototype._handleResult=function(n){this.m_isLoaded=!0;n===null||typeof n=="object"&&n&&n._IsNull?(this.m_isNullObject=!0,n=null):this.m_isNullObject=!1;this.m_shouldPolyfill&&(n=i.changePropertyNameToCamelLowerCase(n));this.m_value=n;this.m_proxy._handleRetrieveResult(n,this)},n}();e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.getItemAt="GetItemAt",t.index="_Index",t.iterativeExecutor="IterativeExecutor",t.isTracked="_IsTracked",t.eventMessageCategory=65536,t.eventWorkbookId="Workbook",t.eventSourceRemote="Remote",t.proxy="$proxy",t.className="_className",t.isCollection="_isCollection",t.collectionPropertyPath="_collectionPropertyPath",t.objectPathInfoDoNotKeepReferenceFieldName="D",t}(s);n.Constants=e;it=function(n){function i(t){var i=n.call(this,t)||this;return i.m_context=t,i.m_pendingProcessEventHandlers=[],i.m_pendingEventHandlerActions={},i.m_traceInfos={},i.m_responseTraceIds={},i.m_responseTraceMessages=[],i}return __extends(i,n),Object.defineProperty(i.prototype,"traceInfos",{get:function(){return this.m_traceInfos},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_responseTraceMessages",{get:function(){return this.m_responseTraceMessages},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_responseTraceIds",{get:function(){return this.m_responseTraceIds},enumerable:!0,configurable:!0}),i.prototype._setResponseTraceIds=function(n){var i,r,u;if(n)for(i=0;i<n.length;i++)r=n[i],this.m_responseTraceIds[r]=r,u=this.m_traceInfos[r],t.isNullOrUndefined(u)||this.m_responseTraceMessages.push(u)},i.prototype.addTrace=function(n,t){this.m_traceInfos[n]=t},i.prototype._addPendingEventHandlerAction=function(n,t){this.m_pendingEventHandlerActions[n._id]||(this.m_pendingEventHandlerActions[n._id]=[],this.m_pendingProcessEventHandlers.push(n));this.m_pendingEventHandlerActions[n._id].push(t)},Object.defineProperty(i.prototype,"_pendingProcessEventHandlers",{get:function(){return this.m_pendingProcessEventHandlers},enumerable:!0,configurable:!0}),i.prototype._getPendingEventHandlerActions=function(n){return this.m_pendingEventHandlerActions[n._id]},i}(ht);n.ClientRequest=it;wt=function(){function n(n,t,i,r){var u=this;this.m_id=n._nextId();this.m_context=n;this.m_name=i;this.m_handlers=[];this.m_registered=!1;this.m_eventInfo=r;this.m_callback=function(n){u.m_eventInfo.eventArgsTransformFunc(n).then(function(n){return u.fireEvent(n)})}}return Object.defineProperty(n.prototype,"_registered",{get:function(){return this.m_registered},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_id",{get:function(){return this.m_id},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_handlers",{get:function(){return this.m_handlers},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_context",{get:function(){return this.m_context},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_callback",{get:function(){return this.m_callback},enumerable:!0,configurable:!0}),n.prototype.add=function(n){var t=y.createTraceAction(this.m_context,null,!1);return this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:t.actionInfo.Id,handler:n,operation:0}),new at(this.m_context,this,n)},n.prototype.remove=function(n){var t=y.createTraceAction(this.m_context,null,!1);this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:t.actionInfo.Id,handler:n,operation:1})},n.prototype.removeAll=function(){var n=y.createTraceAction(this.m_context,null,!1);this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:n.actionInfo.Id,handler:null,operation:2})},n.prototype._processRegistration=function(n){var f=this,u=t._createPromiseFromResult(null),e=n._getPendingEventHandlerActions(this),r,s,i,o;if(!e)return u;for(r=[],i=0;i<this.m_handlers.length;i++)r.push(this.m_handlers[i]);for(s=!1,i=0;i<e.length;i++)if(n._responseTraceIds[e[i].id]){s=!0;switch(e[i].operation){case 0:r.push(e[i].handler);break;case 1:for(o=r.length-1;o>=0;o--)if(r[o]===e[i].handler){r.splice(o,1);break}break;case 2:r=[];break}}return s&&(!this.m_registered&&r.length>0?u=u.then(function(){return f.m_eventInfo.registerFunc(f.m_callback)}).then(function(){return f.m_registered=!0}):this.m_registered&&r.length==0&&(u=u.then(function(){return f.m_eventInfo.unregisterFunc(f.m_callback)}).catch(function(n){t.log("Error when unregister event: "+JSON.stringify(n))}).then(function(){return f.m_registered=!1})),u=u.then(function(){return f.m_handlers=r})),u},n.prototype.fireEvent=function(n){for(var u,f,r=[],i=0;i<this.m_handlers.length;i++)u=this.m_handlers[i],f=t._createPromiseFromResult(null).then(this.createFireOneEventHandlerFunc(u,n)).catch(function(n){t.log("Error when invoke handler: "+JSON.stringify(n))}),r.push(f);t.Promise.all(r)},n.prototype.createFireOneEventHandlerFunc=function(n,t){return function(){return n(t)}},n}();n.EventHandlers=wt;at=function(){function n(n,t,i){this.m_context=n;this.m_allHandlers=t;this.m_handler=i}return Object.defineProperty(n.prototype,"context",{get:function(){return this.m_context},enumerable:!0,configurable:!0}),n.prototype.remove=function(){this.m_allHandlers&&this.m_handler&&(this.m_allHandlers.remove(this.m_handler),this.m_allHandlers=null,this.m_handler=null)},n}();n.EventHandlerResult=at,function(n){var t=function(){function t(){}return t.prototype.register=function(t,r,u){switch(t){case 4:return i.promisify(function(n){return Office.context.document.bindings.getByIdAsync(r,n)}).then(function(n){return i.promisify(function(t){return n.addHandlerAsync(Office.EventType.BindingDataChanged,u,t)})});case 3:return i.promisify(function(n){return Office.context.document.bindings.getByIdAsync(r,n)}).then(function(n){return i.promisify(function(t){return n.addHandlerAsync(Office.EventType.BindingSelectionChanged,u,t)})});case 2:return i.promisify(function(n){return Office.context.document.addHandlerAsync(Office.EventType.DocumentSelectionChanged,u,n)});case 1:return i.promisify(function(n){return Office.context.document.settings.addHandlerAsync(Office.EventType.SettingsChanged,u,n)});case 5:return i.promisify(function(n){return OSF.DDA.RichApi.richApiMessageManager.addHandlerAsync("richApiMessage",u,n)});case 13:return i.promisify(function(n){return Office.context.document.addHandlerAsync(Office.EventType.ObjectDeleted,u,{id:r},n)});case 14:return i.promisify(function(n){return Office.context.document.addHandlerAsync(Office.EventType.ObjectSelectionChanged,u,{id:r},n)});case 15:return i.promisify(function(n){return Office.context.document.addHandlerAsync(Office.EventType.ObjectDataChanged,u,{id:r},n)});case 16:return i.promisify(function(n){return Office.context.document.addHandlerAsync(Office.EventType.ContentControlAdded,u,{id:r},n)});default:throw n.RuntimeError._createInvalidArgError({argumentName:"eventId"});}},t.prototype.unregister=function(t,r,u){switch(t){case 4:return i.promisify(function(n){return Office.context.document.bindings.getByIdAsync(r,n)}).then(function(n){return i.promisify(function(t){return n.removeHandlerAsync(Office.EventType.BindingDataChanged,{handler:u},t)})});case 3:return i.promisify(function(n){return Office.context.document.bindings.getByIdAsync(r,n)}).then(function(n){return i.promisify(function(t){return n.removeHandlerAsync(Office.EventType.BindingSelectionChanged,{handler:u},t)})});case 2:return i.promisify(function(n){return Office.context.document.removeHandlerAsync(Office.EventType.DocumentSelectionChanged,{handler:u},n)});case 1:return i.promisify(function(n){return Office.context.document.settings.removeHandlerAsync(Office.EventType.SettingsChanged,{handler:u},n)});case 5:return i.promisify(function(n){return OSF.DDA.RichApi.richApiMessageManager.removeHandlerAsync("richApiMessage",{handler:u},n)});case 13:return i.promisify(function(n){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectDeleted,{id:r,handler:u},n)});case 14:return i.promisify(function(n){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectSelectionChanged,{id:r,handler:u},n)});case 15:return i.promisify(function(n){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectDataChanged,{id:r,handler:u},n)});case 16:return i.promisify(function(n){return Office.context.document.removeHandlerAsync(Office.EventType.ContentControlAdded,{id:r,handler:u},n)});default:throw n.RuntimeError._createInvalidArgError({argumentName:"eventId"});}},t}();n.officeJsEventRegistration=new t}(r=n._Internal||(n._Internal={}));vt=function(){function n(n,t){this.m_handlersByEventByTarget={};this.m_registerEventImpl=n;this.m_unregisterEventImpl=t}return n.prototype.getHandlers=function(n,t){var r,u;return i.isNullOrUndefined(t)&&(t=""),r=this.m_handlersByEventByTarget[n],r||(r={},this.m_handlersByEventByTarget[n]=r),u=r[t],u||(u=[],r[t]=u),u},n.prototype.register=function(n,t,u){if(!u)throw r.RuntimeError._createInvalidArgError({argumentName:"handler"});var f=this.getHandlers(n,t);return(f.push(u),f.length===1)?this.m_registerEventImpl(n,t):i._createPromiseFromResult(null)},n.prototype.unregister=function(n,t,u){var f,e;if(!u)throw r.RuntimeError._createInvalidArgError({argumentName:"handler"});for(f=this.getHandlers(n,t),e=f.length-1;e>=0;e--)if(f[e]===u){f.splice(e,1);break}return f.length===0?this.m_unregisterEventImpl(n,t):i._createPromiseFromResult(null)},n}();n.EventRegistration=vt;w=function(){function n(){this.m_eventRegistration=new vt(this._registerEventImpl.bind(this),this._unregisterEventImpl.bind(this));this.m_richApiMessageHandler=this._handleRichApiMessage.bind(this)}return n.prototype.ready=function(){var t=this;return this.m_ready||(this.m_ready=n._testReadyImpl?n._testReadyImpl().then(function(){t.m_isReady=!0}):d.instance?i._createPromiseFromResult(null).then(function(){t.m_isReady=!0}):r.officeJsEventRegistration.register(5,"",this.m_richApiMessageHandler).then(function(){t.m_isReady=!0})),this.m_ready},Object.defineProperty(n.prototype,"isReady",{get:function(){return this.m_isReady},enumerable:!0,configurable:!0}),n.prototype.register=function(n,t,i){var r=this;return this.ready().then(function(){return r.m_eventRegistration.register(n,t,i)})},n.prototype.unregister=function(n,t,i){var r=this;return this.ready().then(function(){return r.m_eventRegistration.unregister(n,t,i)})},n.prototype._registerEventImpl=function(n,t){return i._createPromiseFromResult(null)},n.prototype._unregisterEventImpl=function(n,t){return i._createPromiseFromResult(null)},n.prototype._handleRichApiMessage=function(n){var r,i,u,o,f;if(n&&n.entries)for(r=0;r<n.entries.length;r++)if(i=n.entries[r],i.messageCategory==e.eventMessageCategory&&(t._logEnabled&&t.log(JSON.stringify(i)),u=this.m_eventRegistration.getHandlers(i.messageType,i.targetId),u.length>0))for(o=JSON.parse(i.message),i.isRemoteOverride&&(o.source=e.eventSourceRemote),f=0;f<u.length;f++)u[f](o)},n.getGenericEventRegistration=function(){return n.s_genericEventRegistration||(n.s_genericEventRegistration=new n),n.s_genericEventRegistration},n.richApiMessageEventCategory=65536,n}();n._testSetRichApiMessageReadyImpl=ai;n._testTriggerRichApiMessageEvent=vi;ui=function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return f.m_genericEventInfo=u,f}return __extends(t,n),t.prototype.add=function(n){var t=this;return this._handlers.length==0&&this.m_genericEventInfo.registerFunc&&this.m_genericEventInfo.registerFunc(),w.getGenericEventRegistration().isReady||this._context._pendingRequest._addPreSyncPromise(w.getGenericEventRegistration().ready()),y.createTraceMarkerForCallback(this._context,function(){t._handlers.push(n);t._handlers.length==1&&w.getGenericEventRegistration().register(t.m_genericEventInfo.eventType,t.m_genericEventInfo.getTargetIdFunc(),t._callback)}),new at(this._context,this,n)},t.prototype.remove=function(n){var t=this;this._handlers.length==1&&this.m_genericEventInfo.unregisterFunc&&this.m_genericEventInfo.unregisterFunc();y.createTraceMarkerForCallback(this._context,function(){for(var i=t._handlers,r=i.length-1;r>=0;r--)if(i[r]===n){i.splice(r,1);break}i.length==0&&w.getGenericEventRegistration().unregister(t.m_genericEventInfo.eventType,t.m_genericEventInfo.getTargetIdFunc(),t._callback)})},t.prototype.removeAll=function(){},t}(wt);n.GenericEventHandlers=ui;fi=function(){function n(n){this.m_clientObject=n}return n.prototype._handleResult=function(n){this.m_clientObject._handleIdResult(n)},n}();b=function(){function n(){}return n.createGlobalObjectObjectPath=function(n){var t={Id:n._nextId(),ObjectPathType:1,Name:""};return new l(t,null,!1,!1,1,4)},n.createNewObjectObjectPath=function(n,t,r,u){var f={Id:n._nextId(),ObjectPathType:2,Name:t};return new l(f,null,r,!1,1,i._fixupApiFlags(u))},n.createPropertyObjectPath=function(n,t,r,u,f,e){var o={Id:n._nextId(),ObjectPathType:4,Name:r,ParentObjectPathId:t._objectPath.objectPathInfo.Id};return new l(o,t._objectPath,u,f,1,i._fixupApiFlags(e))},n.createIndexerObjectPath=function(n,t,i){var r={Id:n._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}};return r.ArgumentInfo.Arguments=i,new l(r,t._objectPath,!1,!1,1,4)},n.createIndexerObjectPathUsingParentPath=function(n,t,i){var r={Id:n._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:t.objectPathInfo.Id,ArgumentInfo:{}};return r.ArgumentInfo.Arguments=i,new l(r,t,!1,!1,1,4)},n.createMethodObjectPath=function(n,t,r,u,f,e,o,s,h){var a={Id:n._nextId(),ObjectPathType:3,Name:r,ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},v=i.setMethodArguments(n,a.ArgumentInfo,f),c=new l(a,t._objectPath,e,o,u,i._fixupApiFlags(h));return c.argumentObjectPaths=v,c.getByIdMethodName=s,c},n.createReferenceIdObjectPath=function(n,t){var i={Id:n._nextId(),ObjectPathType:6,Name:t,ArgumentInfo:{}};return new l(i,null,!1,!1,1,4)},n.createChildItemObjectPathUsingIndexerOrGetItemAt=function(t,r,u,f,e){var o=i.tryGetObjectIdFromLoadOrRetrieveResult(f);return t&&!i.isNullOrUndefined(o)?n.createChildItemObjectPathUsingIndexer(r,u,f):n.createChildItemObjectPathUsingGetItemAt(r,u,f,e)},n.createChildItemObjectPathUsingIndexer=function(n,t,r){var f=i.tryGetObjectIdFromLoadOrRetrieveResult(r),u=u={Id:n._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}};return u.ArgumentInfo.Arguments=[f],new l(u,t._objectPath,!1,!1,1,4)},n.createChildItemObjectPathUsingGetItemAt=function(n,t,i,r){var f=i[e.index],u;return f&&(r=f),u={Id:n._nextId(),ObjectPathType:3,Name:e.getItemAt,ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},u.ArgumentInfo.Arguments=[r],new l(u,t._objectPath,!1,!1,1,4)},n}();n.ObjectPathFactory=b;ei=function(){function i(n){this.m_context=n}return i.prototype.executeAsync=function(r,u,f){var e=this,o=c.buildMessageArrayForIRequestExecutor(r,u,f,i.SourceLibHeaderValue);return new n.Promise(function(n,i){OSF.DDA.RichApi.executeRichApiRequestAsync(o,function(i){t.log("Response:");t.log(JSON.stringify(i));var r;i.status=="succeeded"?r=c.buildResponseOnSuccess(c.getResponseBody(i),c.getResponseHeaders(i)):(r=c.buildResponseOnError(i.error.code,i.error.message),e.m_context._processOfficeJsErrorResponse(i.error.code,r));n(r)})})},i.SourceLibHeaderValue="officejs",i}();bt=function(){function n(n){this._autoCleanupList={};this.m_context=n}return n.prototype.add=function(n){var t=this;Array.isArray(n)?n.forEach(function(n){return t._addCommon(n,!0)}):this._addCommon(n,!0)},n.prototype._autoAdd=function(n){this._addCommon(n,!1);this._autoCleanupList[n._objectPath.objectPathInfo.Id]=n},n.prototype._autoTrackIfNecessaryWhenHandleObjectResultValue=function(n,t){var r=this.m_context._autoCleanup&&!n[e.isTracked]&&n!==this.m_context._rootObject&&t&&!i.isNullOrEmptyString(t[e.referenceId]);r&&(this._autoCleanupList[n._objectPath.objectPathInfo.Id]=n,n[e.isTracked]=!0)},n.prototype._addCommon=function(n,r){if(n[e.isTracked]){r&&this.m_context._autoCleanup&&delete this._autoCleanupList[n._objectPath.objectPathInfo.Id];return}var u=n[e.referenceId],o=n._objectPath.objectPathInfo[e.objectPathInfoDoNotKeepReferenceFieldName];if(o)throw i.createRuntimeError(f.generalException,t._getResourceString(p.objectIsUntracked),null);i.isNullOrEmptyString(u)&&n._KeepReference&&(n._KeepReference(),y.createInstantiateAction(this.m_context,n),r&&this.m_context._autoCleanup&&delete this._autoCleanupList[n._objectPath.objectPathInfo.Id],n[e.isTracked]=!0)},n.prototype.remove=function(n){var t=this;Array.isArray(n)?n.forEach(function(n){return t._removeCommon(n)}):this._removeCommon(n)},n.prototype._removeCommon=function(n){var t,r;n._objectPath.objectPathInfo[e.objectPathInfoDoNotKeepReferenceFieldName]=!0;n.context._pendingRequest._removeKeepReferenceAction(n._objectPath.objectPathInfo.Id);t=n[e.referenceId];i.isNullOrEmptyString(t)||(r=this.m_context._rootObject,r._RemoveReference&&r._RemoveReference(t));delete n[e.isTracked]},n.prototype._retrieveAndClearAutoCleanupList=function(){var n=this._autoCleanupList;return this._autoCleanupList={},n},n}();n.TrackedObjects=bt;yt=function(){function t(n,t,i,r,u){n||(n="root");this.m_globalObjName=n;this.m_referencedObjectPaths=t;this.m_actions=i;this.m_statements=[];this.m_variableNameForObjectPathMap={};this.m_variableNameToObjectPathMap={};this.m_declaredObjectPathMap={};this.m_showDispose=r;this.m_removePII=u}return t.prototype.process=function(){this.m_showDispose&&it._calculateLastUsedObjectPathIds(this.m_actions);for(var n=0;n<this.m_actions.length;n++)this.processOneAction(this.m_actions[n]);return this.m_statements},t.prototype.processForDebugStatementInfo=function(n){var e,h,t,r,u,f,i,o,s;for(this.m_showDispose&&it._calculateLastUsedObjectPathIds(this.m_actions),e=5,this.m_statements=[],h="",t=-1,r=0;r<this.m_actions.length;r++)if(this.processOneAction(this.m_actions[r]),n==r&&(t=this.m_statements.length-1),t>=0&&this.m_statements.length>t+e+1)break;if(t<0)return null;for(u=t-e,u<0&&(u=0),f=t+1+e,f>this.m_statements.length&&(f=this.m_statements.length),i=[],u!=0&&i.push("..."),o=u;o<t;o++)i.push(this.m_statements[o]);for(i.push("// >>>>>"),i.push(this.m_statements[t]),i.push("// <<<<<"),s=t+1;s<f;s++)i.push(this.m_statements[s]);return f<this.m_statements.length&&i.push("..."),{statement:this.m_statements[t],surroundingStatements:i}},t.prototype.processOneAction=function(n){var t=n.actionInfo;switch(t.ActionType){case 1:this.processInstantiateAction(n);break;case 3:this.processMethodAction(n);break;case 2:this.processQueryAction(n);break;case 7:this.processQueryAsJsonAction(n);break;case 6:this.processRecursiveQueryAction(n);break;case 4:this.processSetPropertyAction(n);break;case 5:this.processTraceAction(n);break;case 8:this.processEnsureUnchangedAction(n);break;case 9:this.processUpdateAction(n);break}},t.prototype.processInstantiateAction=function(n){var i=n.actionInfo.ObjectPathId,u=this.m_referencedObjectPaths[i],r=this.getObjVarName(i),t;this.m_declaredObjectPathMap[i]?(t="// Instantiate {"+r+"}",t=this.appendDisposeCommentIfRelevant(t,n),this.m_statements.push(t)):(t="var "+r+"="+this.buildObjectPathExpressionWithParent(u)+";",t=this.appendDisposeCommentIfRelevant(t,n),this.m_statements.push(t),this.m_declaredObjectPathMap[i]=r)},t.prototype.processMethodAction=function(t){var u=t.actionInfo.Name,r;if(u==="_KeepReference"){if(!n._internalConfig.showInternalApiInDebugInfo)return;u="track"}r=this.getObjVarName(t.actionInfo.ObjectPathId)+"."+i._toCamelLowerCase(u)+"("+this.buildArgumentsExpression(t.actionInfo.ArgumentInfo)+");";r=this.appendDisposeCommentIfRelevant(r,t);this.m_statements.push(r)},t.prototype.processQueryAction=function(n){var i=this.buildQueryExpression(n),t=this.getObjVarName(n.actionInfo.ObjectPathId)+".load("+i+");";t=this.appendDisposeCommentIfRelevant(t,n);this.m_statements.push(t)},t.prototype.processQueryAsJsonAction=function(n){var i=this.buildQueryExpression(n),t=this.getObjVarName(n.actionInfo.ObjectPathId)+".retrieve("+i+");";t=this.appendDisposeCommentIfRelevant(t,n);this.m_statements.push(t)},t.prototype.processRecursiveQueryAction=function(n){var i="",t;n.actionInfo.RecursiveQueryInfo&&(i=JSON.stringify(n.actionInfo.RecursiveQueryInfo));t=this.getObjVarName(n.actionInfo.ObjectPathId)+".loadRecursive("+i+");";t=this.appendDisposeCommentIfRelevant(t,n);this.m_statements.push(t)},t.prototype.processSetPropertyAction=function(n){var t=this.getObjVarName(n.actionInfo.ObjectPathId)+"."+i._toCamelLowerCase(n.actionInfo.Name)+"="+this.buildArgumentsExpression(n.actionInfo.ArgumentInfo)+";";t=this.appendDisposeCommentIfRelevant(t,n);this.m_statements.push(t)},t.prototype.processTraceAction=function(n){var t="context.trace();";t=this.appendDisposeCommentIfRelevant(t,n);this.m_statements.push(t)},t.prototype.processEnsureUnchangedAction=function(n){var t=this.getObjVarName(n.actionInfo.ObjectPathId)+".ensureUnchanged("+JSON.stringify(n.actionInfo.ObjectState)+");";t=this.appendDisposeCommentIfRelevant(t,n);this.m_statements.push(t)},t.prototype.processUpdateAction=function(n){var t=this.getObjVarName(n.actionInfo.ObjectPathId)+".update("+JSON.stringify(n.actionInfo.ObjectState)+");";t=this.appendDisposeCommentIfRelevant(t,n);this.m_statements.push(t)},t.prototype.appendDisposeCommentIfRelevant=function(n,t){var u=this,i,r;return this.m_showDispose&&(i=t.actionInfo.L,i&&i.length>0)?(r=i.map(function(n){return u.getObjVarName(n)}).join(", "),n+" // And then dispose {"+r+"}"):n},t.prototype.buildQueryExpression=function(n){if(n.actionInfo.QueryInfo){var t={};return t.select=n.actionInfo.QueryInfo.Select,t.expand=n.actionInfo.QueryInfo.Expand,t.skip=n.actionInfo.QueryInfo.Skip,t.top=n.actionInfo.QueryInfo.Top,typeof t.top=="undefined"&&typeof t.skip=="undefined"&&typeof t.expand=="undefined"?typeof t.select=="undefined"?"":JSON.stringify(t.select):JSON.stringify(t)}return""},t.prototype.buildObjectPathExpressionWithParent=function(n){var t=n.objectPathInfo.ObjectPathType==5||n.objectPathInfo.ObjectPathType==3||n.objectPathInfo.ObjectPathType==4;return t&&n.objectPathInfo.ParentObjectPathId?this.getObjVarName(n.objectPathInfo.ParentObjectPathId)+"."+this.buildObjectPathExpression(n):this.buildObjectPathExpression(n)},t.prototype.buildObjectPathExpression=function(n){var t=this.buildObjectPathInfoExpression(n.objectPathInfo),i=n.originalObjectPathInfo;return i&&(t=t+" /* originally "+this.buildObjectPathInfoExpression(i)+" */"),t},t.prototype.buildObjectPathInfoExpression=function(n){switch(n.ObjectPathType){case 1:return"context."+this.m_globalObjName;case 5:return"getItem("+this.buildArgumentsExpression(n.ArgumentInfo)+")";case 3:return i._toCamelLowerCase(n.Name)+"("+this.buildArgumentsExpression(n.ArgumentInfo)+")";case 2:return n.Name+".newObject()";case 7:return"null";case 4:return i._toCamelLowerCase(n.Name);case 6:return"context."+this.m_globalObjName+"._getObjectByReferenceId("+JSON.stringify(n.Name)+")"}},t.prototype.buildArgumentsExpression=function(n){var t="",i;if(!n.Arguments||n.Arguments.length===0)return t;if(this.m_removePII)return typeof n.Arguments[0]=="undefined"?t:"...";for(i=0;i<n.Arguments.length;i++)i>0&&(t=t+", "),t=t+this.buildArgumentLiteral(n.Arguments[i],n.ReferencedObjectPathIds?n.ReferencedObjectPathIds[i]:null);return t==="undefined"&&(t=""),t},t.prototype.buildArgumentLiteral=function(n,t){return typeof n=="number"&&n===t?this.getObjVarName(t):JSON.stringify(n)},t.prototype.getObjVarNameBase=function(n){var u="v",f=this.m_referencedObjectPaths[n],t,r;if(f)switch(f.objectPathInfo.ObjectPathType){case 1:u=this.m_globalObjName;break;case 4:u=i._toCamelLowerCase(f.objectPathInfo.Name);break;case 3:t=f.objectPathInfo.Name;t.length>3&&t.substr(0,3)==="Get"&&(t=t.substr(3));u=i._toCamelLowerCase(t);break;case 5:r=this.getObjVarNameBase(f.objectPathInfo.ParentObjectPathId);u=r.charAt(r.length-1)==="s"?r.substr(0,r.length-1):r+"Item";break}return u},t.prototype.getObjVarName=function(n){var t,i;if(this.m_variableNameForObjectPathMap[n])return this.m_variableNameForObjectPathMap[n];if(t=this.getObjVarNameBase(n),!this.m_variableNameToObjectPathMap[t])return this.m_variableNameForObjectPathMap[n]=t,this.m_variableNameToObjectPathMap[t]=n,t;for(i=1;this.m_variableNameToObjectPathMap[t+i.toString()];)i++;return t=t+i.toString(),this.m_variableNameForObjectPathMap[n]=t,this.m_variableNameToObjectPathMap[t]=n,t},t}();p=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.cannotRegisterEvent="CannotRegisterEvent",t.connectionFailureWithStatus="ConnectionFailureWithStatus",t.connectionFailureWithDetails="ConnectionFailureWithDetails",t.propertyNotLoaded="PropertyNotLoaded",t.runMustReturnPromise="RunMustReturnPromise",t.moreInfoInnerError="MoreInfoInnerError",t.cannotApplyPropertyThroughSetMethod="CannotApplyPropertyThroughSetMethod",t.invalidOperationInCellEditMode="InvalidOperationInCellEditMode",t.objectIsUntracked="ObjectIsUntracked",t.customFunctionDefintionMissing="CustomFunctionDefintionMissing",t.customFunctionImplementationMissing="CustomFunctionImplementationMissing",t.customFunctionNameContainsBadChars="CustomFunctionNameContainsBadChars",t.customFunctionNameCannotSplit="CustomFunctionNameCannotSplit",t.customFunctionUnexpectedNumberOfEntriesInResultBatch="CustomFunctionUnexpectedNumberOfEntriesInResultBatch",t.customFunctionCancellationHandlerMissing="CustomFunctionCancellationHandlerMissing",t.customFunctionInvalidFunction="CustomFunctionInvalidFunction",t.customFunctionInvalidFunctionMapping="CustomFunctionInvalidFunctionMapping",t.customFunctionWindowMissing="CustomFunctionWindowMissing",t.customFunctionDefintionMissingOnWindow="CustomFunctionDefintionMissingOnWindow",t.pendingBatchInProgress="PendingBatchInProgress",t.notInsideBatch="NotInsideBatch",t.cannotUpdateReadOnlyProperty="CannotUpdateReadOnlyProperty",t}(tt);n.ResourceStrings=p;t.addResourceStringValues({CannotRegisterEvent:"The event handler cannot be registered.",PropertyNotLoaded:"The property '{0}' is not available. Before reading the property's value, call the load method on the containing object and call \"context.sync()\" on the associated request context.",RunMustReturnPromise:'The batch function passed to the ".run" method didn\'t return a promise. The function must return a promise, so that any automatically-tracked objects can be released at the completion of the batch operation. Typically, you return a promise by returning the response from "context.sync()".',InvalidOrTimedOutSessionMessage:"Your Office Online session has expired or is invalid. To continue, refresh the page.",InvalidOperationInCellEditMode:"Excel is in cell-editing mode. Please exit the edit mode by pressing ENTER or TAB or selecting another cell, and then try again.",CustomFunctionDefintionMissing:"A property with the name '{0}' that represents the function's definition must exist on Excel.Script.CustomFunctions.",CustomFunctionDefintionMissingOnWindow:"A property with the name '{0}' that represents the function's definition must exist on the window object.",CustomFunctionImplementationMissing:"The property with the name '{0}' on Excel.Script.CustomFunctions that represents the function's definition must contain a 'call' property that implements the function.",CustomFunctionNameContainsBadChars:"The function name may only contain letters, digits, underscores, and periods.",CustomFunctionNameCannotSplit:"The function name must contain a non-empty namespace and a non-empty short name.",CustomFunctionUnexpectedNumberOfEntriesInResultBatch:"The batching function returned a number of results that doesn't match the number of parameter value sets that were passed into it.",CustomFunctionCancellationHandlerMissing:"The cancellation handler onCanceled is missing in the function. The handler must be present as the function is defined as cancelable.",CustomFunctionInvalidFunction:"The property with the name '{0}' that represents the function's definition is not a valid function.",CustomFunctionInvalidFunctionMapping:"The property with the name '{0}' on CustomFunctionMappings that represents the function's definition is not a valid function.",CustomFunctionWindowMissing:"The window object was not found.",PendingBatchInProgress:"There is a pending batch in progress. The batch method may not be called inside another batch, or simultaneously with another batch.",NotInsideBatch:"Operations may not be invoked outside of a batch method.",CannotUpdateReadOnlyProperty:"The property '{0}' is read-only and it cannot be updated.",ObjectIsUntracked:"The object is untracked."});i=function(i){function u(){return i!==null&&i.apply(this,arguments)||this}return __extends(u,i),u.fixObjectPathIfNecessary=function(n,t){n&&n._objectPath&&t&&n._objectPath.updateUsingObjectData(t,n)},u.load=function(n,t){return n.context.load(n,t),n},u.loadAndSync=function(n,t){return n.context.load(n,t),n.context.sync().then(function(){return n})},u.retrieve=function(t,i){var r=n._internalConfig.alwaysPolyfillClientObjectRetrieveMethod,f;return r||(r=!u.isSetSupported("RichApiRuntime","1.1")),f=new ri(t,r),t._retrieve(i,f),f},u.retrieveAndSync=function(n,t){var i=u.retrieve(n,t);return n.context.sync().then(function(){return i})},u.toJson=function(n,t,i,r){var o={},e,f;for(e in t)f=t[e],typeof f!="undefined"&&(o[e]=f);for(e in i)f=i[e],typeof f!="undefined"&&(o[e]=f[u.fieldName_isCollection]&&typeof f[u.fieldName_m__items]!="undefined"?f.toJSON().items:f.toJSON());return r&&(o.items=r.map(function(n){return n.toJSON()})),o},u.throwError=function(n,i,u){throw new r.RuntimeError({code:n,message:t._getResourceString(n,i),debugInfo:u?{errorLocation:u}:undefined});},u.createRuntimeError=function(n,t,i){return new r.RuntimeError({code:n,message:t,debugInfo:{errorLocation:i}})},u.throwIfNotLoaded=function(n,i,r,f){if(!f&&t.isUndefined(i)&&n.charCodeAt(0)!=u.s_underscoreCharCode)throw u.createPropertyNotLoadedException(r,n);},u.createPropertyNotLoadedException=function(n,i){return new r.RuntimeError({code:ft.propertyNotLoaded,message:t._getResourceString(p.propertyNotLoaded,i),debugInfo:n?{errorLocation:n+"."+i}:undefined})},u.createCannotUpdateReadOnlyPropertyException=function(n,i){return new r.RuntimeError({code:ft.cannotUpdateReadOnlyProperty,message:t._getResourceString(p.cannotUpdateReadOnlyProperty,i),debugInfo:n?{errorLocation:n+"."+i}:undefined})},u.promisify=function(t){return new n.Promise(function(n,i){var r=function(t){t.status=="failed"?i(t.error):n(t.value)};t(r)})},u._addActionResultHandler=function(n,t,i){n.context._pendingRequest.addActionResultHandler(t,i)},u._handleNavigationPropertyResults=function(n,i,r){for(var u=0;u<r.length-1;u+=2)t.isUndefined(i[r[u+1]])||n[r[u]]._handleResult(i[r[u+1]])},u._fixupApiFlags=function(n){return typeof n=="boolean"&&(n=n?1:0),n},u.definePropertyThrowUnloadedException=function(n,t,i){Object.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){throw u.createPropertyNotLoadedException(t,i);},set:function(){throw u.createCannotUpdateReadOnlyPropertyException(t,i);}})},u.defineReadOnlyPropertyWithValue=function(n,t,i){Object.defineProperty(n,t,{configurable:!0,enumerable:!0,get:function(){return i},set:function(){throw u.createCannotUpdateReadOnlyPropertyException(null,t);}})},u.processRetrieveResult=function(n,i,r,f){var l,v,y,a,o,s,c,b,h;if(!t.isNullOrUndefined(i))if(f){if(l=i[e.itemsLowerCase],Array.isArray(l)){for(v=[],o=0;o<l.length;o++)y=f(l[o],o),a={},a[e.proxy]=y,y._handleRetrieveResult(l[o],a),v.push(a);u.defineReadOnlyPropertyWithValue(r,e.itemsLowerCase,v)}}else{var p=n[e.scalarPropertyNames],w=n[e.navigationPropertyNames],k=n[e.className];if(p)for(o=0;o<p.length;o++)s=p[o],c=i[s],t.isUndefined(c)?u.definePropertyThrowUnloadedException(r,k,s):u.defineReadOnlyPropertyWithValue(r,s,c);if(w)for(o=0;o<w.length;o++)s=w[o],c=i[s],t.isUndefined(c)?u.definePropertyThrowUnloadedException(r,k,s):(b=n[s],h={},b._handleRetrieveResult(c,h),h[e.proxy]=b,Array.isArray(h[e.itemsLowerCase])&&(h=h[e.itemsLowerCase]),u.defineReadOnlyPropertyWithValue(r,s,h))}},u.fieldName_m__items="m__items",u.fieldName_isCollection="_isCollection",u._synchronousCleanup=!1,u.s_underscoreCharCode="_".charCodeAt(0),u}(u);n.Utility=i;oi=function(){function n(){}return n.invokeMethod=function(n,t,r,u,f,e){var s=y.createMethodAction(n.context,n,t,r,u,f),o=new ut(e);return i._addActionResultHandler(n,s,o),o},n.invokeEnsureUnchanged=function(n,t){y.createEnsureUnchangedAction(n.context,n,t)},n.invokeSetProperty=function(n,t,i,r){y.createSetPropertyAction(n.context,n,t,i,r)},n.createRootServiceObject=function(n,t){var i=b.createGlobalObjectObjectPath(t);return new n(t,i)},n.createObjectFromReferenceId=function(n,t,i){var r=b.createReferenceIdObjectPath(t,i);return new n(t,r)},n.createTopLevelServiceObject=function(n,t,i,r,u){var f=b.createNewObjectObjectPath(t,i,r,u);return new n(t,f)},n.createPropertyObject=function(n,t,i,r,u){var f=b.createPropertyObjectPath(t.context,t,i,r,!1,u);return new n(t.context,f)},n.createIndexerObject=function(n,t,i){var r=b.createIndexerObjectPath(t.context,t,i);return new n(t.context,r)},n.createMethodObject=function(n,t,i,r,u,f,e,o,s){var h=b.createMethodObjectPath(t.context,t,i,r,u,f,e,o,s);return new n(t.context,h)},n.createChildItemObject=function(n,t,i,r,u){var f=b.createChildItemObjectPathUsingIndexerOrGetItemAt(t,i.context,i,r,u);return new n(i.context,f)},n}();n.BatchApiHelper=oi;kt=1;st={invokeRequestModifier:function(n){return n.DdaMethod.Version=kt,n},invokeResponseModifier:function(n){return kt=n.Version,n.Error&&(n.error={},n.error.Code=n.Error),n}},function(n){n.SendingId="sId";n.RespondingId="rId";n.CommandKey="command";n.SessionInfoKey="sessionInfo";n.ParamsKey="params";n.ApiReadyCommand="apiready";n.ExecuteMethodCommand="executeMethod";n.GetAppContextCommand="getAppContext";n.RegisterEventCommand="registerEvent";n.UnregisterEventCommand="unregisterEvent";n.FireEventCommand="fireEvent"}(h||(h={}));nt=function(){function n(){}return n.sessionContext="sc",n.embeddingPageOrigin="EmbeddingPageOrigin",n.embeddingPageSessionInfo="EmbeddingPageSessionInfo",n}();n.EmbeddedConstants=nt;si=function(n){function r(t,i){var r=n.call(this)||this;return r.m_chosenWindow=null,r.m_chosenOrigin=null,r.m_enabled=!0,r.m_onMessageHandler=r._onMessage.bind(r),r.m_callbackList={},r.m_id=0,r.m_timeoutId=-1,r.m_appContext=null,r.m_url=t,r.m_options=i,r.m_options||(r.m_options={sessionKey:Math.random().toString()}),r.m_options.sessionKey||(r.m_options.sessionKey=Math.random().toString()),r.m_options.container||(r.m_options.container=document.body),r.m_options.timeoutInMilliseconds||(r.m_options.timeoutInMilliseconds=6e4),r.m_options.height||(r.m_options.height="400px"),r.m_options.width||(r.m_options.width="100%"),r.m_options.webApplication&&r.m_options.webApplication.accessToken&&r.m_options.webApplication.accessTokenTtl||(r.m_options.webApplication=null),r}return __extends(r,n),r.prototype._getIFrameSrc=function(){var r=window.location.protocol+"//"+window.location.host,t=nt.embeddingPageOrigin+"="+encodeURIComponent(r)+"&"+nt.embeddingPageSessionInfo+"="+encodeURIComponent(this.m_options.sessionKey),u=!1,n,i;return(this.m_url.toLowerCase().indexOf("/_layouts/preauth.aspx")>0||this.m_url.toLowerCase().indexOf("/_layouts/15/preauth.aspx")>0)&&(u=!0),n=document.createElement("a"),n.href=this.m_url,this.m_options.webApplication?(i=nt.embeddingPageOrigin+"="+r+"&"+nt.embeddingPageSessionInfo+"="+this.m_options.sessionKey,n.search=n.search.length===0||n.search==="?"?"?"+nt.sessionContext+"="+encodeURIComponent(i):n.search+"&"+nt.sessionContext+"="+encodeURIComponent(i)):u?n.hash=n.hash.length===0||n.hash==="#"?"#"+t:n.hash+"&"+t:n.search=n.search.length===0||n.search==="?"?"?"+t:n.search+"&"+t,n.href},r.prototype.init=function(){var n=this,r;return window.addEventListener("message",this.m_onMessageHandler),r=this._getIFrameSrc(),t.createPromise(function(u,e){var s=document.createElement("iframe"),h,c,l;n.m_options.id&&(s.id=n.m_options.id,s.name=n.m_options.id);s.style.height=n.m_options.height;s.style.width=n.m_options.width;n.m_options.webApplication?(h=document.createElement("form"),h.setAttribute("action",r),h.setAttribute("method","post"),h.setAttribute("target",s.name),n.m_options.container.appendChild(h),c=document.createElement("input"),c.setAttribute("type","hidden"),c.setAttribute("name","access_token"),c.setAttribute("value",n.m_options.webApplication.accessToken),h.appendChild(c),l=document.createElement("input"),l.setAttribute("type","hidden"),l.setAttribute("name","access_token_ttl"),l.setAttribute("value",n.m_options.webApplication.accessTokenTtl),h.appendChild(l),n.m_options.container.appendChild(s),h.submit()):(s.src=r,n.m_options.container.appendChild(s));n.m_timeoutId=window.setTimeout(function(){n.close();var r=i.createRuntimeError(f.timeout,t._getResourceString(o.timeout),"EmbeddedSession.init");e(r)},n.m_options.timeoutInMilliseconds);n.m_promiseResolver=u})},r.prototype._invoke=function(n,t,i){if(!this.m_enabled){t(5001,null);return}st.invokeRequestModifier&&(i=st.invokeRequestModifier(i));this._sendMessageWithCallback(this.m_id++,n,i,function(n){st.invokeResponseModifier&&(n=st.invokeResponseModifier(n));var i=n.Error;delete n.Error;t(i||0,n)})},r.prototype.close=function(){window.removeEventListener("message",this.m_onMessageHandler);window.clearTimeout(this.m_timeoutId);this.m_enabled=!1},Object.defineProperty(r.prototype,"eventRegistration",{get:function(){return this.m_sessionEventManager||(this.m_sessionEventManager=new vt(this._registerEventImpl.bind(this),this._unregisterEventImpl.bind(this))),this.m_sessionEventManager},enumerable:!0,configurable:!0}),r.prototype._createRequestExecutorOrNull=function(){return new hi(this)},r.prototype._resolveRequestUrlAndHeaderInfo=function(){return t._createPromiseFromResult(null)},r.prototype._registerEventImpl=function(n,i){var r=this;return t.createPromise(function(t,u){r._sendMessageWithCallback(r.m_id++,h.RegisterEventCommand,{EventId:n,TargetId:i},function(){t(null)})})},r.prototype._unregisterEventImpl=function(n,i){var r=this;return t.createPromise(function(t,u){r._sendMessageWithCallback(r.m_id++,h.UnregisterEventCommand,{EventId:n,TargetId:i},function(){t()})})},r.prototype._onMessage=function(n){var r=this,t,f,i,e,o;if(this.m_enabled&&(!this.m_chosenWindow||this.m_chosenWindow===n.source&&this.m_chosenOrigin===n.origin)){if(t=n.data,t&&t[h.CommandKey]===h.ApiReadyCommand){!this.m_chosenWindow&&this._isValidDescendant(n.source)&&t[h.SessionInfoKey]===this.m_options.sessionKey&&(this.m_chosenWindow=n.source,this.m_chosenOrigin=n.origin,this._sendMessageWithCallback(this.m_id++,h.GetAppContextCommand,null,function(n){r._setupContext(n);window.clearTimeout(r.m_timeoutId);r.m_promiseResolver()}));return}if(t&&t[h.CommandKey]===h.FireEventCommand){var u=t[h.ParamsKey],s=u.EventId,c=u.TargetId,l=u.Data;if(this.m_sessionEventManager)for(f=this.m_sessionEventManager.getHandlers(s,c),i=0;i<f.length;i++)f[i](l);return}t&&t.hasOwnProperty(h.RespondingId)&&(e=t[h.RespondingId],o=this.m_callbackList[e],typeof o=="function"&&o(t[h.ParamsKey]),delete this.m_callbackList[e])}},r.prototype._sendMessageWithCallback=function(n,t,i,r){this.m_callbackList[n]=r;var u={};u[h.SendingId]=n;u[h.CommandKey]=t;u[h.ParamsKey]=i;this.m_chosenWindow.postMessage(JSON.stringify(u),this.m_chosenOrigin)},r.prototype._isValidDescendant=function(n){function i(t){if(t===n)return!0;for(var r=0,u=t.frames.length;r<u;r++)if(i(t.frames[r]))return!0;return!1}for(var u=this.m_options.container||document.body,r=u.getElementsByTagName("iframe"),t=0,f=r.length;t<f;t++)if(i(r[t].contentWindow))return!0;return!1},r.prototype._setupContext=function(n){!(this.m_appContext=n)},r}(k);n.EmbeddedSession=si;hi=function(){function n(n){this.m_session=n}return n.prototype.executeAsync=function(i,r,u){var f=this,e=c.buildMessageArrayForIRequestExecutor(i,r,u,n.SourceLibHeaderValue);return t.createPromise(function(i,r){f.m_session._invoke(h.ExecuteMethodCommand,function(n,r){t.log("Response:");t.log(JSON.stringify(r));var u;u=n==0?c.buildResponseOnSuccess(c.getResponseBodyFromSafeArray(r.Data),c.getResponseHeadersFromSafeArray(r.Data)):c.buildResponseOnError(r.error.Code,r.error.Message);i(u)},n._transformMessageArrayIntoParams(e))})},n._transformMessageArrayIntoParams=function(t){return{ArrayData:t,DdaMethod:{DispatchId:n.DispidExecuteRichApiRequestMethod}}},n.DispidExecuteRichApiRequestMethod=93,n.SourceLibHeaderValue="Embedded",n}()}(OfficeExtension||(OfficeExtension={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var h="OfficeCore",c="AgaveVisualApi",l=OfficeExtension.BatchApiHelper.createPropertyObject,a=OfficeExtension.BatchApiHelper.createMethodObject,v=OfficeExtension.BatchApiHelper.createIndexerObject,y=OfficeExtension.BatchApiHelper.createRootServiceObject,i=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,p=OfficeExtension.BatchApiHelper.createChildItemObject,t=OfficeExtension.BatchApiHelper.invokeMethod,w=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,b=OfficeExtension.BatchApiHelper.invokeSetProperty,r=OfficeExtension.Utility.isNullOrUndefined,k=OfficeExtension.Utility.isUndefined,d=OfficeExtension.Utility.throwIfNotLoaded,g=OfficeExtension.Utility.throwIfApiNotSupported,nt=OfficeExtension.Utility.load,tt=OfficeExtension.Utility.retrieve,u=OfficeExtension.Utility.toJson,f=OfficeExtension.Utility.fixObjectPathIfNecessary,it=OfficeExtension.Utility._handleNavigationPropertyResults,rt=OfficeExtension.Utility.adjustToDateTime,e=OfficeExtension.Utility.processRetrieveResult,ut="BiShim",o=function(o){function s(){return o!==null&&o.apply(this,arguments)||this}return __extends(s,o),Object.defineProperty(s.prototype,"_className",{get:function(){return"BiShim"},enumerable:!0,configurable:!0}),s.prototype.initialize=function(n){t(this,"Initialize",0,[n],0,0)},s.prototype.getData=function(){return t(this,"getData",1,[],4,0)},s.prototype.setVisualObjects=function(n){t(this,"setVisualObjects",0,[n],2,0)},s.prototype.setVisualObjectsToPersist=function(n){t(this,"setVisualObjectsToPersist",0,[n],2,0)},s.prototype._handleResult=function(n){if(o.prototype._handleResult.call(this,n),!r(n)){var t=n;f(this,t)}},s.prototype._handleRetrieveResult=function(n,t){o.prototype._handleRetrieveResult.call(this,n,t);e(this,n,t)},s.newObject=function(t){return i(n.BiShim,t,"Microsoft.AgaveVisual.BiShim",!1,4)},s.prototype.toJSON=function(){return u(this,{},{})},s}(OfficeExtension.ClientObject),s;n.BiShim=o,function(n){n.generalException="GeneralException"}(s=n.AgaveVisualErrorCodes||(n.AgaveVisualErrorCodes={}))}(OfficeCore||(OfficeCore={})),function(n){var k="OfficeCore",d="ExperimentApi",g=OfficeExtension.BatchApiHelper.createPropertyObject,i=OfficeExtension.BatchApiHelper.createMethodObject,nt=OfficeExtension.BatchApiHelper.createIndexerObject,tt=OfficeExtension.BatchApiHelper.createRootServiceObject,h=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,it=OfficeExtension.BatchApiHelper.createChildItemObject,t=OfficeExtension.BatchApiHelper.invokeMethod,c=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,rt=OfficeExtension.BatchApiHelper.invokeSetProperty,r=OfficeExtension.Utility.isNullOrUndefined,l=OfficeExtension.Utility.isUndefined,a=OfficeExtension.Utility.throwIfNotLoaded,ut=OfficeExtension.Utility.throwIfApiNotSupported,v=OfficeExtension.Utility.load,y=OfficeExtension.Utility.retrieve,u=OfficeExtension.Utility.toJson,f=OfficeExtension.Utility.fixObjectPathIfNecessary,ft=OfficeExtension.Utility._handleNavigationPropertyResults,et=OfficeExtension.Utility.adjustToDateTime,e=OfficeExtension.Utility.processRetrieveResult,ot="FlightingService",p=function(o){function s(){return o!==null&&o.apply(this,arguments)||this}return __extends(s,o),Object.defineProperty(s.prototype,"_className",{get:function(){return"FlightingService"},enumerable:!0,configurable:!0}),s.prototype.getClientSessionId=function(){return t(this,"GetClientSessionId",1,[],4,0)},s.prototype.getDeferredFlights=function(){return t(this,"GetDeferredFlights",1,[],4,0)},s.prototype.getFeature=function(t,r,u,f){return i(n.ABType,this,"GetFeature",1,[t,r,u,f],!1,!1,null,4)},s.prototype.getFeatureGate=function(t,r){return i(n.ABType,this,"GetFeatureGate",1,[t,r],!1,!1,null,4)},s.prototype.resetOverride=function(n){t(this,"ResetOverride",0,[n],0,0)},s.prototype.setOverride=function(n,i,r){t(this,"SetOverride",0,[n,i,r],0,0)},s.prototype._handleResult=function(n){if(o.prototype._handleResult.call(this,n),!r(n)){var t=n;f(this,t)}},s.prototype._handleRetrieveResult=function(n,t){o.prototype._handleRetrieveResult.call(this,n,t);e(this,n,t)},s.newObject=function(t){return h(n.FlightingService,t,"Microsoft.Experiment.FlightingService",!1,4)},s.prototype.toJSON=function(){return u(this,{},{})},s}(OfficeExtension.ClientObject),o,s,w,b;n.FlightingService=p;o="ABType";s=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"_className",{get:function(){return"ABType"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_scalarPropertyNames",{get:function(){return["value"]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return a("value",this._V,o,this._isNull),this._V},enumerable:!0,configurable:!0}),t.prototype._handleResult=function(t){if(n.prototype._handleResult.call(this,t),!r(t)){var i=t;f(this,i);l(i.Value)||(this._V=i.Value)}},t.prototype.load=function(n){return v(this,n)},t.prototype.retrieve=function(n){return y(this,n)},t.prototype._handleRetrieveResult=function(t,i){n.prototype._handleRetrieveResult.call(this,t,i);e(this,t,i)},t.prototype.toJSON=function(){return u(this,{value:this._V},{})},t.prototype.ensureUnchanged=function(n){c(this,n);return},t}(OfficeExtension.ClientObject);n.ABType=s,function(n){n.boolean="Boolean";n.integer="Integer";n.string="String"}(w=n.FeatureType||(n.FeatureType={})),function(n){n.generalException="GeneralException"}(b=n.ExperimentErrorCodes||(n.ExperimentErrorCodes={}))}(OfficeCore||(OfficeCore={})),function(n){function t(){if(typeof window.external=="undefined"||typeof window.external.GetContext=="undefined"){var t=OSF.getClientEndPoint()._targetUrl,r=i(t);return t.indexOf("https:")!=0?!1:(n.OfficeOnlineDomainList.forEach(function(n){return n.indexOf("*.")==0&&(n=n.substring(2)),r.indexOf(n)==r.length-n.length?!0:void 0}),!1)}return!0}function i(n){var t="";return t=n.split("/")[2],t=t.split(":")[0],t.split("?")[0]}n.OfficeOnlineDomainList=["*.dod.online.office365.us","*.gov.online.office365.us","*.officeapps-df.live.com","*.officeapps.live.com","*.online.office.de","*.partner.officewebapps.cn"];n.isHostOriginTrusted=t}(OfficeCore||(OfficeCore={})),function(n){function r(t,i){return OfficeExtension.ClientRequestContext._runBatch("OfficeCore.run",arguments,function(t){return new n.RequestContext(t)})}var t=function(){function t(n){this.context=n}return Object.defineProperty(t.prototype,"roamingSettings",{get:function(){return this.m_roamingSettings||(this.m_roamingSettings=n.AuthenticationService.newObject(this.context).roamingSettings),this.m_roamingSettings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tap",{get:function(){return this.m_tap||(this.m_tap=n.Tap.newObject(this.context)),this.m_tap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skill",{get:function(){return this.m_skill||(this.m_skill=n.Skill.newObject(this.context)),this.m_skill},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"personaFactory",{get:function(){return this.m_personaFactory||(this.m_personaFactory=n.PersonaFactory.newObject(this.context)),this.m_personaFactory},enumerable:!0,configurable:!0}),t}(),i;n.FirstPartyApis=t;i=function(i){function r(n){return i.call(this,n)||this}return __extends(r,i),Object.defineProperty(r.prototype,"firstParty",{get:function(){return this.m_firstPartyApis||(this.m_firstPartyApis=new t(this)),this.m_firstPartyApis},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"flighting",{get:function(){return this.flightingService},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"telemetry",{get:function(){return this.m_telemetry||(this.m_telemetry=n.TelemetryService.newObject(this)),this.m_telemetry},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bi",{get:function(){return this.m_biShim||(this.m_biShim=n.BiShim.newObject(this)),this.m_biShim},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"flightingService",{get:function(){return this.m_flightingService||(this.m_flightingService=n.FlightingService.newObject(this)),this.m_flightingService},enumerable:!0,configurable:!0}),r}(OfficeExtension.ClientRequestContext);n.RequestContext=i;n.run=r}(OfficeCore||(OfficeCore={})),function(n){var h="Office",c="OfficeSharedApi",l=OfficeExtension.BatchApiHelper.createPropertyObject,a=OfficeExtension.BatchApiHelper.createMethodObject,v=OfficeExtension.BatchApiHelper.createIndexerObject,y=OfficeExtension.BatchApiHelper.createRootServiceObject,i=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,p=OfficeExtension.BatchApiHelper.createChildItemObject,t=OfficeExtension.BatchApiHelper.invokeMethod,w=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,b=OfficeExtension.BatchApiHelper.invokeSetProperty,r=OfficeExtension.Utility.isNullOrUndefined,k=OfficeExtension.Utility.isUndefined,d=OfficeExtension.Utility.throwIfNotLoaded,g=OfficeExtension.Utility.throwIfApiNotSupported,nt=OfficeExtension.Utility.load,tt=OfficeExtension.Utility.retrieve,u=OfficeExtension.Utility.toJson,f=OfficeExtension.Utility.fixObjectPathIfNecessary,it=OfficeExtension.Utility._handleNavigationPropertyResults,rt=OfficeExtension.Utility.adjustToDateTime,e=OfficeExtension.Utility.processRetrieveResult,ut="Skill",o=function(o){function s(){return o!==null&&o.apply(this,arguments)||this}return __extends(s,o),Object.defineProperty(s.prototype,"_className",{get:function(){return"Skill"},enumerable:!0,configurable:!0}),s.prototype.executeAction=function(n,i,r){return t(this,"ExecuteAction",1,[n,i,r],5,0)},s.prototype.notifyPaneEvent=function(n,i){t(this,"NotifyPaneEvent",1,[n,i],5,0)},s.prototype.registerHostSkillEvent=function(){t(this,"RegisterHostSkillEvent",0,[],1,0)},s.prototype.testFireEvent=function(){t(this,"TestFireEvent",0,[],1,0)},s.prototype.unregisterHostSkillEvent=function(){t(this,"UnregisterHostSkillEvent",0,[],1,0)},s.prototype._handleResult=function(n){if(o.prototype._handleResult.call(this,n),!r(n)){var t=n;f(this,t)}},s.prototype._handleRetrieveResult=function(n,t){o.prototype._handleRetrieveResult.call(this,n,t);e(this,n,t)},s.newObject=function(t){return i(n.Skill,t,"Microsoft.SkillApi.Skill",!1,4)},Object.defineProperty(s.prototype,"onHostSkillEvent",{get:function(){var n=this;return this.m_hostSkillEvent||(this.m_hostSkillEvent=new OfficeExtension.GenericEventHandlers(this.context,this,"HostSkillEvent",{eventType:65538,registerFunc:function(){return n.registerHostSkillEvent()},unregisterFunc:function(){return n.unregisterHostSkillEvent()},getTargetIdFunc:function(){return null},eventArgsTransformFunc:function(n){var t={type:n.type,data:n.data};return OfficeExtension.Utility._createPromiseFromResult(t)}})),this.m_hostSkillEvent},enumerable:!0,configurable:!0}),s.prototype.toJSON=function(){return u(this,{},{})},s}(OfficeExtension.ClientObject),s;n.Skill=o,function(n){n.generalException="GeneralException"}(s=n.SkillErrorCodes||(n.SkillErrorCodes={}))}(OfficeCore||(OfficeCore={})),function(n){var c="OfficeCore",l="TelemetryApi",a=OfficeExtension.BatchApiHelper.createPropertyObject,v=OfficeExtension.BatchApiHelper.createMethodObject,y=OfficeExtension.BatchApiHelper.createIndexerObject,p=OfficeExtension.BatchApiHelper.createRootServiceObject,t=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,w=OfficeExtension.BatchApiHelper.createChildItemObject,i=OfficeExtension.BatchApiHelper.invokeMethod,b=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,k=OfficeExtension.BatchApiHelper.invokeSetProperty,r=OfficeExtension.Utility.isNullOrUndefined,d=OfficeExtension.Utility.isUndefined,g=OfficeExtension.Utility.throwIfNotLoaded,nt=OfficeExtension.Utility.throwIfApiNotSupported,tt=OfficeExtension.Utility.load,it=OfficeExtension.Utility.retrieve,u=OfficeExtension.Utility.toJson,f=OfficeExtension.Utility.fixObjectPathIfNecessary,rt=OfficeExtension.Utility._handleNavigationPropertyResults,ut=OfficeExtension.Utility.adjustToDateTime,e=OfficeExtension.Utility.processRetrieveResult,ft="TelemetryService",o=function(o){function s(){return o!==null&&o.apply(this,arguments)||this}return __extends(s,o),Object.defineProperty(s.prototype,"_className",{get:function(){return"TelemetryService"},enumerable:!0,configurable:!0}),s.prototype.sendTelemetryEvent=function(n,t,r,u,f){i(this,"SendTelemetryEvent",1,[n,t,r,u,f],4,0)},s.prototype._handleResult=function(n){if(o.prototype._handleResult.call(this,n),!r(n)){var t=n;f(this,t)}},s.prototype._handleRetrieveResult=function(n,t){o.prototype._handleRetrieveResult.call(this,n,t);e(this,n,t)},s.newObject=function(i){return t(n.TelemetryService,i,"Microsoft.Telemetry.TelemetryService",!1,4)},s.prototype.toJSON=function(){return u(this,{},{})},s}(OfficeExtension.ClientObject),s,h;n.TelemetryService=o,function(n){n.unset="Unset";n.string="String";n.boolean="Boolean";n.int64="Int64";n.double="Double"}(s=n.DataFieldType||(n.DataFieldType={})),function(n){n.generalException="GeneralException"}(h=n.TelemetryErrorCodes||(n.TelemetryErrorCodes={}))}(OfficeCore||(OfficeCore={})),function(n){function u(u){if(OSF.WebAuth&&OSF._OfficeAppFactory.getHostInfo().hostPlatform=="web"){try{if(!Office||!Office.context||!Office.context.webAuth)throw new Error(Strings&&Strings.OfficeOM.L_ImplicitGetAuthContextMissing?Strings.OfficeOM.L_ImplicitGetAuthContextMissing:e.GetAuthContextAsyncMissing);Office.context.webAuth.getAuthContextAsync(function(f){var e,s,o;if(f.status==="succeeded"){if(i=!0,e=f.value,!e||e.isAnonymous)return!1;OSF.WebAuth.config={idp:e.authorityType.toLowerCase(),aadConfig:{authority:n.authorityOverride&&n.debugging?n.authorityOverride:e.authority,appId:e.appId,redirectUri:u?u:null,upn:e.upn},msaConfig:{authority:n.authorityOverride&&n.debugging?n.authorityOverride:e.authority,appId:e.msaAppId?e.msaAppId:e.appId,redirectUri:u?u:null,upn:e.upn},enableConsoleLogging:n.debugging,telemetry:{HashedUserId:e.userId}};OSF.WebAuth.load(function(n){return h(n),n});s=u?u:window.location.href.split("?")[0];o=sessionStorage.getItem(t);o||o===""?o=s:o+=", "+s;sessionStorage.setItem(t,o)}else i=!1,OSF.WebAuth.config=null,r=JSON.stringify(f)})}catch(f){i=!1;OSF.WebAuth.config=null;r=f}OSF.WebAuth.load(function(n){return n})}return!0}function o(n,t){var i,r,u;return OSF.WebAuth&&OSF.WebAuth.loaded&&OSF._OfficeAppFactory.getHostInfo().hostPlatform=="web"?new OfficeExtension.CoreUtility.Promise(function(i,r){t&&t.forceRefresh&&OSF.WebAuth.clearCache();var u=OSF.WebAuth.config.idp.toLowerCase()=="msa"?OfficeCore.IdentityType.microsoftAccount:OfficeCore.IdentityType.organizationAccount;OSF.WebAuth.getToken(n.resource,t&&t.popup?t.popup:null).then(function(r){f(!0,n.resource,t&&t.popup?t.popup:null);i({accessToken:r.Token,tokenIdenityType:u})}).catch(function(i){f(!1,n.resource,t&&t.popup?t.popup:null,i.ErrorCode);r({code:i.ErrorCode,message:i.ErrorMessage})})}):(i=new OfficeCore.RequestContext,r=OfficeCore.AuthenticationService.newObject(i),i._customData="WacPartition",OSF._OfficeAppFactory.getHostInfo().hostPlatform=="web"&&OSF._OfficeAppFactory.getHostInfo().hostType=="word"?(u=r.getAccessToken(n,null),i.sync().then(function(){return u.value})):new OfficeExtension.CoreUtility.Promise(function(t,u){var f=r.onTokenReceived.add(function(n){if(!OfficeExtension.CoreUtility.isNullOrUndefined(n))if(f.remove(),i.sync().catch(function(){}),n.code==0)t(n.tokenValue);else if(OfficeExtension.CoreUtility.isNullOrUndefined(n.errorInfo))u({code:n.code});else try{u(JSON.parse(n.errorInfo))}catch(r){u({code:n.code,message:n.errorInfo})}return null});i.sync().then(function(){var u=r.getAccessToken(n,r._targetId);return i.sync().then(function(){if(OfficeExtension.CoreUtility.isNullOrUndefined(u.value))return null;var n=u.value.accessToken;OfficeExtension.CoreUtility.isNullOrUndefined(n)||t(u.value)})}).catch(function(n){u(n)})}))}function s(){var n=new OfficeCore.RequestContext,i=OfficeCore.AuthenticationService.newObject(n),t;return n._customData="WacPartition",t=i.getPrimaryIdentityInfo(),n.sync().then(function(){return t.value})}function h(t){if(n.debugging&&console.log("Logging Implicit load event"),typeof OTel!="undefined")OTel.OTelLogger.onTelemetryLoaded(function(){var i=[oteljs.makeStringDataField("IdentityProvider",OSF.WebAuth.config.idp),oteljs.makeStringDataField("AppId",OSF.WebAuth.config.idp.toLowerCase()=="msa"?OSF.WebAuth.config.msaConfig.appId:OSF.WebAuth.config.aadConfig.appId),oteljs.makeBooleanDataField("Js",typeof Implicit!="undefined"?!0:!1),oteljs.makeBooleanDataField("Result",t)],n;if(OSF.WebAuth.config.telemetry)for(n in OSF.WebAuth.config.telemetry)i.push(oteljs.makeStringDataField(n,OSF.WebAuth.config.telemetry[n]));OTel.OTelLogger.sendTelemetryEvent({eventName:"Office.Extensibility.OfficeJs.OfficeFirstPartyAuth.Load",dataFields:i,eventFlags:{dataCategories:oteljs.DataCategories.ProductServiceUsage}})})}function f(t,i,r,u){if(n.debugging&&console.log("Logging Implicit acquire event"),typeof OTel!="undefined")OTel.OTelLogger.onTelemetryLoaded(function(){var f=[oteljs.makeStringDataField("IdentityProvider",OSF.WebAuth.config.idp),oteljs.makeStringDataField("AppId",OSF.WebAuth.config.idp.toLowerCase()=="msa"?OSF.WebAuth.config.msaConfig.appId:OSF.WebAuth.config.aadConfig.appId),oteljs.makeStringDataField("Target",i),oteljs.makeBooleanDataField("Popup",typeof r=="boolean"?r:!1),oteljs.makeBooleanDataField("Result",t),oteljs.makeStringDataField("Error",u)],n;if(OSF.WebAuth.config.telemetry)for(n in OSF.WebAuth.config.telemetry)f.push(oteljs.makeStringDataField(n,OSF.WebAuth.config.telemetry[n]));OTel.OTelLogger.sendTelemetryEvent({eventName:"Office.Extensibility.OfficeJs.OfficeFirstPartyAuth.GetAccessToken",dataFields:f,eventFlags:{dataCategories:oteljs.DataCategories.ProductServiceUsage}})})}function c(){var n=sessionStorage.getItem(t);n!==null&&n.indexOf(window.location.origin+window.location.pathname)!==-1&&u()}var e=function(){function n(){}return n.GetAuthContextAsyncMissing="GetAuthContextAsyncMissing",n.CannotGetAuthContext="CannotGetAuthContext",n.PackageNotLoaded="PackageNotLoaded",n}(),t="officeWebAuthReplyUrls",i=!1,r;n.debugging=!1;n.load=u;n.getAccessToken=o;n.getPrimaryIdentityInfo=s;c()}(OfficeFirstPartyAuth||(OfficeFirstPartyAuth={})),function(n){var b="Office",hi="OfficeSharedApi",h=OfficeExtension.BatchApiHelper.createPropertyObject,p=OfficeExtension.BatchApiHelper.createMethodObject,kt=OfficeExtension.BatchApiHelper.createIndexerObject,ci=OfficeExtension.BatchApiHelper.createRootServiceObject,k=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,it=OfficeExtension.BatchApiHelper.createChildItemObject,u=OfficeExtension.BatchApiHelper.invokeMethod,v=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,w=OfficeExtension.BatchApiHelper.invokeSetProperty,f=OfficeExtension.Utility.isNullOrUndefined,t=OfficeExtension.Utility.isUndefined,i=OfficeExtension.Utility.throwIfNotLoaded,d=OfficeExtension.Utility.throwIfApiNotSupported,c=OfficeExtension.Utility.load,l=OfficeExtension.Utility.retrieve,e=OfficeExtension.Utility.toJson,o=OfficeExtension.Utility.fixObjectPathIfNecessary,g=OfficeExtension.Utility._handleNavigationPropertyResults,y=OfficeExtension.Utility.adjustToDateTime,s=OfficeExtension.Utility.processRetrieveResult,dt,gt,rt,nt,ut,ni,ft,a,et,ot,st,ti,ii,ri,ht,r,ct,lt,at,tt,vt,yt,pt,ui,wt,fi,bt,ei,oi,si;(function(n){n.organizationAccount="OrganizationAccount";n.microsoftAccount="MicrosoftAccount"})(dt=n.IdentityType||(n.IdentityType={}));gt="AuthenticationService";rt=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"_className",{get:function(){return"AuthenticationService"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_navigationPropertyNames",{get:function(){return["roamingSettings"]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_targetId",{get:function(){return this.m_targetId==undefined&&(this.m_targetId=typeof OSF!="undefined"&&OSF.OUtil?OSF.OUtil.Guid.generateNewGuid():""+this.context._nextId()),this.m_targetId},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"roamingSettings",{get:function(){return this._R||(this._R=h(n.RoamingSettingCollection,this,"RoamingSettings",!1,4)),this._R},enumerable:!0,configurable:!0}),i.prototype.getAccessToken=function(n,t){return u(this,"GetAccessToken",1,[n,t],5,0)},i.prototype.getIdentities=function(){return d("AuthenticationService.getIdentities","FirstPartyAuthentication","1.3",b),u(this,"GetIdentities",1,[],5,0)},i.prototype.getPrimaryIdentityInfo=function(){return d("AuthenticationService.getPrimaryIdentityInfo","FirstPartyAuthentication","1.2",b),u(this,"GetPrimaryIdentityInfo",1,[],5,0)},i.prototype._handleResult=function(n){if(t.prototype._handleResult.call(this,n),!f(n)){var i=n;o(this,i);g(this,i,["roamingSettings","RoamingSettings"])}},i.prototype.load=function(n){return c(this,n)},i.prototype.retrieve=function(n){return l(this,n)},i.prototype._handleRetrieveResult=function(n,i){t.prototype._handleRetrieveResult.call(this,n,i);s(this,n,i)},i.newObject=function(t){return k(n.AuthenticationService,t,"Microsoft.Authentication.AuthenticationService",!1,4)},Object.defineProperty(i.prototype,"onTokenReceived",{get:function(){var n=this;return d("AuthenticationService.onTokenReceived","FirstPartyAuthentication","1.2",b),this.m_tokenReceived||(this.m_tokenReceived=new OfficeExtension.GenericEventHandlers(this.context,this,"TokenReceived",{eventType:3001,registerFunc:function(){},unregisterFunc:function(){},getTargetIdFunc:function(){return n._targetId},eventArgsTransformFunc:function(n){var t={tokenValue:n.tokenValue,code:n.code,errorInfo:n.errorInfo};return OfficeExtension.Utility._createPromiseFromResult(t)}})),this.m_tokenReceived},enumerable:!0,configurable:!0}),i.prototype.toJSON=function(){return e(this,{},{})},i}(OfficeExtension.ClientObject);n.AuthenticationService=rt;nt="RoamingSetting";ut=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return __extends(r,n),Object.defineProperty(r.prototype,"_className",{get:function(){return"RoamingSetting"},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"_scalarPropertyNames",{get:function(){return["id","value"]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"_scalarPropertyUpdateable",{get:function(){return[!1,!0]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"id",{get:function(){return i("id",this._I,nt,this._isNull),this._I},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"value",{get:function(){return i("value",this._V,nt,this._isNull),this._V},set:function(n){this._V=n;w(this,"Value",n,0)},enumerable:!0,configurable:!0}),r.prototype.set=function(n,t){this._recursivelySet(n,t,["value"],[],[])},r.prototype.update=function(n){this._recursivelyUpdate(n)},r.prototype._handleResult=function(i){if(n.prototype._handleResult.call(this,i),!f(i)){var r=i;o(this,r);t(r.Id)||(this._I=r.Id);t(r.Value)||(this._V=r.Value)}},r.prototype.load=function(n){return c(this,n)},r.prototype.retrieve=function(n){return l(this,n)},r.prototype._handleIdResult=function(i){(n.prototype._handleIdResult.call(this,i),f(i))||t(i.Id)||(this._I=i.Id)},r.prototype._handleRetrieveResult=function(t,i){n.prototype._handleRetrieveResult.call(this,t,i);s(this,t,i)},r.prototype.toJSON=function(){return e(this,{id:this._I,value:this._V},{})},r.prototype.ensureUnchanged=function(n){v(this,n);return},r}(OfficeExtension.ClientObject);n.RoamingSetting=ut;ni="RoamingSettingCollection";ft=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"_className",{get:function(){return"RoamingSettingCollection"},enumerable:!0,configurable:!0}),i.prototype.getItem=function(t){return p(n.RoamingSetting,this,"GetItem",1,[t],!1,!1,null,4)},i.prototype.getItemOrNullObject=function(t){return p(n.RoamingSetting,this,"GetItemOrNullObject",1,[t],!1,!1,null,4)},i.prototype._handleResult=function(n){if(t.prototype._handleResult.call(this,n),!f(n)){var i=n;o(this,i)}},i.prototype._handleRetrieveResult=function(n,i){t.prototype._handleRetrieveResult.call(this,n,i);s(this,n,i)},i.prototype.toJSON=function(){return e(this,{},{})},i}(OfficeExtension.ClientObject);n.RoamingSettingCollection=ft;a="Comment";et=function(r){function b(){return r!==null&&r.apply(this,arguments)||this}return __extends(b,r),Object.defineProperty(b.prototype,"_className",{get:function(){return"Comment"},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"_scalarPropertyNames",{get:function(){return["id","text","created","level","resolved","author","mentions"]},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"_scalarPropertyUpdateable",{get:function(){return[!1,!0,!1,!1,!0,!1,!1]},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"_navigationPropertyNames",{get:function(){return["parent","parentOrNullObject","replies"]},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"parent",{get:function(){return this._P||(this._P=h(n.Comment,this,"Parent",!1,4)),this._P},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"parentOrNullObject",{get:function(){return this._Pa||(this._Pa=h(n.Comment,this,"ParentOrNullObject",!1,4)),this._Pa},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"replies",{get:function(){return this._R||(this._R=h(n.CommentCollection,this,"Replies",!0,4)),this._R},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"author",{get:function(){return i("author",this._A,a,this._isNull),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"created",{get:function(){return i("created",this._C,a,this._isNull),this._C},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"id",{get:function(){return i("id",this._I,a,this._isNull),this._I},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"level",{get:function(){return i("level",this._L,a,this._isNull),this._L},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"mentions",{get:function(){return i("mentions",this._M,a,this._isNull),this._M},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"resolved",{get:function(){return i("resolved",this._Re,a,this._isNull),this._Re},set:function(n){this._Re=n;w(this,"Resolved",n,0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"text",{get:function(){return i("text",this._T,a,this._isNull),this._T},set:function(n){this._T=n;w(this,"Text",n,0)},enumerable:!0,configurable:!0}),b.prototype.set=function(n,t){this._recursivelySet(n,t,["text","resolved"],[],["parent","parentOrNullObject","replies"])},b.prototype.update=function(n){this._recursivelyUpdate(n)},b.prototype.delete=function(){u(this,"Delete",0,[],0,0)},b.prototype.getParentOrSelf=function(){return p(n.Comment,this,"GetParentOrSelf",1,[],!1,!1,null,4)},b.prototype.getRichText=function(n){return u(this,"GetRichText",1,[n],4,0)},b.prototype.reply=function(t,i){return p(n.Comment,this,"Reply",0,[t,i],!1,!1,null,0)},b.prototype.setRichText=function(n,t){return u(this,"SetRichText",0,[n,t],0,0)},b.prototype._handleResult=function(n){if(r.prototype._handleResult.call(this,n),!f(n)){var i=n;o(this,i);t(i.Author)||(this._A=i.Author);t(i.Created)||(this._C=y(i.Created));t(i.Id)||(this._I=i.Id);t(i.Level)||(this._L=i.Level);t(i.Mentions)||(this._M=i.Mentions);t(i.Resolved)||(this._Re=i.Resolved);t(i.Text)||(this._T=i.Text);g(this,i,["parent","Parent","parentOrNullObject","ParentOrNullObject","replies","Replies"])}},b.prototype.load=function(n){return c(this,n)},b.prototype.retrieve=function(n){return l(this,n)},b.prototype._handleIdResult=function(n){(r.prototype._handleIdResult.call(this,n),f(n))||t(n.Id)||(this._I=n.Id)},b.prototype._handleRetrieveResult=function(n,i){if(r.prototype._handleRetrieveResult.call(this,n,i),!f(n)){var u=n;t(u.Created)||(u.created=y(u.created));s(this,n,i)}},b.prototype.toJSON=function(){return e(this,{author:this._A,created:this._C,id:this._I,level:this._L,mentions:this._M,resolved:this._Re,text:this._T},{replies:this._R})},b.prototype.ensureUnchanged=function(n){v(this,n);return},b}(OfficeExtension.ClientObject);n.Comment=et;ot="CommentCollection";st=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),Object.defineProperty(r.prototype,"_className",{get:function(){return"CommentCollection"},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"_isCollection",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"items",{get:function(){return i("items",this.m__items,ot,this._isNull),this.m__items},enumerable:!0,configurable:!0}),r.prototype.getCount=function(){return u(this,"GetCount",1,[],4,0)},r.prototype.getItem=function(t){return kt(n.Comment,this,[t])},r.prototype._handleResult=function(i){var u,e,r,s;if((t.prototype._handleResult.call(this,i),!f(i))&&(u=i,o(this,u),!f(u[OfficeExtension.Constants.items])))for(this.m__items=[],e=u[OfficeExtension.Constants.items],r=0;r<e.length;r++)s=it(n.Comment,!0,this,e[r],r),s._handleResult(e[r]),this.m__items.push(s)},r.prototype.load=function(n){return c(this,n)},r.prototype.retrieve=function(n){return l(this,n)},r.prototype._handleRetrieveResult=function(i,r){var u=this;t.prototype._handleRetrieveResult.call(this,i,r);s(this,i,r,function(t,i){return it(n.Comment,!0,u,t,i)})},r.prototype.toJSON=function(){return e(this,{},{},this.m__items)},r}(OfficeExtension.ClientObject);n.CommentCollection=st,function(n){n.plain="Plain";n.markdown="Markdown";n.delta="Delta"}(ti=n.CommentTextFormat||(n.CommentTextFormat={})),function(n){n.noUpdate="NoUpdate";n.personaInfo="PersonaInfo";n.photoInfo="PhotoInfo";n.ucinfo="UCInfo"}(ii=n.PersonaDataUpdated||(n.PersonaDataUpdated={}));ri="PersonaActions";ht=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"_className",{get:function(){return"PersonaActions"},enumerable:!0,configurable:!0}),t.prototype.addContact=function(){u(this,"AddContact",0,[],0,0)},t.prototype.callPhoneNumber=function(n){u(this,"CallPhoneNumber",0,[n],0,0)},t.prototype.composeEmail=function(n){u(this,"ComposeEmail",0,[n],0,0)},t.prototype.composeInstantMessage=function(n){u(this,"ComposeInstantMessage",0,[n],0,0)},t.prototype.editContact=function(){u(this,"EditContact",0,[],0,0)},t.prototype.openLinkContactUx=function(){u(this,"OpenLinkContactUx",0,[],0,0)},t.prototype.pinPersonaToQuickContacts=function(){u(this,"PinPersonaToQuickContacts",0,[],0,0)},t.prototype.scheduleMeeting=function(){u(this,"ScheduleMeeting",0,[],0,0)},t.prototype.toggleTagForAlerts=function(){u(this,"ToggleTagForAlerts",0,[],0,0)},t.prototype._handleResult=function(t){if(n.prototype._handleResult.call(this,t),!f(t)){var i=t;o(this,i)}},t.prototype._handleRetrieveResult=function(t,i){n.prototype._handleRetrieveResult.call(this,t,i);s(this,t,i)},t.prototype.toJSON=function(){return e(this,{},{})},t}(OfficeExtension.ClientObject);n.PersonaActions=ht;r="PersonaInfo";ct=function(n){function u(){return n!==null&&n.apply(this,arguments)||this}return __extends(u,n),Object.defineProperty(u.prototype,"_className",{get:function(){return"PersonaInfo"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_scalarPropertyNames",{get:function(){return["displayName","email","allEmailAddresses","sip","allSipAddresses","birthday","allBirthdays","title","department","companyName","office","linkedTitles","linkedDepartments","linkedCompanyNames","linkedOffices","workPhones","timeZone","homePhones","mobilePhones","otherPhones","workFaxPhones","workAddresses","homeAddresses","otherAddresses","webSites","notes"]},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allBirthdays",{get:function(){return i("allBirthdays",this._A,r,this._isNull),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allEmailAddresses",{get:function(){return i("allEmailAddresses",this._Al,r,this._isNull),this._Al},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allSipAddresses",{get:function(){return i("allSipAddresses",this._All,r,this._isNull),this._All},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"birthday",{get:function(){return i("birthday",this._B,r,this._isNull),this._B},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"companyName",{get:function(){return i("companyName",this._C,r,this._isNull),this._C},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"department",{get:function(){return i("department",this._D,r,this._isNull),this._D},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"displayName",{get:function(){return i("displayName",this._Di,r,this._isNull),this._Di},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"email",{get:function(){return i("email",this._E,r,this._isNull),this._E},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"homeAddresses",{get:function(){return i("homeAddresses",this._H,r,this._isNull),this._H},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"homePhones",{get:function(){return i("homePhones",this._Ho,r,this._isNull),this._Ho},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"linkedCompanyNames",{get:function(){return i("linkedCompanyNames",this._L,r,this._isNull),this._L},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"linkedDepartments",{get:function(){return i("linkedDepartments",this._Li,r,this._isNull),this._Li},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"linkedOffices",{get:function(){return i("linkedOffices",this._Lin,r,this._isNull),this._Lin},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"linkedTitles",{get:function(){return i("linkedTitles",this._Link,r,this._isNull),this._Link},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"mobilePhones",{get:function(){return i("mobilePhones",this._M,r,this._isNull),this._M},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"notes",{get:function(){return i("notes",this._N,r,this._isNull),this._N},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"office",{get:function(){return i("office",this._O,r,this._isNull),this._O},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"otherAddresses",{get:function(){return i("otherAddresses",this._Ot,r,this._isNull),this._Ot},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"otherPhones",{get:function(){return i("otherPhones",this._Oth,r,this._isNull),this._Oth},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"sip",{get:function(){return i("sip",this._S,r,this._isNull),this._S},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"timeZone",{get:function(){return i("timeZone",this._T,r,this._isNull),this._T},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"title",{get:function(){return i("title",this._Ti,r,this._isNull),this._Ti},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"webSites",{get:function(){return i("webSites",this._W,r,this._isNull),this._W},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"workAddresses",{get:function(){return i("workAddresses",this._Wo,r,this._isNull),this._Wo},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"workFaxPhones",{get:function(){return i("workFaxPhones",this._Wor,r,this._isNull),this._Wor},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"workPhones",{get:function(){return i("workPhones",this._Work,r,this._isNull),this._Work},enumerable:!0,configurable:!0}),u.prototype._handleResult=function(i){if(n.prototype._handleResult.call(this,i),!f(i)){var r=i;o(this,r);t(r.AllBirthdays)||(this._A=y(r.AllBirthdays));t(r.AllEmailAddresses)||(this._Al=r.AllEmailAddresses);t(r.AllSipAddresses)||(this._All=r.AllSipAddresses);t(r.Birthday)||(this._B=y(r.Birthday));t(r.CompanyName)||(this._C=r.CompanyName);t(r.Department)||(this._D=r.Department);t(r.DisplayName)||(this._Di=r.DisplayName);t(r.Email)||(this._E=r.Email);t(r.HomeAddresses)||(this._H=r.HomeAddresses);t(r.HomePhones)||(this._Ho=r.HomePhones);t(r.LinkedCompanyNames)||(this._L=r.LinkedCompanyNames);t(r.LinkedDepartments)||(this._Li=r.LinkedDepartments);t(r.LinkedOffices)||(this._Lin=r.LinkedOffices);t(r.LinkedTitles)||(this._Link=r.LinkedTitles);t(r.MobilePhones)||(this._M=r.MobilePhones);t(r.Notes)||(this._N=r.Notes);t(r.Office)||(this._O=r.Office);t(r.OtherAddresses)||(this._Ot=r.OtherAddresses);t(r.OtherPhones)||(this._Oth=r.OtherPhones);t(r.Sip)||(this._S=r.Sip);t(r.TimeZone)||(this._T=r.TimeZone);t(r.Title)||(this._Ti=r.Title);t(r.WebSites)||(this._W=r.WebSites);t(r.WorkAddresses)||(this._Wo=r.WorkAddresses);t(r.WorkFaxPhones)||(this._Wor=r.WorkFaxPhones);t(r.WorkPhones)||(this._Work=r.WorkPhones)}},u.prototype.load=function(n){return c(this,n)},u.prototype.retrieve=function(n){return l(this,n)},u.prototype._handleRetrieveResult=function(i,r){if(n.prototype._handleRetrieveResult.call(this,i,r),!f(i)){var u=i;t(u.AllBirthdays)||(u.allBirthdays=y(u.allBirthdays));t(u.Birthday)||(u.birthday=y(u.birthday));s(this,i,r)}},u.prototype.toJSON=function(){return e(this,{allBirthdays:this._A,allEmailAddresses:this._Al,allSipAddresses:this._All,birthday:this._B,companyName:this._C,department:this._D,displayName:this._Di,email:this._E,homeAddresses:this._H,homePhones:this._Ho,linkedCompanyNames:this._L,linkedDepartments:this._Li,linkedOffices:this._Lin,linkedTitles:this._Link,mobilePhones:this._M,notes:this._N,office:this._O,otherAddresses:this._Ot,otherPhones:this._Oth,sip:this._S,timeZone:this._T,title:this._Ti,webSites:this._W,workAddresses:this._Wo,workFaxPhones:this._Wor,workPhones:this._Work},{})},u.prototype.ensureUnchanged=function(n){v(this,n);return},u}(OfficeExtension.ClientObject);n.PersonaInfo=ct;lt="PersonaUCInfo";at=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return __extends(r,n),Object.defineProperty(r.prototype,"_className",{get:function(){return"PersonaUCInfo"},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"_scalarPropertyNames",{get:function(){return["availability"]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"_scalarPropertyUpdateable",{get:function(){return[!0]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"availability",{get:function(){return i("availability",this._A,lt,this._isNull),this._A},set:function(n){this._A=n;w(this,"Availability",n,0)},enumerable:!0,configurable:!0}),r.prototype.set=function(n,t){this._recursivelySet(n,t,["availability"],[],[])},r.prototype.update=function(n){this._recursivelyUpdate(n)},r.prototype._handleResult=function(i){if(n.prototype._handleResult.call(this,i),!f(i)){var r=i;o(this,r);t(r.Availability)||(this._A=r.Availability)}},r.prototype.load=function(n){return c(this,n)},r.prototype.retrieve=function(n){return l(this,n)},r.prototype._handleRetrieveResult=function(t,i){n.prototype._handleRetrieveResult.call(this,t,i);s(this,t,i)},r.prototype.toJSON=function(){return e(this,{availability:this._A},{})},r.prototype.ensureUnchanged=function(n){v(this,n);return},r}(OfficeExtension.ClientObject);n.PersonaUCInfo=at;tt="PhotoInfo";vt=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return __extends(r,n),Object.defineProperty(r.prototype,"_className",{get:function(){return"PhotoInfo"},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"_scalarPropertyNames",{get:function(){return["type","data"]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"data",{get:function(){return i("data",this._D,tt,this._isNull),this._D},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"type",{get:function(){return i("type",this._T,tt,this._isNull),this._T},enumerable:!0,configurable:!0}),r.prototype._handleResult=function(i){if(n.prototype._handleResult.call(this,i),!f(i)){var r=i;o(this,r);t(r.Data)||(this._D=r.Data);t(r.Type)||(this._T=r.Type)}},r.prototype.load=function(n){return c(this,n)},r.prototype.retrieve=function(n){return l(this,n)},r.prototype._handleRetrieveResult=function(t,i){n.prototype._handleRetrieveResult.call(this,t,i);s(this,t,i)},r.prototype.toJSON=function(){return e(this,{data:this._D,type:this._T},{})},r.prototype.ensureUnchanged=function(n){v(this,n);return},r}(OfficeExtension.ClientObject);n.PhotoInfo=vt;yt="Persona";pt=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return __extends(u,r),Object.defineProperty(u.prototype,"_className",{get:function(){return"Persona"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_scalarPropertyNames",{get:function(){return["eventTargetId"]},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_navigationPropertyNames",{get:function(){return["personaInfo","ucinfo","photo","actions"]},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"actions",{get:function(){return this._A||(this._A=h(n.PersonaActions,this,"Actions",!1,4)),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"personaInfo",{get:function(){return this._P||(this._P=h(n.PersonaInfo,this,"PersonaInfo",!1,4)),this._P},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"photo",{get:function(){return this._Ph||(this._Ph=h(n.PhotoInfo,this,"Photo",!1,4)),this._Ph},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"ucinfo",{get:function(){return this._U||(this._U=h(n.PersonaUCInfo,this,"UCInfo",!1,4)),this._U},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"eventTargetId",{get:function(){return i("eventTargetId",this._E,yt,this._isNull),this._E},enumerable:!0,configurable:!0}),u.prototype.set=function(n,t){this._recursivelySet(n,t,[],["ucinfo"],["actions","personaInfo","photo"])},u.prototype.update=function(n){this._recursivelyUpdate(n)},u.prototype._handleResult=function(n){if(r.prototype._handleResult.call(this,n),!f(n)){var i=n;o(this,i);t(i.EventTargetId)||(this._E=i.EventTargetId);g(this,i,["actions","Actions","personaInfo","PersonaInfo","photo","Photo","ucinfo","UCInfo"])}},u.prototype.load=function(n){return c(this,n)},u.prototype.retrieve=function(n){return l(this,n)},u.prototype._handleRetrieveResult=function(n,t){r.prototype._handleRetrieveResult.call(this,n,t);s(this,n,t)},Object.defineProperty(u.prototype,"onPersonaUpdated",{get:function(){var n=this;return this.m_personaUpdated||(this.m_personaUpdated=new OfficeExtension.GenericEventHandlers(this.context,this,"PersonaUpdated",{eventType:4001,registerFunc:function(){},unregisterFunc:function(){},getTargetIdFunc:function(){return n.eventTargetId},eventArgsTransformFunc:function(n){var t={sendingPersona:n.sendingPersona,dataUpdated:n.dataUpdated};return OfficeExtension.Utility._createPromiseFromResult(t)}})),this.m_personaUpdated},enumerable:!0,configurable:!0}),u.prototype.toJSON=function(){return e(this,{eventTargetId:this._E},{personaInfo:this._P,ucinfo:this._U})},u.prototype.ensureUnchanged=function(n){v(this,n);return},u}(OfficeExtension.ClientObject);n.Persona=pt;ui="PersonaFactory";wt=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"_className",{get:function(){return"PersonaFactory"},enumerable:!0,configurable:!0}),i.prototype.disposePersonaToken=function(n){u(this,"DisposePersonaToken",0,[n],0,0)},i.prototype.getPersonaFromToken=function(t){return p(n.Persona,this,"GetPersonaFromToken",0,[t],!1,!1,null,0)},i.prototype.getPersonaTokenForCurrentUser=function(){return u(this,"GetPersonaTokenForCurrentUser",0,[],0,0)},i.prototype._handleResult=function(n){if(t.prototype._handleResult.call(this,n),!f(n)){var i=n;o(this,i)}},i.prototype._handleRetrieveResult=function(n,i){t.prototype._handleRetrieveResult.call(this,n,i);s(this,n,i)},i.newObject=function(t){return k(n.PersonaFactory,t,"Microsoft.People.PersonaFactory",!1,4)},i.prototype.toJSON=function(){return e(this,{},{})},i}(OfficeExtension.ClientObject);n.PersonaFactory=wt;fi="Tap";bt=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"_className",{get:function(){return"Tap"},enumerable:!0,configurable:!0}),i.prototype.getEnterpriseUserInfo=function(){return u(this,"GetEnterpriseUserInfo",1,[],5,0)},i.prototype.getMruFriendlyPath=function(n){return u(this,"GetMruFriendlyPath",1,[n],5,0)},i.prototype.launchFileUrlInOfficeApp=function(n,t){return u(this,"LaunchFileUrlInOfficeApp",1,[n,t],5,0)},i.prototype.performLocalSearch=function(n,t,i,r){return u(this,"PerformLocalSearch",1,[n,t,i,r],5,0)},i.prototype.readSearchCache=function(n,t,i){return u(this,"ReadSearchCache",1,[n,t,i],5,0)},i.prototype.writeSearchCache=function(n,t,i){return u(this,"WriteSearchCache",1,[n,t,i],5,0)},i.prototype._handleResult=function(n){if(t.prototype._handleResult.call(this,n),!f(n)){var i=n;o(this,i)}},i.prototype._handleRetrieveResult=function(n,i){t.prototype._handleRetrieveResult.call(this,n,i);s(this,n,i)},i.newObject=function(t){return k(n.Tap,t,"Microsoft.TapRichApi.Tap",!1,4)},i.prototype.toJSON=function(){return e(this,{},{})},i}(OfficeExtension.ClientObject);n.Tap=bt,function(n){n.unknown="Unknown";n.chart="Chart";n.smartArt="SmartArt";n.table="Table";n.image="Image";n.slide="Slide";n.ole="OLE";n.text="Text"}(ei=n.ObjectType||(n.ObjectType={})),function(n){n.apiNotAvailable="ApiNotAvailable";n.clientError="ClientError";n.generalException="GeneralException";n.interactiveFlowAborted="InteractiveFlowAborted";n.invalidArgument="InvalidArgument";n.invalidGrant="InvalidGrant";n.invalidResourceUrl="InvalidResourceUrl";n.resourceNotSupported="ResourceNotSupported";n.serverError="ServerError";n.ticketInvalidParams="TicketInvalidParams";n.ticketNetworkError="TicketNetworkError";n.ticketUnauthorized="TicketUnauthorized";n.ticketUnknownError="TicketUnknownError";n.unsupportedUserIdentity="UnsupportedUserIdentity";n.userNotSignedIn="UserNotSignedIn"}(oi=n.ErrorCodes||(n.ErrorCodes={})),function(n){}(si=n.Interfaces||(n.Interfaces={}))}(OfficeCore||(OfficeCore={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var at="Visio",vt="VisioApi",u=OfficeExtension.BatchApiHelper.createPropertyObject,a=OfficeExtension.BatchApiHelper.createMethodObject,k=OfficeExtension.BatchApiHelper.createIndexerObject,yt=OfficeExtension.BatchApiHelper.createRootServiceObject,pt=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,v=OfficeExtension.BatchApiHelper.createChildItemObject,f=OfficeExtension.BatchApiHelper.invokeMethod,p=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,d=OfficeExtension.BatchApiHelper.invokeSetProperty,r=OfficeExtension.Utility.isNullOrUndefined,i=OfficeExtension.Utility.isUndefined,t=OfficeExtension.Utility.throwIfNotLoaded,wt=OfficeExtension.Utility.throwIfApiNotSupported,o=OfficeExtension.Utility.load,s=OfficeExtension.Utility.retrieve,h=OfficeExtension.Utility.toJson,c=OfficeExtension.Utility.fixObjectPathIfNecessary,w=OfficeExtension.Utility._handleNavigationPropertyResults,bt=OfficeExtension.Utility.adjustToDateTime,l=OfficeExtension.Utility.processRetrieveResult,g="Application",ct=function(f){function e(){return f!==null&&f.apply(this,arguments)||this}return __extends(e,f),Object.defineProperty(e.prototype,"_className",{get:function(){return"Application"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_scalarPropertyNames",{get:function(){return["name","userName","isVisible"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_scalarPropertyUpdateable",{get:function(){return[!1,!0,!0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_navigationPropertyNames",{get:function(){return["activeDocument","activePage","documents"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeDocument",{get:function(){return this._A||(this._A=u(n.Document,this,"ActiveDocument",!1,4)),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activePage",{get:function(){return this._Ac||(this._Ac=u(n.Page,this,"ActivePage",!1,4)),this._Ac},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documents",{get:function(){return this._D||(this._D=u(n.DocumentCollection,this,"Documents",!0,4)),this._D},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return t("isVisible",this._I,g,this._isNull),this._I},set:function(n){this._I=n;d(this,"IsVisible",n,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return t("name",this._N,g,this._isNull),this._N},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userName",{get:function(){return t("userName",this._U,g,this._isNull),this._U},set:function(n){this._U=n;d(this,"UserName",n,0)},enumerable:!0,configurable:!0}),e.prototype.set=function(n,t){this._recursivelySet(n,t,["userName","isVisible"],["activeDocument","activePage"],["documents"])},e.prototype.update=function(n){this._recursivelyUpdate(n)},e.prototype._handleResult=function(n){if(f.prototype._handleResult.call(this,n),!r(n)){var t=n;c(this,t);i(t.IsVisible)||(this._I=t.IsVisible);i(t.Name)||(this._N=t.Name);i(t.UserName)||(this._U=t.UserName);w(this,t,["activeDocument","ActiveDocument","activePage","ActivePage","documents","Documents"])}},e.prototype.load=function(n){return o(this,n)},e.prototype.retrieve=function(n){return s(this,n)},e.prototype._handleRetrieveResult=function(n,t){f.prototype._handleRetrieveResult.call(this,n,t);l(this,n,t)},e.prototype.toJSON=function(){return h(this,{isVisible:this._I,name:this._N,userName:this._U},{activeDocument:this._A,activePage:this._Ac,documents:this._D})},e.prototype.ensureUnchanged=function(n){p(this,n);return},e}(OfficeExtension.ClientObject),y,nt,tt,it,b,rt,ut,ft,e,et,ot,st,ht,lt;n.Application=ct;y="Document";nt=function(e){function a(){return e!==null&&e.apply(this,arguments)||this}return __extends(a,e),Object.defineProperty(a.prototype,"_className",{get:function(){return"Document"},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_scalarPropertyNames",{get:function(){return["description","fullName","id","index","name"]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_scalarPropertyUpdateable",{get:function(){return[!0,!1,!1,!1,!1]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_navigationPropertyNames",{get:function(){return["application","pages"]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"application",{get:function(){return this._A||(this._A=u(n.Application,this,"Application",!1,4)),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"pages",{get:function(){return this._P||(this._P=u(n.PageCollection,this,"Pages",!0,4)),this._P},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"description",{get:function(){return t("description",this._D,y,this._isNull),this._D},set:function(n){this._D=n;d(this,"Description",n,0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"fullName",{get:function(){return t("fullName",this._F,y,this._isNull),this._F},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"id",{get:function(){return t("id",this._I,y,this._isNull),this._I},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"index",{get:function(){return t("index",this._In,y,this._isNull),this._In},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return t("name",this._N,y,this._isNull),this._N},enumerable:!0,configurable:!0}),a.prototype.set=function(n,t){this._recursivelySet(n,t,["description"],["application"],["pages"])},a.prototype.update=function(n){this._recursivelyUpdate(n)},a.prototype.close=function(){f(this,"Close",1,[],4,0)},a.prototype._RegisterShapeAddedEvent=function(){f(this,"_RegisterShapeAddedEvent",0,[],0,0)},a.prototype._UnregisterShapeAddedEvent=function(){f(this,"_UnregisterShapeAddedEvent",0,[],0,0)},a.prototype._handleResult=function(n){if(e.prototype._handleResult.call(this,n),!r(n)){var t=n;c(this,t);i(t.Description)||(this._D=t.Description);i(t.FullName)||(this._F=t.FullName);i(t.ID)||(this._I=t.ID);i(t.Index)||(this._In=t.Index);i(t.Name)||(this._N=t.Name);w(this,t,["application","Application","pages","Pages"])}},a.prototype.load=function(n){return o(this,n)},a.prototype.retrieve=function(n){return s(this,n)},a.prototype._handleRetrieveResult=function(n,t){e.prototype._handleRetrieveResult.call(this,n,t);l(this,n,t)},Object.defineProperty(a.prototype,"onShapeAdded",{get:function(){var n=this;return this.m_shapeAdded||(this.m_shapeAdded=new OfficeExtension.GenericEventHandlers(this.context,this,"ShapeAdded",{eventType:1,registerFunc:function(){return n._RegisterShapeAddedEvent()},unregisterFunc:function(){return n._UnregisterShapeAddedEvent()},getTargetIdFunc:function(){return""},eventArgsTransformFunc:function(n){var t={type:ht.shapeAdded,shapeId:n.shapeId,pageId:n.pageId};return OfficeExtension.Utility._createPromiseFromResult(t)}})),this.m_shapeAdded},enumerable:!0,configurable:!0}),a.prototype.toJSON=function(){return h(this,{description:this._D,fullName:this._F,id:this._I,index:this._In,name:this._N},{application:this._A,pages:this._P})},a.prototype.ensureUnchanged=function(n){p(this,n);return},a}(OfficeExtension.ClientObject);n.Document=nt;tt="DocumentCollection";it=function(i){function u(){return i!==null&&i.apply(this,arguments)||this}return __extends(u,i),Object.defineProperty(u.prototype,"_className",{get:function(){return"DocumentCollection"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_isCollection",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"items",{get:function(){return t("items",this.m__items,tt,this._isNull),this.m__items},enumerable:!0,configurable:!0}),u.prototype.add=function(t){return a(n.Document,this,"Add",1,[t],!1,!0,null,4)},u.prototype.getCount=function(){return f(this,"GetCount",1,[],4,0)},u.prototype.getItem=function(t){return k(n.Document,this,[t])},u.prototype.getItemOrNullObject=function(t){return a(n.Document,this,"GetItemOrNullObject",1,[t],!1,!1,null,4)},u.prototype._handleResult=function(t){var f,e,u,o;if((i.prototype._handleResult.call(this,t),!r(t))&&(f=t,c(this,f),!r(f[OfficeExtension.Constants.items])))for(this.m__items=[],e=f[OfficeExtension.Constants.items],u=0;u<e.length;u++)o=v(n.Document,!0,this,e[u],u),o._handleResult(e[u]),this.m__items.push(o)},u.prototype.load=function(n){return o(this,n)},u.prototype.retrieve=function(n){return s(this,n)},u.prototype._handleRetrieveResult=function(t,r){var u=this;i.prototype._handleRetrieveResult.call(this,t,r);l(this,t,r,function(t,i){return v(n.Document,!0,u,t,i)})},u.prototype.toJSON=function(){return h(this,{},{},this.m__items)},u}(OfficeExtension.ClientObject);n.DocumentCollection=it;b="Page";rt=function(e){function a(){return e!==null&&e.apply(this,arguments)||this}return __extends(a,e),Object.defineProperty(a.prototype,"_className",{get:function(){return"Page"},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_scalarPropertyNames",{get:function(){return["index","name","id"]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_navigationPropertyNames",{get:function(){return["shapes","application","document"]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"application",{get:function(){return this._A||(this._A=u(n.Application,this,"Application",!1,4)),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"document",{get:function(){return this._D||(this._D=u(n.Document,this,"Document",!1,4)),this._D},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"shapes",{get:function(){return this._S||(this._S=u(n.ShapeCollection,this,"Shapes",!0,4)),this._S},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"id",{get:function(){return t("id",this._I,b,this._isNull),this._I},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"index",{get:function(){return t("index",this._In,b,this._isNull),this._In},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return t("name",this._N,b,this._isNull),this._N},enumerable:!0,configurable:!0}),a.prototype.set=function(n,t){this._recursivelySet(n,t,[],["application","document"],["shapes"])},a.prototype.update=function(n){this._recursivelyUpdate(n)},a.prototype.boundingBox=function(n,t,i,r,u){f(this,"BoundingBox",1,[n,t,i,r,u],4,0)},a.prototype._handleResult=function(n){if(e.prototype._handleResult.call(this,n),!r(n)){var t=n;c(this,t);i(t.ID)||(this._I=t.ID);i(t.Index)||(this._In=t.Index);i(t.Name)||(this._N=t.Name);w(this,t,["application","Application","document","Document","shapes","Shapes"])}},a.prototype.load=function(n){return o(this,n)},a.prototype.retrieve=function(n){return s(this,n)},a.prototype._handleRetrieveResult=function(n,t){e.prototype._handleRetrieveResult.call(this,n,t);l(this,n,t)},a.prototype.toJSON=function(){return h(this,{id:this._I,index:this._In,name:this._N},{application:this._A,document:this._D,shapes:this._S})},a.prototype.ensureUnchanged=function(n){p(this,n);return},a}(OfficeExtension.ClientObject);n.Page=rt;ut="PageCollection";ft=function(i){function u(){return i!==null&&i.apply(this,arguments)||this}return __extends(u,i),Object.defineProperty(u.prototype,"_className",{get:function(){return"PageCollection"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_isCollection",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"items",{get:function(){return t("items",this.m__items,ut,this._isNull),this.m__items},enumerable:!0,configurable:!0}),u.prototype.add=function(t){return a(n.Page,this,"Add",1,[t],!1,!0,null,4)},u.prototype.getCount=function(){return f(this,"GetCount",1,[],4,0)},u.prototype.getItem=function(t){return k(n.Page,this,[t])},u.prototype.getItemOrNullObject=function(t){return a(n.Page,this,"GetItemOrNullObject",1,[t],!1,!1,null,4)},u.prototype._handleResult=function(t){var f,e,u,o;if((i.prototype._handleResult.call(this,t),!r(t))&&(f=t,c(this,f),!r(f[OfficeExtension.Constants.items])))for(this.m__items=[],e=f[OfficeExtension.Constants.items],u=0;u<e.length;u++)o=v(n.Page,!0,this,e[u],u),o._handleResult(e[u]),this.m__items.push(o)},u.prototype.load=function(n){return o(this,n)},u.prototype.retrieve=function(n){return s(this,n)},u.prototype._handleRetrieveResult=function(t,r){var u=this;i.prototype._handleRetrieveResult.call(this,t,r);l(this,t,r,function(t,i){return v(n.Page,!0,u,t,i)})},u.prototype.toJSON=function(){return h(this,{},{},this.m__items)},u}(OfficeExtension.ClientObject);n.PageCollection=ft;e="Shape";et=function(a){function v(){return a!==null&&a.apply(this,arguments)||this}return __extends(v,a),Object.defineProperty(v.prototype,"_className",{get:function(){return"Shape"},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"_scalarPropertyNames",{get:function(){return["name","id","text","isCallout","isDataGraphicCallout","isOpenForTextEdit","type"]},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"_navigationPropertyNames",{get:function(){return["application","document"]},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"application",{get:function(){return this._A||(this._A=u(n.Application,this,"Application",!1,4)),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"document",{get:function(){return this._D||(this._D=u(n.Document,this,"Document",!1,4)),this._D},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"id",{get:function(){return t("id",this._I,e,this._isNull),this._I},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"isCallout",{get:function(){return t("isCallout",this._Is,e,this._isNull),this._Is},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"isDataGraphicCallout",{get:function(){return t("isDataGraphicCallout",this._IsD,e,this._isNull),this._IsD},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"isOpenForTextEdit",{get:function(){return t("isOpenForTextEdit",this._IsO,e,this._isNull),this._IsO},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"name",{get:function(){return t("name",this._N,e,this._isNull),this._N},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"text",{get:function(){return t("text",this._T,e,this._isNull),this._T},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"type",{get:function(){return t("type",this._Ty,e,this._isNull),this._Ty},enumerable:!0,configurable:!0}),v.prototype.set=function(n,t){this._recursivelySet(n,t,[],["application","document"],[])},v.prototype.update=function(n){this._recursivelyUpdate(n)},v.prototype.boundingBox=function(n,t,i,r,u){f(this,"BoundingBox",1,[n,t,i,r,u],4,0)},v.prototype._handleResult=function(n){if(a.prototype._handleResult.call(this,n),!r(n)){var t=n;c(this,t);i(t.Id)||(this._I=t.Id);i(t.IsCallout)||(this._Is=t.IsCallout);i(t.IsDataGraphicCallout)||(this._IsD=t.IsDataGraphicCallout);i(t.IsOpenForTextEdit)||(this._IsO=t.IsOpenForTextEdit);i(t.Name)||(this._N=t.Name);i(t.Text)||(this._T=t.Text);i(t.Type)||(this._Ty=t.Type);w(this,t,["application","Application","document","Document"])}},v.prototype.load=function(n){return o(this,n)},v.prototype.retrieve=function(n){return s(this,n)},v.prototype._handleIdResult=function(n){(a.prototype._handleIdResult.call(this,n),r(n))||i(n.Id)||(this._I=n.Id)},v.prototype._handleRetrieveResult=function(n,t){a.prototype._handleRetrieveResult.call(this,n,t);l(this,n,t)},v.prototype.toJSON=function(){return h(this,{id:this._I,isCallout:this._Is,isDataGraphicCallout:this._IsD,isOpenForTextEdit:this._IsO,name:this._N,text:this._T,type:this._Ty},{application:this._A,document:this._D})},v.prototype.ensureUnchanged=function(n){p(this,n);return},v}(OfficeExtension.ClientObject);n.Shape=et;ot="ShapeCollection";st=function(i){function u(){return i!==null&&i.apply(this,arguments)||this}return __extends(u,i),Object.defineProperty(u.prototype,"_className",{get:function(){return"ShapeCollection"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_isCollection",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"items",{get:function(){return t("items",this.m__items,ot,this._isNull),this.m__items},enumerable:!0,configurable:!0}),u.prototype.add=function(t){return a(n.Shape,this,"Add",1,[t],!1,!0,null,4)},u.prototype.getCount=function(){return f(this,"GetCount",1,[],4,0)},u.prototype.getItem=function(t){return k(n.Shape,this,[t])},u.prototype.getItemOrNullObject=function(t){return a(n.Shape,this,"GetItemOrNullObject",1,[t],!1,!1,null,4)},u.prototype._handleResult=function(t){var f,e,u,o;if((i.prototype._handleResult.call(this,t),!r(t))&&(f=t,c(this,f),!r(f[OfficeExtension.Constants.items])))for(this.m__items=[],e=f[OfficeExtension.Constants.items],u=0;u<e.length;u++)o=v(n.Shape,!0,this,e[u],u),o._handleResult(e[u]),this.m__items.push(o)},u.prototype.load=function(n){return o(this,n)},u.prototype.retrieve=function(n){return s(this,n)},u.prototype._handleRetrieveResult=function(t,r){var u=this;i.prototype._handleRetrieveResult.call(this,t,r);l(this,t,r,function(t,i){return v(n.Shape,!0,u,t,i)})},u.prototype.toJSON=function(){return h(this,{},{},this.m__items)},u}(OfficeExtension.ClientObject);n.ShapeCollection=st,function(n){n.shapeAdded="ShapeAdded"}(ht=n.EventType||(n.EventType={})),function(n){n.generalException="GeneralException"}(lt=n.ErrorCodes||(n.ErrorCodes={}))}(Visio||(Visio={})),function(n){function i(t,i){return OfficeExtension.ClientRequestContext._runBatch("Visio.run",arguments,function(){return new n.RequestContext})}var t=function(t){function i(i){var r=t.call(this,i)||this;return r.m_application=new n.Application(r,OfficeExtension.ObjectPathFactory.createGlobalObjectObjectPath(r)),r._rootObject=r.m_application,r}return __extends(i,t),Object.defineProperty(i.prototype,"application",{get:function(){return this.m_application},enumerable:!0,configurable:!0}),i}(OfficeCore.RequestContext);n.RequestContext=t;n.run=i}(Visio||(Visio={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var at="Visio",vt="VisioApi",u=OfficeExtension.BatchApiHelper.createPropertyObject,a=OfficeExtension.BatchApiHelper.createMethodObject,k=OfficeExtension.BatchApiHelper.createIndexerObject,yt=OfficeExtension.BatchApiHelper.createRootServiceObject,pt=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,v=OfficeExtension.BatchApiHelper.createChildItemObject,f=OfficeExtension.BatchApiHelper.invokeMethod,p=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,d=OfficeExtension.BatchApiHelper.invokeSetProperty,r=OfficeExtension.Utility.isNullOrUndefined,i=OfficeExtension.Utility.isUndefined,t=OfficeExtension.Utility.throwIfNotLoaded,wt=OfficeExtension.Utility.throwIfApiNotSupported,o=OfficeExtension.Utility.load,s=OfficeExtension.Utility.retrieve,h=OfficeExtension.Utility.toJson,c=OfficeExtension.Utility.fixObjectPathIfNecessary,w=OfficeExtension.Utility._handleNavigationPropertyResults,bt=OfficeExtension.Utility.adjustToDateTime,l=OfficeExtension.Utility.processRetrieveResult,g="Application",ct=function(f){function e(){return f!==null&&f.apply(this,arguments)||this}return __extends(e,f),Object.defineProperty(e.prototype,"_className",{get:function(){return"Application"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_scalarPropertyNames",{get:function(){return["name","userName","isVisible"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_scalarPropertyUpdateable",{get:function(){return[!1,!0,!0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_navigationPropertyNames",{get:function(){return["activeDocument","activePage","documents"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeDocument",{get:function(){return this._A||(this._A=u(n.Document,this,"ActiveDocument",!1,4)),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activePage",{get:function(){return this._Ac||(this._Ac=u(n.Page,this,"ActivePage",!1,4)),this._Ac},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documents",{get:function(){return this._D||(this._D=u(n.DocumentCollection,this,"Documents",!0,4)),this._D},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return t("isVisible",this._I,g,this._isNull),this._I},set:function(n){this._I=n;d(this,"IsVisible",n,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return t("name",this._N,g,this._isNull),this._N},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userName",{get:function(){return t("userName",this._U,g,this._isNull),this._U},set:function(n){this._U=n;d(this,"UserName",n,0)},enumerable:!0,configurable:!0}),e.prototype.set=function(n,t){this._recursivelySet(n,t,["userName","isVisible"],["activeDocument","activePage"],["documents"])},e.prototype.update=function(n){this._recursivelyUpdate(n)},e.prototype._handleResult=function(n){if(f.prototype._handleResult.call(this,n),!r(n)){var t=n;c(this,t);i(t.IsVisible)||(this._I=t.IsVisible);i(t.Name)||(this._N=t.Name);i(t.UserName)||(this._U=t.UserName);w(this,t,["activeDocument","ActiveDocument","activePage","ActivePage","documents","Documents"])}},e.prototype.load=function(n){return o(this,n)},e.prototype.retrieve=function(n){return s(this,n)},e.prototype._handleRetrieveResult=function(n,t){f.prototype._handleRetrieveResult.call(this,n,t);l(this,n,t)},e.prototype.toJSON=function(){return h(this,{isVisible:this._I,name:this._N,userName:this._U},{activeDocument:this._A,activePage:this._Ac,documents:this._D})},e.prototype.ensureUnchanged=function(n){p(this,n);return},e}(OfficeExtension.ClientObject),y,nt,tt,it,b,rt,ut,ft,e,et,ot,st,ht,lt;n.Application=ct;y="Document";nt=function(e){function a(){return e!==null&&e.apply(this,arguments)||this}return __extends(a,e),Object.defineProperty(a.prototype,"_className",{get:function(){return"Document"},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_scalarPropertyNames",{get:function(){return["description","fullName","id","index","name"]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_scalarPropertyUpdateable",{get:function(){return[!0,!1,!1,!1,!1]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_navigationPropertyNames",{get:function(){return["application","pages"]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"application",{get:function(){return this._A||(this._A=u(n.Application,this,"Application",!1,4)),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"pages",{get:function(){return this._P||(this._P=u(n.PageCollection,this,"Pages",!0,4)),this._P},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"description",{get:function(){return t("description",this._D,y,this._isNull),this._D},set:function(n){this._D=n;d(this,"Description",n,0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"fullName",{get:function(){return t("fullName",this._F,y,this._isNull),this._F},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"id",{get:function(){return t("id",this._I,y,this._isNull),this._I},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"index",{get:function(){return t("index",this._In,y,this._isNull),this._In},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return t("name",this._N,y,this._isNull),this._N},enumerable:!0,configurable:!0}),a.prototype.set=function(n,t){this._recursivelySet(n,t,["description"],["application"],["pages"])},a.prototype.update=function(n){this._recursivelyUpdate(n)},a.prototype.close=function(){f(this,"Close",1,[],4,0)},a.prototype._RegisterShapeAddedEvent=function(){f(this,"_RegisterShapeAddedEvent",0,[],0,0)},a.prototype._UnregisterShapeAddedEvent=function(){f(this,"_UnregisterShapeAddedEvent",0,[],0,0)},a.prototype._handleResult=function(n){if(e.prototype._handleResult.call(this,n),!r(n)){var t=n;c(this,t);i(t.Description)||(this._D=t.Description);i(t.FullName)||(this._F=t.FullName);i(t.ID)||(this._I=t.ID);i(t.Index)||(this._In=t.Index);i(t.Name)||(this._N=t.Name);w(this,t,["application","Application","pages","Pages"])}},a.prototype.load=function(n){return o(this,n)},a.prototype.retrieve=function(n){return s(this,n)},a.prototype._handleRetrieveResult=function(n,t){e.prototype._handleRetrieveResult.call(this,n,t);l(this,n,t)},Object.defineProperty(a.prototype,"onShapeAdded",{get:function(){var n=this;return this.m_shapeAdded||(this.m_shapeAdded=new OfficeExtension.GenericEventHandlers(this.context,this,"ShapeAdded",{eventType:1,registerFunc:function(){return n._RegisterShapeAddedEvent()},unregisterFunc:function(){return n._UnregisterShapeAddedEvent()},getTargetIdFunc:function(){return""},eventArgsTransformFunc:function(n){var t={type:ht.shapeAdded,shapeId:n.shapeId,pageId:n.pageId};return OfficeExtension.Utility._createPromiseFromResult(t)}})),this.m_shapeAdded},enumerable:!0,configurable:!0}),a.prototype.toJSON=function(){return h(this,{description:this._D,fullName:this._F,id:this._I,index:this._In,name:this._N},{application:this._A,pages:this._P})},a.prototype.ensureUnchanged=function(n){p(this,n);return},a}(OfficeExtension.ClientObject);n.Document=nt;tt="DocumentCollection";it=function(i){function u(){return i!==null&&i.apply(this,arguments)||this}return __extends(u,i),Object.defineProperty(u.prototype,"_className",{get:function(){return"DocumentCollection"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_isCollection",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"items",{get:function(){return t("items",this.m__items,tt,this._isNull),this.m__items},enumerable:!0,configurable:!0}),u.prototype.add=function(t){return a(n.Document,this,"Add",1,[t],!1,!0,null,4)},u.prototype.getCount=function(){return f(this,"GetCount",1,[],4,0)},u.prototype.getItem=function(t){return k(n.Document,this,[t])},u.prototype.getItemOrNullObject=function(t){return a(n.Document,this,"GetItemOrNullObject",1,[t],!1,!1,null,4)},u.prototype._handleResult=function(t){var f,e,u,o;if((i.prototype._handleResult.call(this,t),!r(t))&&(f=t,c(this,f),!r(f[OfficeExtension.Constants.items])))for(this.m__items=[],e=f[OfficeExtension.Constants.items],u=0;u<e.length;u++)o=v(n.Document,!0,this,e[u],u),o._handleResult(e[u]),this.m__items.push(o)},u.prototype.load=function(n){return o(this,n)},u.prototype.retrieve=function(n){return s(this,n)},u.prototype._handleRetrieveResult=function(t,r){var u=this;i.prototype._handleRetrieveResult.call(this,t,r);l(this,t,r,function(t,i){return v(n.Document,!0,u,t,i)})},u.prototype.toJSON=function(){return h(this,{},{},this.m__items)},u}(OfficeExtension.ClientObject);n.DocumentCollection=it;b="Page";rt=function(e){function a(){return e!==null&&e.apply(this,arguments)||this}return __extends(a,e),Object.defineProperty(a.prototype,"_className",{get:function(){return"Page"},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_scalarPropertyNames",{get:function(){return["index","name","id"]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_navigationPropertyNames",{get:function(){return["shapes","application","document"]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"application",{get:function(){return this._A||(this._A=u(n.Application,this,"Application",!1,4)),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"document",{get:function(){return this._D||(this._D=u(n.Document,this,"Document",!1,4)),this._D},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"shapes",{get:function(){return this._S||(this._S=u(n.ShapeCollection,this,"Shapes",!0,4)),this._S},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"id",{get:function(){return t("id",this._I,b,this._isNull),this._I},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"index",{get:function(){return t("index",this._In,b,this._isNull),this._In},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return t("name",this._N,b,this._isNull),this._N},enumerable:!0,configurable:!0}),a.prototype.set=function(n,t){this._recursivelySet(n,t,[],["application","document"],["shapes"])},a.prototype.update=function(n){this._recursivelyUpdate(n)},a.prototype.boundingBox=function(n,t,i,r,u){f(this,"BoundingBox",1,[n,t,i,r,u],4,0)},a.prototype._handleResult=function(n){if(e.prototype._handleResult.call(this,n),!r(n)){var t=n;c(this,t);i(t.ID)||(this._I=t.ID);i(t.Index)||(this._In=t.Index);i(t.Name)||(this._N=t.Name);w(this,t,["application","Application","document","Document","shapes","Shapes"])}},a.prototype.load=function(n){return o(this,n)},a.prototype.retrieve=function(n){return s(this,n)},a.prototype._handleRetrieveResult=function(n,t){e.prototype._handleRetrieveResult.call(this,n,t);l(this,n,t)},a.prototype.toJSON=function(){return h(this,{id:this._I,index:this._In,name:this._N},{application:this._A,document:this._D,shapes:this._S})},a.prototype.ensureUnchanged=function(n){p(this,n);return},a}(OfficeExtension.ClientObject);n.Page=rt;ut="PageCollection";ft=function(i){function u(){return i!==null&&i.apply(this,arguments)||this}return __extends(u,i),Object.defineProperty(u.prototype,"_className",{get:function(){return"PageCollection"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_isCollection",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"items",{get:function(){return t("items",this.m__items,ut,this._isNull),this.m__items},enumerable:!0,configurable:!0}),u.prototype.add=function(t){return a(n.Page,this,"Add",1,[t],!1,!0,null,4)},u.prototype.getCount=function(){return f(this,"GetCount",1,[],4,0)},u.prototype.getItem=function(t){return k(n.Page,this,[t])},u.prototype.getItemOrNullObject=function(t){return a(n.Page,this,"GetItemOrNullObject",1,[t],!1,!1,null,4)},u.prototype._handleResult=function(t){var f,e,u,o;if((i.prototype._handleResult.call(this,t),!r(t))&&(f=t,c(this,f),!r(f[OfficeExtension.Constants.items])))for(this.m__items=[],e=f[OfficeExtension.Constants.items],u=0;u<e.length;u++)o=v(n.Page,!0,this,e[u],u),o._handleResult(e[u]),this.m__items.push(o)},u.prototype.load=function(n){return o(this,n)},u.prototype.retrieve=function(n){return s(this,n)},u.prototype._handleRetrieveResult=function(t,r){var u=this;i.prototype._handleRetrieveResult.call(this,t,r);l(this,t,r,function(t,i){return v(n.Page,!0,u,t,i)})},u.prototype.toJSON=function(){return h(this,{},{},this.m__items)},u}(OfficeExtension.ClientObject);n.PageCollection=ft;e="Shape";et=function(a){function v(){return a!==null&&a.apply(this,arguments)||this}return __extends(v,a),Object.defineProperty(v.prototype,"_className",{get:function(){return"Shape"},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"_scalarPropertyNames",{get:function(){return["name","id","text","isCallout","isDataGraphicCallout","isOpenForTextEdit","type"]},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"_navigationPropertyNames",{get:function(){return["application","document"]},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"application",{get:function(){return this._A||(this._A=u(n.Application,this,"Application",!1,4)),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"document",{get:function(){return this._D||(this._D=u(n.Document,this,"Document",!1,4)),this._D},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"id",{get:function(){return t("id",this._I,e,this._isNull),this._I},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"isCallout",{get:function(){return t("isCallout",this._Is,e,this._isNull),this._Is},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"isDataGraphicCallout",{get:function(){return t("isDataGraphicCallout",this._IsD,e,this._isNull),this._IsD},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"isOpenForTextEdit",{get:function(){return t("isOpenForTextEdit",this._IsO,e,this._isNull),this._IsO},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"name",{get:function(){return t("name",this._N,e,this._isNull),this._N},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"text",{get:function(){return t("text",this._T,e,this._isNull),this._T},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"type",{get:function(){return t("type",this._Ty,e,this._isNull),this._Ty},enumerable:!0,configurable:!0}),v.prototype.set=function(n,t){this._recursivelySet(n,t,[],["application","document"],[])},v.prototype.update=function(n){this._recursivelyUpdate(n)},v.prototype.boundingBox=function(n,t,i,r,u){f(this,"BoundingBox",1,[n,t,i,r,u],4,0)},v.prototype._handleResult=function(n){if(a.prototype._handleResult.call(this,n),!r(n)){var t=n;c(this,t);i(t.Id)||(this._I=t.Id);i(t.IsCallout)||(this._Is=t.IsCallout);i(t.IsDataGraphicCallout)||(this._IsD=t.IsDataGraphicCallout);i(t.IsOpenForTextEdit)||(this._IsO=t.IsOpenForTextEdit);i(t.Name)||(this._N=t.Name);i(t.Text)||(this._T=t.Text);i(t.Type)||(this._Ty=t.Type);w(this,t,["application","Application","document","Document"])}},v.prototype.load=function(n){return o(this,n)},v.prototype.retrieve=function(n){return s(this,n)},v.prototype._handleIdResult=function(n){(a.prototype._handleIdResult.call(this,n),r(n))||i(n.Id)||(this._I=n.Id)},v.prototype._handleRetrieveResult=function(n,t){a.prototype._handleRetrieveResult.call(this,n,t);l(this,n,t)},v.prototype.toJSON=function(){return h(this,{id:this._I,isCallout:this._Is,isDataGraphicCallout:this._IsD,isOpenForTextEdit:this._IsO,name:this._N,text:this._T,type:this._Ty},{application:this._A,document:this._D})},v.prototype.ensureUnchanged=function(n){p(this,n);return},v}(OfficeExtension.ClientObject);n.Shape=et;ot="ShapeCollection";st=function(i){function u(){return i!==null&&i.apply(this,arguments)||this}return __extends(u,i),Object.defineProperty(u.prototype,"_className",{get:function(){return"ShapeCollection"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_isCollection",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"items",{get:function(){return t("items",this.m__items,ot,this._isNull),this.m__items},enumerable:!0,configurable:!0}),u.prototype.add=function(t){return a(n.Shape,this,"Add",1,[t],!1,!0,null,4)},u.prototype.getCount=function(){return f(this,"GetCount",1,[],4,0)},u.prototype.getItem=function(t){return k(n.Shape,this,[t])},u.prototype.getItemOrNullObject=function(t){return a(n.Shape,this,"GetItemOrNullObject",1,[t],!1,!1,null,4)},u.prototype._handleResult=function(t){var f,e,u,o;if((i.prototype._handleResult.call(this,t),!r(t))&&(f=t,c(this,f),!r(f[OfficeExtension.Constants.items])))for(this.m__items=[],e=f[OfficeExtension.Constants.items],u=0;u<e.length;u++)o=v(n.Shape,!0,this,e[u],u),o._handleResult(e[u]),this.m__items.push(o)},u.prototype.load=function(n){return o(this,n)},u.prototype.retrieve=function(n){return s(this,n)},u.prototype._handleRetrieveResult=function(t,r){var u=this;i.prototype._handleRetrieveResult.call(this,t,r);l(this,t,r,function(t,i){return v(n.Shape,!0,u,t,i)})},u.prototype.toJSON=function(){return h(this,{},{},this.m__items)},u}(OfficeExtension.ClientObject);n.ShapeCollection=st,function(n){n.shapeAdded="ShapeAdded"}(ht=n.EventType||(n.EventType={})),function(n){n.generalException="GeneralException"}(lt=n.ErrorCodes||(n.ErrorCodes={}))}(Visio||(Visio={})),function(n){function i(t,i){return OfficeExtension.ClientRequestContext._runBatch("Visio.run",arguments,function(){return new n.RequestContext})}var t=function(t){function i(i){var r=t.call(this,i)||this;return r.m_application=new n.Application(r,OfficeExtension.ObjectPathFactory.createGlobalObjectObjectPath(r)),r._rootObject=r.m_application,r}return __extends(i,t),Object.defineProperty(i.prototype,"application",{get:function(){return this.m_application},enumerable:!0,configurable:!0}),i}(OfficeCore.RequestContext);n.RequestContext=t;n.run=i}(Visio||(Visio={}))